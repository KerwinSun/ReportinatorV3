[{"title":"ADR-X Excessive Domain Administrators","category":"Active Directory Review","contents":"ADR-X Excessive Domain Administrators\n=====================================\n\nDescription\n-----------\n\nThe following is a list of accounts with Domain Administrator privileges. Domain administrator privileges should be limited to accounts which strictly require it. As such, the number of accounts identified is excessive.\n\nSeverity\n--------\nHigh – The number of domain administrator accounts is significant. If an attacker were to gain local administrative access on a host that a domain administrator has logged in to, the attacker could freely harvest the Windows token and conduct privilege escalation. The attacker would have the privilege of a domain administrator.\n\nRecommendation\n--------------\nConduct a review of all accounts, which have domain administrator privileges. Identify the requirement for each account needing such access. Where possible, reduce the privilege of accounts. This is particularly prevalent for any service accounts.\n"},{"title":"ADR-X Unsupported Operating Systems","category":"Active Directory Review","contents":"ADR-X Unsupported Operating Systems\r\n===================================\r\n\r\nDescription\r\n-----------\r\nSome hosts in the directory use an operating system which is not under active support.\r\n\r\nSeverity\r\n--------\r\nCritical – Unsupported operating systems will not receive any future security patches, nor have they had any patches since becoming end of life. Windows Server 2003 and XP have been end-of-life since 14/07/2015 and 08/04/2014, respectively. All hosts which are not supported affect the overall security of the organisation.\r\n\r\nRecommendation\r\n--------------\r\nEnsure that these hosts are decommissioned as soon as possible. Supported operating systems running unsupported service packs should be upgraded if decommissioning is not likely to occur in the short-term. Unsupported operating systems should be removed from the organisation as soon as possible.\r\n"},{"title":"ADR-4 Unused Computer Objects","category":"Active Directory Review","contents":"ADR-4 Unused Computer Objects\r\n=============================\r\n\r\nDescription\r\n-----------\r\nThere are computer objects within Active Directory that are a part of the domain, which have either not recorded a log in in six months or have never recorded a log in.\r\n\r\nSeverity\r\n--------\r\nLow – If such hosts were to reappear on the network, they will be heavily out of date in regards to patches. The system will then be in a vulnerable state until it becomes synchronised with the latest patch state.\r\n\r\nRecommendation\r\n--------------\r\nIdentify the status of each host to ascertain which hosts have already been decommissioned. Remove the entries for such systems. Thin clients, virtual machines, and other hosts are likely to be used infrequently. Technical solutions such Network Access Control (NAC) can be used to assist device security by placing them into a segregated network zone until patching is complete. Please note that this should not be relied upon to outright prevent access, as such solutions can be bypassed by an attacker, but they may assist with the administrative process. Alternatively, power on such devices in a regular manner to ensure they become patched.\r\n"},{"title":"ADR-X Unused Domain Administrators","category":"Active Directory Review","contents":"ADR-X Unused Domain Administrators\r\n==================================\r\n\r\nDescription\r\n-----------\r\nDomain administrators can administer the domain and can create new user accounts, register computers, and change security settings. There are domain administrators in Active Directory which have not logged in for 6 months or more. This means that those accounts are not used any longer or that the people assigned those accounts do not need those permissions on a regular basis.\r\n\r\nSeverity\r\n--------\r\nHigh – The chances are increased that a domain administrator account will be compromised by having more domain administrator accounts in Active Directory. While some people require domain administrator credentials as part of the regular administration of the network, the number of accounts should be limited.\r\n\r\nRecommendation\r\n--------------\r\nConduct a review of all accounts which have domain administrator privilege. Identify the requirement for each account needing such access. Where possible, reduce the privilege of accounts. This is particularly prevalent for any service accounts.\r\n"},{"title":"ADR-5 Unused User Objects","category":"Active Directory Review","contents":"ADR-5 Unused User Objects\r\n=========================\r\n\r\nDescription\r\n-----------\r\nSeveral user accounts were identified which are likely not needed for normal operation. These include accounts which have never recorded a log in or have not recorded a log in in the last six months.\r\n\r\nSeverity\r\n--------\r\nLow – If an attacker were to guess or acquire the password to one of the above accounts, then the intrusion may go unnoticed.\r\n\r\nRecommendation\r\n--------------\r\nConduct auditing of accounts which have not been recorded logins within a specific period to limit the number of redundant accounts and reduce the attack surface of the directory. Perform this auditing routinely.\r\n\r\n"},{"title":"ACR-4 Insufficient DDoS Defence","category":"Aws Configuration Review","contents":"ACR-4 Insufficient DDoS Defence\r\nDescription\r\nA distributed denial of service attack attempts to make service or network unavailable by overwhelming the target systems with superfluous requests from many sources under the control of an attacker. Services within AWS can be leveraged to help prevent distributed denial of service attacks.\r\nOne service which can be used to help prevent the negative effects of DDoS attacks is AWS CloudFront. CloudFront is a content delivery network. It caches static content from client servers and serves it, freeing the client servers to handle the dynamic content, reducing load. However, it also acts as a proxy and takes advantage of the defences which AWS has built into it.\r\n"},{"title":"ACR-X Account Information","category":"Aws Configuration Review","contents":"ACR-X Account Information\n=========================\n\nDescription\n-----------\nLateral Security did not have access to check some configuration settings. These include:\n* Whether security questions have been set\n* Whether detailed billing as been enabled\n* Whether current contact details have been set\n* Whether security contact information has been registered\n\nReproduction Details\n--------------------\nThese settings cannot be reviewed with read-only privileges.\n\nSeverity\n--------\nInfo – These configuration settings might be correct, but they should be checked. This issue concerns the following CIS benchmark recommendations.\n* 1.15 Ensure security questions are registered in the AWS account\n* 1.17 Enable detailed billing\n* 1.19 Maintain current contact details\n* 1.20 Ensure security contact information is registered\n\nRecommendation\n--------------\nEnsure that these settings have been configured with accurate and up-to-date information.\n\nThe root account email address should not point to a specific individual, but to a group email account with a member list authorised to have root access. Multi-factor authentication devices for the root account should not leave the organisation premises. This device should be secured. The contact information should be that of the organisation and not an individual.\n"},{"title":"ACR-X Disabled Security Functionality","category":"Aws Configuration Review","contents":"ACR-X Disabled Security Functionality\r\n=====================================\r\n\r\nDescription\r\n-----------\r\nThe following functionality within AWS is not enabled:\r\n  * AWS Config records resource configurations, allowing a review of the history of configuration changes within the environment, as well as compliance auditing\r\n  * AWS Inspector performs automated security assessments\r\n\r\nReproduction Details\r\n--------------------\r\nTo see that AWS Config is not enabled, issue the following command.\r\n\r\n    aws configservice get-status\r\n\r\nThe status of AWS Inspector can be seen by clicking on the Inspector link in the AWS Console.\r\n\r\nSeverity\r\n--------\r\nLow – This finding does not indicate that an exploitable vulnerability exists within the environment. However, not enabling AWS Config reduces visibility of events, which makes it more difficult to detect malicious events.\r\n\r\nIf AWS Inspector is not enabled, then easily detectable insecurities within the environment may go unnoticed.\r\n\r\nThe following CIS benchmark recommendation have not been followed:\r\n  * 2.5 Ensure AWS Config is enabled in all regions\r\n\r\nRecommendation\r\n--------------\r\nEnable AWS Config in all regions. Ensure global resources are included in the record. See the CIS AWS Foundations Benchmark for more information.\r\n\r\nConsider enabling AWS Inspector and monitoring its findings on a routine basis.\r\n\r\n\r\n"},{"title":"ACR-X Disabled User MFA","category":"Aws Configuration Review","contents":"ACR-X Disabled User MFA\n=======================\n\nDescription\n-----------\nMulti-factor authentication (MFA) is any authentication configuration which requires two or more factors before requested access is granted. Examples of MFA include tokens or SMS codes sent to users. MFA is disabled for:\n* users\n\nReproduction Details\n--------------------\nTo see the users with MFA disabled, issue the following command and look under the “mfa\\_active” column for a setting of “false”.\n```\naws iam get-credential-report --query 'Content' --output text | base64 -d\n```\n\nSeverity\n--------\nLow – If multi-factor authentication is not required for an account, then a compromised password could lead to a compromise of the environment. This configuration reduces the security of the AWS configuration.\n\nThe following CIS benchmark recommendation has not been followed:\n* 1.2 Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password\n\nRecommendation\n--------------\nEnsure that all users are required to use MFA for authentication to the AWS environment and it resources.\n"},{"title":"ACR-X EC2 Uses Public IP","category":"Aws Configuration Review","contents":"ACR-X EC2 Uses Public IP\r\n========================\r\n\r\nDescription\r\n-----------\r\nAn EC2 instance has an elastic IP configured for its use. An elastic IP is a public IP address. However, the instance does not have a security group assigned to it which would allow this IP to be reached from the Internet.\r\n\r\nReproduction Details\r\n--------------------\r\nFrom the AWS Management Console, click on EC2. From the resulting left menu, click on Instances. Notice that an instance has a public IP address assigned to it.\r\n\r\nIn the lower pane, look for the Security Groups section. Click view rules. Notice that no public IP sources are allowed by the assigned security groups.\r\n\r\nSeverity\r\n--------\r\nInfo – This does not represent a vulnerability in the configuration. However, it is being raised because some events within the VPC will go unrecorded. These events could be an important indication of malicious activity within the VPC environment.\r\n\r\nRecommendation\r\n--------------\r\nIf not needed, the public IP address should be unassigned to the instance. Services can likely be provided through other means. For example, administration could be done through the VPN and web connections could be made through the ELB."},{"title":"ACR-X Exposed Instances","category":"Aws Configuration Review","contents":"ACR-X Exposed Instances\n=======================\n\nDescription\n-----------\nSeveral elastic compute cloud (EC2) instances are exposed to the Internet.\n* instances\nSeveral relational database service (RDS) instances are exposed to the Internet.\n* instances\n\nReproduction Details\n--------------------\nTo see the EC2 instances which are publicly exposed, issue the following commands.\n```\naws ec2 describe-instances --region <region> --query 'Reservations[*].Instances[?PublicIpAddress]'\n```\nTo see the RDS instances which are publicly exposed, issue the following commands and look for databases with the string, \"PubliclyAccessible\": true.\n```\naws rds describe-db-instances --region <region>\n```\n\nSeverity\n--------\nLow – Instances often contain sensitive data, so are kept on private networks behind firewalls and NACLs. If these instances were misconfigured to allow an attacker to gain access to their data, or if a vulnerability were found in the services, then sensitive data might be disclosed or altered.\n\nRecommendation\n--------------\nPut the instances on a secured, private network and only allow access to approved clients with security groups and NACLs.\n"},{"title":"ACR-X Imprecise Network Filtering","category":"Aws Configuration Review","contents":"ACR-X Imprecise Network Filtering\n=================================\n\nDescription\n-----------\nSeveral security groups did not filter by port. Services run on configured ports. Filtering by port helps ensure that only intended services are available among security groups.\n* security groups\n\nReproduction Details\n--------------------\nTo see that some security groups do not filter by port, issue the following command. Look for the security groups enumerated in the description.\n```\naws ec2 describe-security-groups --region <region>\n```\n\nSeverity\n--------\nLow – Were a service, which was meant to be exposed only within its security group, vulnerable to exploitation, then the attack surface of that vulnerability would be increased by the number of systems outside the security group which can reach it. This configuration does not follow the security principle of defence in depth and least privilege.\n\nRecommendation\n--------------\nConfigure security groups to allow access by host, protocol, and port. Security groups should be one defensive layer, along with network ACLs and system firewalls.\n"},{"title":"ACR-X Infrequent Access Key Rotation","category":"Aws Configuration Review","contents":"ACR-X Infrequent Access Key Rotation\n====================================\n\nDescription\n-----------\nAccess keys within the AWS account are infrequently rotated. Access keys are used by applications, such as the CLI or SDK, to make requests to AWS. Rotating these keys frequently reduces the chance that a compromised key can be used by an attacker.\n\nThe following user’s key has not been rotated in the last 90 days.\n* access key name\n\nReproduction Details\n--------------------\nTo see that some keys have not been rotated in the last 90 days, issue the following commands.\n```\naws iam get-credential-report --query 'Content' --output text | base64 --decode\n```\n\nSeverity\n--------\nLow – Unrotated keys increase the chances that a compromised key can be used to gain control of resources within the environment. Rotating keys reduces this window of opportunity.\n\nThe following CIS benchmark recommendation has not been followed:\n* 1.4 Ensure access keys are rotated every 90 days or less\n* 2.8 Ensure rotation for customer created CMKs is enabled\n\nRecommendation\n--------------\nEnsure that access keys are rotated every 90 days. Keys which are not used should be deleted from the account.\n"},{"title":"ACR-1 Inspector Findings","category":"Aws Configuration Review","contents":"ACR-1 Inspector Findings\r\n========================\r\n\r\nDescription\r\n-----------\r\nAmazon Inspector assesses the security of applications deployed in AWS. Inspector has reported several weaknesses in the environment.\r\n\r\n[include findings]\r\n\r\nReproduction Details\r\n--------------------\r\nIssue the following command using the AWS CLI.\r\n\r\n    for finding in `aws inspector list-findings --query \"findingArns[]\" --output text`\r\n        do aws inspector describe-findings --finding-arns $finding\r\n    done\r\n\r\nSeverity\r\n--------\r\nHigh – Some of the findings reported by Inspector include issues rated as high severity and include privilege escalation and arbitrary code execution.\r\n\r\nThis finding might indicate that routine patching is not occurring or that some components in the environment have not been included in the patching policy. Most of CVEs were made public in 2017. The oldest among them was published in November of 2016.\r\n\r\nOne of the findings concerns the use of an insecure protocol, HTTP, over port 80. Any traffic sent over this protocol would be vulnerable to man-in-the-middle attacks by an intermediary.\r\n\r\nRecommendation\r\n--------------\r\nIf the findings reported by Inspector are not false positives, then consider following the recommendations of Inspector for each reported issue.\r\n"},{"title":"ACR-X Insufficient API Monitoring","category":"Aws Configuration Review","contents":"ACR-X Insufficient API Monitoring\r\n=================================\r\n\r\nDescription\r\n-----------\r\nCloudTrail records API calls made in the AWS account. These calls include those made through the command line interface and the Management Console. CloudTrail facilitates governance, compliance and auditing of the AWS environment. Some important API calls are not being monitored by CloudTrail.\r\n\r\nThe information recorded by CloudTrail is stored in an S3 bucket. Access and modifications to this bucket are not being logged.\r\n\r\nReproduction Details\r\n--------------------\r\nTo see that access to the bucket is not logged, issue the following command.\r\n    aws s3api get-bucket-logging --bucket [bucket]\r\nThis returns nothing.\r\n\r\nTo see that recommended calls are not filtered for monitoring, issue the following command.\r\n    aws logs describe-metric-filters --log-group-name [TrailLogGroup]\r\nThis will return:\r\n    \"metricFilters\": []\r\n\r\nSeverity\r\n--------\r\nMedium – This finding has been raised because some events within the account are not monitored. These events would be an important indication of malicious activity within the account environment. If malicious activity remains unmonitored and unrecorded, then incident response will be delayed. Such a scenario might lead to sever reputational damage, were the discovery to occur by service disruption to customers or sensitive information disclosure to the public.\r\n\r\nThe following recommendations have not been followed:\r\n  * 2.6 Ensure S3 bucket access logging is enabled on the CloudTrail S3 bucket\r\n  * 3.1 Ensure a log metric filter and alarm exist for unauthorized API calls\r\n  * 3.2 Ensure a log metric filter and alarm exist for Management Console sign-in without MFA\r\n  * 3.3 Ensure a log metric filter and alarm exist for usage of \"root\" account\r\n  * 3.4 Ensure a log metric filter and alarm exist for IAM policy changes\r\n  * 3.5 Ensure a log metric filter and alarm exist for CloudTrail configuration changes\r\n  * 3.6 Ensure a log metric filter and alarm exist for AWS Management Console authentication failures\r\n  * 3.7 Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created CMKs\r\n  * 3.8 Ensure a log metric filter and alarm exist for S3 bucket policy changes\r\n  * 3.9 Ensure a log metric filter and alarm exist for AWS Config configuration changes\r\n  * 3.10 Ensure a log metric filter and alarm exist for security group changes\r\n  * 3.11 Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL)\r\n  * 3.12 Ensure a log metric filter and alarm exist for changes to network gateways\r\n  * 3.13 Ensure a log metric filter and alarm exist for route table changes\r\n  * 3.14 Ensure a log metric filter and alarm exist for VPC changes\r\n\r\nRecommendation\r\n--------------\r\nLateral Security recommends that more API calls be monitored by CloudTrail. Access to the S3 bucket which stores CloudTrail logs should be logged. See the CIS benchmark for more information.\r\n * https://d0.awsstatic.com/whitepapers/compliance/AWS_CIS_Foundations_Benchmark.pdf\r\n"},{"title":"ACR-X Insufficient Delegation","category":"Aws Configuration Review","contents":"ACR-X Insufficient Delegation\n=============================\n\nDescription\n-----------\nAny user with full control of IAM can control any other part of the AWS account. No IAM Master and IAM Manager roles have been configured to divide and delegate the configuration privileges that IAM allows.\n\nReproduction Details\n--------------------\nTo see that no IAM Master and IAM Manager roles have been configured, issue the following command.\n```\naws iam list-roles\n```\nIf the roles were configured, their attached policies could be reviewed with the following command.\n```\naws iam get-role-policy --role-name <role name>\n```\n\nSeverity\n--------\nLow – If IAM configuration privileges are not divided and delegated to separate roles, then the chances for a user with IAM access to escalate their privileges to those equal to the root account increase.\nThe following CIS benchmark recommendation has not been followed:\n1.18 Ensure IAM Master and IAM Manager roles are active\n\nRecommendation\n--------------\nCreate two new roles, IAM Master and IAM Manager. In addition, both policies should require MFA.\n```\n\"Condition\": {\"Bool\": {\"aws:MultiFactorAuthPresent\": \"true\"}}\n```\nNo user or group should be able to assume both roles. Refer to the CIS benchmark for the policies which should be attached. For more information, see:\n* https://d0.awsstatic.com/whitepapers/compliance/AWS_CIS_Foundations_Benchmark.pdf\n"},{"title":"ACR-X Insufficient Password Policy","category":"Aws Configuration Review","contents":"ACR-X Insufficient Password Policy\r\n==================================\r\n\r\nDescription\r\n-----------\r\nThe AWS account does not have a sufficient password policy set. The Identity and Access Management password policy enables the following controls to be enforced, but these have not been set to the values recommended by the CIS benchmark.\r\n  * MinimumPasswordLength has been set to 8\r\n  * PasswordReusePrevention has been set to 3\r\n\r\nReproduction Details\r\n--------------------\r\nTo see that the password policy does not meet recommendations, issue the following command.\r\n    aws iam get-account-password-policy\r\n\r\nSeverity\r\n--------\r\nMedium – Password content requirements increase the overall security of your AWS environment by enforcing the creation of strong user passwords. If good password requirements are not set, an attacker can more easily brute force logins. The following CIS benchmark recommendations have not been followed:\r\n  * 1.9 Ensure IAM password policy requires minimum length of 14 or greater\r\n  * 1.10 Ensure IAM password policy prevents password reuse\r\n\r\nRecommendation\r\n--------------\r\nLateral Security recommends that:\r\n  * the password minimum length requirement exceed the recommendation of CIS by requiring at least 16 characters\r\n  * the password reuse requirement prevent the use of the last 24 passwords\r\n"},{"title":"ACR-X Insufficient VPC Flow Logging","category":"Aws Configuration Review","contents":"ACR-X Insufficient VPC Flow Logging\r\n===================================\r\n\r\nDescription\r\n-----------\r\nVPC Flow Logs have been enabled for one region, but not for other regions. VPC Flow Logs give an overview of the traffic entering and exiting a VPC.\r\n\r\nReproduction Details\r\n--------------------\r\nTo see that other regions are not using VPC Flow Logs, issue the following command for each region.\r\n```\r\naws ec2 describe-flow-logs\r\n```\r\n\"FlowLogStatus\": \"ACTIVE\" is only shown in [region].\r\n\r\nSeverity\r\n--------\r\nMedium – Network activity in other regions might indicate malicious activity. This is more likely if only one region is being used by the implementation.\r\nThe following CIS Benchmark recommendation has not been followed:\r\n* 4.3 Ensure VPC flow logging is enabled in all VPCs\r\n\r\nRecommendation\r\n--------------\r\nEnsure that VPC Flow Logs have been enabled in all regions and monitor these logs for anomalous traffic.\r\n"},{"title":"ACR-X No Centralised Log Facility","category":"Aws Configuration Review","contents":"ACR-X No Centralised Log Facility\r\n=================================\r\n\r\nDescription\r\n-----------\r\nCloudWatch is not configured to accept log data from instances in the VPC. CloudWatch can be configured to act as a centralised log host. It can also be used to send alerts when certain recorded conditions are met.\r\n\r\nReproduction Details\r\n--------------------\r\nFrom the AWS Management Console, click on Identity and Access Management. From the resulting left menu, click on Roles. One role exists. Click on it. Look for the following line, which indicates that a logging resource exists in the configuration. During testing, it was not found.\r\n\r\n    \"arn:aws:logs:*:*:*\"\r\n\r\nSeverity\r\n--------\r\nInfo – This does not represent a vulnerability in the configuration. However, it is being raised because a lack of a centralised log host in the implementation does not meet best practice.\r\n\r\nRecommendation\r\n--------------\r\nLateral Security recommends that CloudWatch be enabled and that all EC2 instances be configured to send host event logging to that facility for collection and analysis.\r\n\r\nMore information can be found at the links below:\r\n  * https://aws.amazon.com/cloudwatch/\r\n  * http://docs.aws.amazon.com/AmazonCloudWatch/latest/DeveloperGuide/CWL_GettingStarted.html"},{"title":"ACR-X No Cloudtrail Logging","category":"Aws Configuration Review","contents":"ACR-X No Cloudtrail Logging\r\n===========================\r\n\r\nDescription\r\n-----------\r\nCloudTrail records AWS API calls, however this logging functionality is not turned on. If this were turned on, actions taken by users could be reviewed as well as the resources which have been accessed. This information is stored in S3 buckets.\r\n\r\nReproduction Details\r\n--------------------\r\nFrom the AWS Management Console, click on CloudTrail. Notice that the \"Get Started Now\" button is displayed.\r\n\r\nSeverity\r\n--------\r\nInfo – This does not represent a vulnerability in the configuration. However, it is being raised because some events within the VPC will go unrecorded. These events could be an important indication of malicious activity within the VPC environment.\r\n\r\nRecommendation\r\n--------------\r\nLateral Security recommends that CloudTrail logging be enabled within the VPC. More information on CloudTrail can be found at the following link:\r\n  * https://aws.amazon.com/cloudtrail/"},{"title":"ACR-X No MFA Delete","category":"Aws Configuration Review","contents":"ACR-X No MFA Delete\n===================\n\nDescription\n-----------\nS3 buckets with versioning enabled can be set to require multi-factor authentication before an object can be deleted. This functionality has not been enabled for any buckets in the environment.\n\nReproduction Details\n--------------------\nTo see that no buckets employ MFA on deletion, issue the following command.\n\n    for i in `aws s3api list-buckets --query \"Buckets[*].Name\" --output text`; do\n        aws s3api get-bucket-versioning --bucket $i --query 'MFADelete' --output text\n    done\n\nThis returns, “None”, for each bucket.\n\nSeverity\n--------\nLow – If MFA delete is not enabled, the accidental deletion of objects is more likely to occur. Leaving this feature disabled also lowers the difficulty for an attacker with valid credentials to delete sensitive objects.\n\nRecommendation\n--------------\nEnsure that MFA delete has been enabled for the S3 buckets which contain sensitive information.\n"},{"title":"ACR-X No MFA on Root Account","category":"Aws Configuration Review","contents":"ACR-X No MFA on Root Account\r\n============================\r\n\r\nDescription\r\n-----------\r\nThe VPC root account is not configured to use multifactor authentication. Multifactor authentication requires a user to enter a unique, one-time, authentication code which is generated by an approved device or service along with a password. This is sometimes referred to as \"something you know and something you carry,\" since the password is memorised and the unique code is typically provided by a device.\r\n\r\nReproduction Details\r\n--------------------\r\nIssue the following command.\r\n\r\n    aws iam get-account-summary | grep \"AccountMFAEnabled\"\r\n\r\nThis is set to 0.\r\n\r\nSeverity\r\n--------\r\nMedium – This does not represent a vulnerability in the configuration. However, leaving it disabled leaves the root account more vulnerable to compromise. The root account is unrestricted, and could be used by an attacker to delete resources or exfiltrate sensitive data. High costs could also result from an attacker using an excessive amount of AWS resources.\r\n\r\nThe following CIS benchmark recommendation has not been followed:\r\n  * 1.13 Ensure MFA is enabled for the \"root\" account\r\n\r\nRecommendation\r\n--------------\r\nConfigure multifactor authentication for the root account user. More information on this can be found at the link below:\r\n  * http://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa.html\r\n\r\n"},{"title":"ACR-X No Network Segregation","category":"Aws Configuration Review","contents":"ACR-X No Network Segregation\r\n============================\r\n\r\nDescription\r\n-----------\r\nThe VPC configuration is designed with multiple administrative, publically addressable interfaces. Each instance can be reached directly through SSH from the Internet and requires a public IP address. All hosts are within the same Security Groups, which indicates that web services and database services are not segregated.\r\n\r\nReproduction Details\r\n--------------------\r\nTo see that all hosts are publically addressable and are within the same Security Groups, from the AWS Management Console, click on EC2. From the resulting left menu, click on Instances. The fourth and final columns show the public IP addresses and that the hosts are in the same Security Groups, respectively.\r\n\r\nSeverity\r\n--------\r\nInfo – This does not represent a vulnerability. However, because each instance is reachable from the Internet, the attack surface of the implementation is increased. It relies on the security of however many SSH installations exist within the VPC. Because services are not segregated, a compromise of one service could more easily lead to a compromise of another. For example, a compromise of the web services, which typically hosts static, backed up content, might also lead to a compromise of the databases, which typically host sensitive, changing content which is more difficult to restore without some loss. Flat networks do not follow security best practices. Please see NZISM section 22.1, which talks about cloud computing for more information.\r\n  * https://www.nzism.gcsb.govt.nz/ism-document/#4760\r\n\r\nRecommendation\r\n--------------\r\nAll instances should be configured only with private IP addresses. The public IP of the ELB can be leveraged to provide access to the services running on the instances behind it. The databases should be implemented separately from the web service hosts. Each service should be placed within its own Security Group and secured to allow only the required connections. Administration of the environment can be achieved through a VPN connection, which reduces the number of administration interfaces to one. The VPN connections should then be monitored.\r\n"},{"title":"ACR-X Permissive Default Security Groups","category":"Aws Configuration Review","contents":"ACR-X Permissive Default Security Groups\r\n========================================\r\n\r\nDescription\r\n-----------\r\nThe default security groups have not been amended to disallow traffic to any IP address. By default, these security groups will allow all egress traffic and traffic between instances in the same security group.\r\n\r\nReproduction Details\r\n--------------------\r\nTo see that the default security groups remain permissive, issue the following command in each region.\r\n\r\n    aws ec2 describe-security-groups --filters Name=group-name,Values='default'\r\n\r\nNotice that an IpRange of 0.0.0.0/0 is configured.\r\n\r\nSeverity\r\n--------\r\nLow – Allowing all egress traffic and traffic between instances multiplies attack vectors and does not follow the good practice of least privilege.\r\nThe following CIS Benchmark recommendation has not been followed:\r\n  * 4.4 Ensure the default security group of every VPC restricts all traffic\r\n\r\nRecommendation\r\n--------------\r\nRemove all inbound and outbound rules in the default security groups. Monitor VPC Flow Logs to see what traffic is required by the implementation. Explicitly allow this traffic with security groups.\r\n"},{"title":"ACR-X Unencrypted Volumes","category":"Aws Configuration Review","contents":"ACR-X Unencrypted Volumes\n=========================\n\nDescription\n-----------\nThe instances in the implementation do not use EBS encryption. EBS encryption provides a means to encrypt host block devices.\n\nReproduction Details\n--------------------\nIssue the following command using the AWS CLI.\n    aws ec2 describe-volumes\n\nNote that “Encrypted” is set to false for all volumes.\n\nSeverity\n--------\nLow – If the underlying drives were rotated out due to failure, end-of-life, or another reason by the cloud provider, then sensitive data might be acquired by an attacker by means of salvage. Encrypting storage also helps mitigate the negative consequences of hardware theft.\n\nRecommendation\n--------------\nLateral Security recommends that all instances be configured to use encrypted volumes. Please see the link below for more information:\n  * http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-creating-volume.html"},{"title":"ACR-X Unfiltered Egress","category":"Aws Configuration Review","contents":"ACR-X Unfiltered Egress\r\n=======================\r\n\r\nDescription\r\n-----------\r\nThe security groups assigned to the running instances within the VPC configuration do not contain any outbound filtering and therefore all traffic originating from those instances to the Internet is allowed.\r\n\r\nReproduction Details\r\n--------------------\r\nFrom the AWS Management Console, click on VPC. From the resulting left menu, click on Security Groups. For each security group returned, notice that the Outbound tab indicates that no traffic is restricted.\r\n\r\nSeverity\r\n--------\r\nLow – Unless outbound traffic is filtered, the implementation will allow connections from within the VPC to any host outside the VPC. This could be used by an attacker to exfiltrate sensitive data to a destination of his or her choosing.\r\n\r\nRecommendation\r\n--------------\r\nUse egress filters within security groups to prevent connections to hosts on the Internet which will not be needed. In other words, if only certain hosts will be connecting to certain services, ensure that data going out from those services will only reach those hosts. Lateral Security understands that some services might require unrestricted egress. However, many can be restricted or denied."},{"title":"ACR-X Unrestricted Access to Services","category":"Aws Configuration Review","contents":"ACR-X Unrestricted Access to Services\r\n=====================================\r\n\r\nDescription\r\n-----------\r\nTwo security groups allowed access to port 3389 from any IP address. Port 3389 is the port assigned to the remote desktop protocol and is used for remote administration.\r\n\r\nReproduction Details\r\n--------------------\r\nThis was found with the following command.\r\n\r\n    aws ec2 describe-security-groups --filters \"Name=ip-permission.to-port,Values=3389\" --query 'SecurityGroups[?length(IpPermissions[?ToPort==`3389` && contains(IpRanges[].CidrIp, `0.0.0.0/0`)]) > `0`].{GroupName: GroupName}' --region ap-southeast-2 --output text\r\n\r\nThis reported:\r\n    launch-wizard-1\r\n    launch-wizard-2\r\n\r\nSeverity\r\n--------\r\nInfo – Lateral Security are raising this as informational. This finding was reported to BNZ and the permissive rules have been removed.\r\n\r\nRecommendation\r\n--------------\r\nThis issue has been resolved. Ensure that rules which allow access from all IP addresses have a business justification.\r\n"},{"title":"ACR-X Unrestricted IAM Policies","category":"Aws Configuration Review","contents":"ACR-X Unrestricted IAM Policies\n===============================\n\nDescription\n-----------\nIAM policies define the access which is granted to principals in the AWS environment. Some of these polices have not been carefully restricted to allow only access which is needed by these principals.\n\nThe following policies allow full administrative privileges:\n* list policies\n\nReproduction Details\n--------------------\nTo see that some policies have been created with full administrative privileges, issue the following commands. For each policy listed by the command,\n```\naws iam list-policies --output text\n```\nissue the following command:\n```\naws iam get-policy-version --output text --policy-arn <POLICY> --version-id <POLICY_VERSION> --query \"PolicyVersion.Document.Statement[?Effect == 'Allow’]\"\n```\nLook for statements like \"\\*\" Allow \"\\*\".\n\nSeverity\n--------\nLow – Were a user or resource acting with the privileges granted by one of these policies compromised, then the entire AWS environment would be vulnerable. This configuration does not follow the principle of least privilege.\n\nThe following CIS benchmark recommendation has not been followed:\n* 1.24 Ensure IAM policies that allow full \"*:*\" administrative privileges are not created\n\nRecommendation\n--------------\nCarefully define policies so that attached principals may only perform actions required by the implementation. Never create or attach policies with full administrative privileges.\n"},{"title":"ACR-X Unrestricted Network ACL","category":"Aws Configuration Review","contents":"ACR-X Unrestricted Network ACL\n==============================\n\nDescription\n-----------\nThe current network access control list (NACL) configuration allows all traffic to pass into and out from the VPC subnet. NACLs provide packet filtering on the network before any internal hosts are reached. NACLs are an additional layer of defence when used in conjunction with Security Groups and only NACLs can be used to explicitly deny traffic.\n\nReproduction Details\n--------------------\nTo see that NACLs restrict neither ingress nor egress network traffic, issue the following command:\n\n``` aws ec2 describe-network-acls --region [region] --query 'NetworkAcls[*].[NetworkAclId,VpcId,Entries[?(CidrBlock==`0.0.0.0/0`)]]'```\n\nSeverity\n--------\nLow – Using NACLs are a part of defence in depth. Omission of NACLs forces the VPC to rely on the security provided by security groups and host firewalls. Misconfiguration or omission of either of these final layers could render the implementation vulnerable to attack.\n\nRecommendation\n--------------\nWrite NACLs which match those of the security groups. Include NACLs which restrict outgoing traffic to only what is needed by the implementation. More information on NACLs can be found below.\n  * http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_ACLs.html\n"},{"title":"ACR-X Unsegregated Accounting","category":"Aws Configuration Review","contents":"ACR-X Unsegregated Accounting\n=============================\n\nDescription\n-----------\nMore than one project has been implemented under a single AWS account. Using multiple AWS accounts allows different business projects or different development teams to be contained within the bounds of a single account. While this can ease billing, it can also help limit the “blast radius” of attacks or service failure.\n\nReproduction Details\n--------------------\nThis was observed by Lateral Security through multiple engagements.\n\nSeverity\n--------\nInfo – This finding is not a security vulnerability. Segregating accounts can help limit the scope of security breaches and information disclosure due to internal or external attacks. It can also limit the scope of service failures in conjunction with multiple availability zones or regions.\n\nRecommendation\n--------------\nConsider the relatedness of each project before its implementation. If two or more projects are unrelated or will be developed by separate teams within the organisation, consider providing each with its own account to better segregate business needs. The following link provides more information on AWS Multiple Account Security Strategy.\n* https://docs.aws.amazon.com/whitepapers/latest/cost-optimization-laying-the-foundation/aws-account-structure.html\n"},{"title":"ACR-X Unused Access","category":"Aws Configuration Review","contents":"ACR-X Unused Access\n===================\n\nDescription\n-----------\nSome users have not accessed their accounts within at least the previous 90 days. Unused access indicates that some access might not be necessary.\n\nThe following users have not recently logged in.\n* users\n\nReproduction Details\n--------------------\nTo see which users have not recently logged in or used their access keys, issue the following command.\n```\naws iam get-credential-report --query 'Content' --output text | base64 --decode\n```\n\nSeverity\n--------\nLow – Unused access increases the attack surface of the environment because it provides another vector (valid credentials) of attack.\n\nThe following CIS benchmark recommendation has not been followed:\n* 1.3 Ensure credentials unused for 90 days or greater are disabled\n\nRecommendation\n--------------\nAll unrequired access should be revoked. If users no longer require access, their accounts should be removed. If access keys are not needed, these should be deleted.\n"},{"title":"ACR-X Unverified CloudTrail CloudWatch Integration","category":"Aws Configuration Review","contents":"ACR-X Unverified CloudTrail CloudWatch Integration\r\n==================================================\r\n\r\nDescription\r\n-----------\r\nLateral Security could not verify that CloudTrail had been integrated into CloudWatch. CloudWatch can perform realtime monitoring of the events captured by CloudTrail.\r\n\r\nReproduction Details\r\n--------------------\r\nIssue the following command.\r\n```\r\naws cloudtrail get-trail-status --name <trail name>\r\n```\r\nThis returns an error.\r\n\r\nSeverity\r\n--------\r\nInfo – This is being raised as an informational issue because a good practice could not be verified. If CloudTrail events are not monitored by CloudWatch, then some of these events, which might indicate malicious activity, may go unnoticed.\r\n\r\nThe following CIS benchmark recommendation might not have been followed:\r\n  * 2.4 Ensure CloudTrail trails are integrated with CloudWatch Logs\r\n\r\nRecommendation\r\n--------------\r\nConsider integrating CloudTrail into CloudWatch. An appropriate retention period has been set. By default, CloudWatch will retain logs indefinitely. For more information, see the CIS AWS Foundations Benchmark.\r\n  * https://d0.awsstatic.com/whitepapers/compliance/AWS_CIS_Foundations_Benchmark.pdf\r\n"},{"title":"ACR-X Unverified Customer Master Key Rotation","category":"Aws Configuration Review","contents":"ACR-X Unverified Customer Master Key Rotation\r\n=============================================\r\n\r\nDescription\r\n-----------\r\nLateral Security could not verify that a customer master key is set to rotate. Customer master keys are used by services within an AWS account to encrypt data. Rotating the keys in the key management service helps prevent older keys from accessing newer data.\r\n\r\nReproduction Details\r\n--------------------\r\nIssue the following command using the AWS CLI.\r\n\r\n    aws kms get-key-rotation-status --key-id [key-id]\r\n\r\nLateral Security received the following error.\r\n\r\n***include error***\r\n\r\nSeverity\r\n--------\r\nInfo – This is being raised as an informational issue because a good practice could not be verified.\r\n\r\nRecommendation\r\n--------------\r\nIssue the command included in the reproduction details as a user with sufficient privileges. Verify that the key is set to rotate.\r\n"},{"title":"ACR-X User Attached IAM Policies","category":"Aws Configuration Review","contents":"ACR-X User Attached IAM Policies\r\n================================\r\n\r\nDescription\r\n-----------\r\nIAM policies are attached to users instead of being attached to groups and roles. This increases the complexity of managing privileges in the account. The following users have policies attached.\r\n  * [include users]\r\n\r\nReproduction Details\r\n--------------------\r\nFor each user returned by the command:\r\n\r\n    aws iam list-attached-user-policies\r\n\r\nView the output of:\r\n```\r\niam list-attached-user-policies --user-name <user>\r\n```\r\nand:\r\n```\r\naws iam list-user-policies --user-name <user>\r\n```\r\n\r\nSeverity\r\n--------\r\nLow – If policies are attached directly to users, then chances increase that some users will retain unintended privileges.\r\n\r\nThe following CIS benchmark recommendation has not been followed:\r\n* 1.16 Ensure IAM policies are attached only to groups or roles\r\n\r\nRecommendation\r\n--------------\r\nEnsure that policies are attached to role and groups, and that users are assigned to these.\r\n"},{"title":"ACR-X Disabled Auditing and Threat Detection","category":"Azure Configuration Review","contents":"ACR-X Disabled Auditing and Threat Detection\n============================================\n\nDescription\n-----------\nAuditing and threat detection has not been enabled on some SQL servers and databases. Auditing and threat detection helps to detect anomalous database server and database activity which might indicate attacks, such as SQL injection. Detected events can be sent via email and recorded in an audit log.\n\nReproduction Details\n--------------------\nTo see that auditing and threat detection are disabled, browse to the following locations.\n* Security Center -> Storage and data\n\nSystems Affected\n----------------\n  * ***SYSTEM***\n\nSeverity\n--------\nLow – If auditing and threat detection are not enabled, the probability that malicious activity will go undetected will increase. Leaving this feature disabled contravenes the recommendation of the vendor.\n\nRecommendation\n--------------\nTurn on and configure this service so that authorised roles within the organisation will receive alerts when anomalous activity occurs. For more information, see the link below:\n* https://docs.microsoft.com/en-us/azure/security-center/security-center-enable-auditing-on-sql-servers\n"},{"title":"ACR-X Disabled Just-In-Time Access","category":"Azure Configuration Review","contents":"ACR-X Disabled Just-In-Time Access\r\n==================================\r\n\r\nDescription\r\n-----------\r\nJust-in-time access has not been configured for some subscriptions. It allows an authorised user to access administrative interfaces for limited timespans, which have been defined in policy. This helps to reduce the exposure of these sensitive interfaces to attackers. Access is invoked by the authorised user with the portal or from PowerShell.\r\n\r\nReproduction Details\r\n--------------------\r\nTo see that just-in-time access control has not been enabled, browse to the following location.\r\n* Security Center -> Recommendations -> Apply Just-In-Time network access control\r\n\r\nSystems Affected\r\n----------------\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nLow – Not using this feature will not endanger the implementation if access to administrative interfaces is limited by other means. If no other means have been enabled, then this will leave the interfaces vulnerable to certain attacks. Leaving this feature disabled contravenes the recommendation of the vendor.\r\n\r\nRecommendation\r\n--------------\r\nConfigure just-in-time access if a business requirement for remote administrative access exists. Consider limiting exposure to administrative interfaces through a VPN, to which access is itself limited and monitored.\r\n"},{"title":"ACR-X Disabled TDE","category":"Azure Configuration Review","contents":"ACR-X Disabled TDE\n==================\n\nDescription\n-----------\nLike disk encryption, transparent data encryption (TDE) functions at the database level to improve the security of database data, including the database, backups, and transaction logs. This feature has not been enabled on some databases in the implementation.\n\nReproduction Details\n--------------------\nTo see that TDE is disabled, browse to the following locations.\n* Security Center -> Storage and data\n\nSystems Affected\n----------------\n  * ***SYSTEM***\n\nSeverity\n--------\nLow – If the underlying drives were rotated out due to failure, end-of-life, or another reason by the cloud provider, then sensitive data might be acquired by an attacker by means of salvage. Encrypting databases also helps to mitigate the negative consequences of hardware theft.\n\nRecommendation\n--------------\nLateral Security recommends that all databases be configured to use data encryption. For more information, see the links below.\n* https://docs.microsoft.com/en-us/sql/relational-databases/security/encryption/transparent-data-encryption-azure-sql\n"},{"title":"ACR-X Infrequently Patched Hosts","category":"Azure Configuration Review","contents":"ACR-X Infrequently Patched Hosts\n================================\n\nDescription\n-----------\nThe virtual machines (VMs) are missing system updates from the vendor. Patching is one of the critical controls published by CERT NZ and part of the Essential Eight mitigations published by the Australian Signals Directorate to help prevent compromise.\n\nReproduction Details\n--------------------\nTo see that some systems are missing vendor updates, browse to the following location:\n* Security Center -> Compute -> VMs and computers\n\nSystems Affected\n----------------\n  * ***SYSTEM***\n\nSeverity\n--------\nHigh – Some of the missing updates might include patches for privilege escalation and arbitrary code execution. This finding might indicate that routine patching is not occurring or that some components in the environment have not been included in the patching policy.\n\nRecommendation\n--------------\nEnsure that systems are patched and that a patching policy clearly delegates patch release monitoring and patch application responsibility. All critical vulnerabilities should be patched within 48 hours of their publication. Perform regular audits of these processes. For more information, see the link below.\n* https://docs.microsoft.com/en-us/azure/security-center/security-center-apply-system-updates\n"},{"title":"ACR-X Insecure Communication","category":"Azure Configuration Review","contents":"ACR-X Insecure Communication\r\n============================\r\n\r\nDescription\r\n-----------\r\nAPI Management is configured to use weak cryptographic protocols to secure communication. Transport Layer Security (TLS) and the Secure Sockets Layer (SSL) protocols are cryptographic protocols designed to secure the communication between networked computers. All versions of SSL and some versions of TLS are known to be insecure.\r\n* TLS v1.0 is enabled – TLS v1.0 is vulnerable to CBC\r\n* 3DES is enabled – 3DES uses a 64-bit block size, which is vulnerable to a birthday attack known as SWEET32.\r\n  * https://sweet32.info/\r\n\r\nAn Application Gateway endpoint has not been configured to use TLS. All connections to this gateway will take place in cleartext.\r\n\r\nReproduction Details\r\n--------------------\r\nTo see that insecure communication has been configured for API management, browse to the following location.\r\n* API Management -> [name of service] -> SSL\r\n\r\nTo see that insecure communication has been configured for Application Gateway, browse to the following location.\r\n* Application gateways -> [name of gateway] -> Listeners\r\n\r\nSystems Affected\r\n----------------\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nMedium – Were an attacker able to successfully exploit these weaknesses, sensitive data might be captured and exfiltrated. The organisation could suffer reputational damage from malicious use or leaks of this data.\r\n\r\nIf the unencrypted endpoint is used, then traffic going to it will take place in the clear. An attacker could alter or capture the information, which might lead to reputational damage.\r\n\r\nRecommendation\r\n--------------\r\nConfigure systems to secure communication using TLSv1.2 and modern ciphers with no known weaknesses. Disable compression and have a trusted certificate authority sign all tickets. More information about securing web communication can be found at the following location:\r\n* https://wiki.mozilla.org/Security/Server_Side_TLS\r\n\r\nBe aware that the widespread use of TLSv1.3 is imminent. Web browsers, which support it, have already been released to the public.\r\n"},{"title":"ACR-X Insufficient Auditing","category":"Azure Configuration Review","contents":"ACR-X Insufficient Auditing\r\n===========================\r\n\r\nDescription\r\n-----------\r\nInsufficient auditing occurs within the Azure account.\r\n* Network Watcher is disabled. Network Watcher provides information about the network. Since Network Watcher is disabled, flow logs are also disabled. Flow logs give an overview of the traffic entering and exiting a network.\r\n* Activity logs are not retained. Activity log records events at the subscription level, concerning service health and operational data.\r\n* At least some key vaults will not retain logs. Key vault logs give visibility over how keys and secrets are accessed.\r\n\r\nReproduction Details\r\n--------------------\r\nTo see that Activity Logs are not retained, browse to the following location.\r\n* Activity log -> Export -> Retention\r\n\r\nTo see that Network Watcher flow is not enabled, browse to the following location.\r\n* Network Watcher -> NSG flow logs\r\n\r\nTo see that KeyVault logs are not retained, browse to the following location.\r\n* Key vault -> key -> Diagnostic Logs -> Edit Settings -> Then verify that archive to a storage account is set and AuditEvent is set with a retention of 180 days.\r\n\r\nSystems Affected\r\n----------------\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nMedium – This finding has been raised because some events within the account are not monitored. These events would be an important indication of malicious activity within the account environment. If malicious activity remains unmonitored and unrecorded, then incident response will be delayed. Such a scenario might lead to severe reputational damage, were the discovery to occur by service disruption to customers or sensitive information disclosure to the public.\r\nNetwork activity in other regions might indicate malicious activity. This is more certain if only one region is being used.\r\n\r\nRecommendation\r\n--------------\r\nEnsure that activity logs are retained for at least 1 year. KeyVault logs should be retained for at least half a year.\r\nEnsure that NSG Flow Logs have been enabled in all regions and monitor these logs for anomalous traffic. Anomalies should be investigated as this might be an indication of environment compromise.\r\n* https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-nsg-flow-logging-portal\r\n"},{"title":"ACR-X Insufficient Monitoring","category":"Azure Configuration Review","contents":"ACR-X Insufficient Monitoring\n=============================\n\nDescription\n-----------\nSufficient monitoring has not been configured within the Azure account. Monitoring facilitates governance, compliance and auditing of the AWS environment. The following steps have not been taken.\n* Standard tier has not been enabled for some subscriptions, so those subscriptions will not benefit from threat and anomaly detection and intelligence.\n* Automatic provisioning has not been enabled for some subscriptions.\n* Alerts have not been configured for events which might indicate malicious activity\n* Traffic Manager has not been correctly configured to monitor endpoints\n\nReproduction Details\n--------------------\nTo see that standard tier has not been enabled for some subscriptions, browse to the following location.\n* Security Center -> Security Policy -> [name of subscription] -> pricing tier\n\nTo see that automatic provisioning has not been enabled, browse to the following location.\n* Security Center -> Security Policy -> [name of subscription] -> data collection\n\nTo see that alerts have not been configured, view the Azure Alerts configuration.\n\nTo see that endpoints are degraded, browse to the following location.\n* Traffic Manager -> [profile name]\n\nSystems Affected\n----------------\n  * ***SYSTEM***\n\nSeverity\n--------\nMedium – If sufficient monitoring is not configured, then events which indicate malicious activity might go unnoticed. This could lead to further exploitation of the environment by an attacker than what would have otherwise occurred.\n\nRecommendation\n--------------\nConsider enabling standard tier for all subscriptions. Enable automatic provisioning to more closely monitor events on VMs. Configure Traffic Manager so that useful alerts are sent to administrators when an endpoint has failed.\n* https://docs.microsoft.com/en-us/azure/traffic-manager/traffic-manager-monitoring\n\nEnsure that the alerts and other recommendations of a well-known security benchmark are followed during configuration of the account. See sections 2 and 5 of the Microsoft Azure Foundations Benchmark for more information.\n* https://www.cisecurity.org/cis-benchmarks/\n"},{"title":"ACR-X Many Contributors","category":"Azure Configuration Review","contents":"ACR-X Many Contributors\n=======================\n\nDescription\n-----------\nMany users have been assigned to the contributor role, which allows a user to create and manage all types of Azure resources.\n\nReproduction Details\n--------------------\nLateral Security did not have access to Active Directory, so this was observed through:\n* Virtual machines -> Build -> Access control (IAM)\n\nSystems Affected\n----------------\n  * ***SYSTEM***\n\nSeverity\n--------\nInfo – This issue is being raised as informational.\n\nRecommendation\n--------------\nReview the privileges assigned to users and ensure that they have no more than what is required to perform their responsibilities.\n"},{"title":"ACR-X Many Failed Login Attempts","category":"Azure Configuration Review","contents":"ACR-X Many Failed Login Attempts\r\n================================\r\n\r\nDescription\r\n-----------\r\nOver twenty thousand failed login attempts have been reported by the Azure Security Center.\r\n\r\nReproduction Details\r\n--------------------\r\nTo see the many failed login attempts, browse to the following locations.\r\n* Security Center -> Identity & Access -> [workspace]\r\n\r\nSystems Affected\r\n----------------\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nInfo – This issue is being raised is informational.\r\n\r\nRecommendation\r\n--------------\r\nRoutinely monitor Security Center for these alerts. Ensure that access to administrative interfaces is restricted to authorised hosts and users. This can be facilitated through Active Directory, security groups, and host firewalls. See also the issue, “Unrestricted Access to Services”.\r\n"},{"title":"ACR-X Many Guests","category":"Azure Configuration Review","contents":"ACR-X Many Guests\r\n=================\r\n\r\nDescription\r\n-----------\r\nMany guests are in Azure Active Directory. Guests are usually users from outside the organisation, and might not be removed by normal policy procedures.\r\n\r\nReproduction Details\r\n--------------------\r\nTo see that many guests are in Active Directory, browse to the following location.\r\n* Azure AD -> Users and group -> All users -> Show Guest users only\r\n\r\nSystems Affected\r\n----------------\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nInfo – This issue is being raised as informational.\r\n\r\nRecommendation\r\n--------------\r\nReview the privileges assigned to users and ensure that they have no more than what is required to perform responsibilities. Consider removing guest users.\r\n"},{"title":"ACR-X Missing Account Information","category":"Azure Configuration Review","contents":"ACR-X Missing Account Information\r\n=================================\r\n\r\nDescription\r\n-----------\r\nSome important contact information has not been set in the Azure account. This information is used by Microsoft to contact responsible parties for the environment if they become aware of a compromise.\r\n* An email contact has not been set for the following subscriptions. These are also not configured to receive emails about alerts.\r\n\r\n[name of subscriptions]\r\n\r\n* A phone number contact has not been set for the following subscriptions. These are also not configured to alert subscription owners.\r\n\r\n[name of subscriptions]\r\n\r\nReproduction Details\r\n--------------------\r\nTo see that contact information has not been set, browse to the following location.\r\n* Security Center -> Security Policy -> [name of subscription] -> email notifications\r\n\r\nSystems Affected\r\n----------------\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nLow – If full contact information is not set, important security information from the vendor might not be received.\r\n\r\nRecommendation\r\n--------------\r\nEnsure that this information is included for all subscriptions. Contact information should belong to the organisation and should refer to a group, not an individual. Enable alerts for these subscriptions.\r\n"},{"title":"ACR-X No Centralised Log Facility","category":"Azure Configuration Review","contents":"ACR-X No Centralised Log Facility\r\n=================================\r\n\r\nDescription\r\n-----------\r\nDiagnostic settings have not been configured to accept log data from VMs. Diagnostic settings can be configured to act as a centralised log host. It can also be used to send alerts when certain recorded conditions are met.\r\n\r\nReproduction Details\r\n--------------------\r\nTo see that no centralised log facility has been configured for the VMs, browse to the following location.\r\n* More services -> type “Diagnostic settings”\r\n\r\nNo VMs have been configured.\r\n\r\nSystems Affected\r\n----------------\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nMedium – Were a VM compromised, the attacker might erase or manipulate local logs, hindering incident response. This finding indicates that VMs might not be actively monitored, since VMs would have to be monitored individually. Without centralised logging, the synthesis of events from multiple VMs and devices within the environment into a timeline becomes more difficult.\r\n\r\nRecommendation\r\n--------------\r\nLateral Security recommends that Diagnostic settings be configured to accept VM event logging for collection and analysis. VMs should likewise be configured to send these logs. For more information, see the link below.\r\n* https://docs.microsoft.com/en-us/azure/security/azure-log-audit\r\n"},{"title":"ACR-X No Endpoint Protection","category":"Azure Configuration Review","contents":"ACR-X No Endpoint Protection\n============================\n\nDescription\n-----------\nEndpoint protection has not been detected on at least one VM. As a result, this VM might not be protected against malware. Malware detection events will not be reported to Security Center.\n\nReproduction Details\n--------------------\nTo see VMs which do not have endpoint protection, browse to the following location:\n* Security Center -> Compute -> VMs and computers\n\nSystems Affected\n----------------\n  * ***SYSTEM***\n\nSeverity\n--------\nMedium – Malware could infect the server without being detected, quarantined, or reported. This could lead to downtime, data loss or corruption, or reputational damage.\n\nRecommendation\n--------------\nEnsure that endpoint protection is installed, that malware definitions are updated daily, and that alerts are logged centrally and monitored. Any failures to update definitions or failure of the antivirus software should generate an alert and be investigated. In addition, Lateral Security recommends the use of host IDS software to monitor critical system and application files on the VMs, and report any unauthorised changes to these files. For more information, see the link below.\n* https://docs.microsoft.com/en-us/azure/security-center/security-center-install-endpoint-protection\n"},{"title":"ACR-X No Vulnerability Assessment Solution","category":"Azure Configuration Review","contents":"ACR-X No Vulnerability Assessment Solution\r\n==========================================\r\n\r\nDescription\r\n-----------\r\nAzure reports that no vulnerability assessment solution has been installed on one or more systems. A vulnerability assessment solution reports vulnerability and health monitoring to Azure Security Center so that vulnerable virtual machines can be quickly identified.\r\n\r\nReproduction Details\r\n--------------------\r\nTo see that no vulnerability assessment solution has been enabled, browse to the following location.\r\n* Security Center -> Compute -> Add a vulnerability assessment\r\n\r\nSystems Affected\r\n----------------\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nLow – Routine vulnerability assessments are important since the threat landscape is always changing with the discovery of new vulnerabilities and the development of new exploits. By not assessing vulnerabilities, some might go unpatched or unremediated. Leaving this feature disabled contravenes the recommendation of the vendor.\r\n\r\nRecommendation\r\n--------------\r\nLateral Security recommends that a vulnerability assessment tool which is compatible with Azure be configured to perform routine vulnerability assessments of the implementation.\r\n"},{"title":"ACR-X Outdated Software","category":"Azure Configuration Review","contents":"ACR-X Outdated Software\r\n=======================\r\n\r\nDescription\r\n-----------\r\nSome software in the implementation will not receive security updates after the end of this year.\r\nPHP 5.6 will only receive security fixes until the end of 2018.\r\n* https://php.net/supported-versions.php\r\n\r\n***Modify as required***\r\n\r\nReproduction Details\r\n--------------------\r\n* App Services -> [name of service] -> Application Settings\r\n\r\nSystems Affected\r\n----------------\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nInfo – This finding is not a vulnerability. Software, which is no longer supported by the vendor, will not be patched and is less likely to have vulnerabilities published.\r\n\r\nRecommendation\r\n--------------\r\nConsider using a newer version of this software. The software should be upgraded before the end of support.\r\n"},{"title":"ACR-X Unassociated Virtual Network","category":"Azure Configuration Review","contents":"ACR-X Unassociated Virtual Network\n==================================\n\nDescription\n-----------\nA virtual network does not have an attached security group to provide network filtering.\n\n[insert virtual network name]\n\nReproduction Details\n--------------------\nTo see that no security group is attached to this subnet, browse to the following location:\n* Security Center -> Recommendations -> See “Enable Network Security Groups on subnets”\n\nTo see the attached virtual machines, browse to the following location:\n* Virtual Networks -> [name of virtual network] -> Click on a device.\n\nSystems Affected\n----------------\n  * ***SYSTEM***\n\nSeverity\n--------\nHigh – If a security group is not associated with a subnet, then network filtering will not occur. This subnet is attached to a VM.\n\nRecommendation\n--------------\nEnsure that a network security group is attached to the subnet. Filter all traffic so that only required service may be reached.\n"},{"title":"ACR-X Undistributed Database","category":"Azure Configuration Review","contents":"ACR-X Undistributed Database\r\n============================\r\n\r\nDescription\r\n-----------\r\nCosmosDB has no read regions and does not distribute globally. CosmosDB is replicated automatically within a region, but this replication will not provide resilience in the case of region failures.\r\n* https://docs.microsoft.com/en-us/azure/cosmos-db/regional-failover\r\n\r\nReproduction Details\r\n--------------------\r\nAzure CosmosDB -> [name of database] -> Replicate data globally\r\n\r\nSystems Affected\r\n----------------\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nLow – If a widespread disaster occurred, access to the database might not be possible.\r\n\r\nRecommendation\r\n--------------\r\nConsider replicating the data in the database to another region. If possible, replicate the database to another part of the globe.\r\n"},{"title":"ACR-X Unencrypted Disks","category":"Azure Configuration Review","contents":"ACR-X Unencrypted Disks\n=======================\n\nDescription\n-----------\nThe VMs in the implementation do not use encrypted disks. Encrypted disks provide a means to encrypt VM block devices and include those for the operating system and data.\n\nReproduction Details\n--------------------\nTo see that some VM disks are not encrypted, browse to the following location.\n* Virtual Machines -> [name of VM] -> Disks\n\nSystems Affected\n----------------\n  * ***SYSTEM***\n\nSeverity\n--------\nMedium – If the underlying drives were rotated out due to failure, end-of-life, or another reason by the cloud provider, then sensitive data might be acquired by an attacker by means of salvage. Encrypting storage also helps to mitigate the negative consequences of hardware theft.\nThe severity of this finding is increased because the client does not have control over the underlying infrastructure.\n\nRecommendation\n--------------\nLateral Security recommends that all VMs be configured to use encrypted disks. For more information, see the links below:\n* https://docs.microsoft.com/en-us/azure/security-center/security-center-apply-disk-encryption\n* http://aka.ms/encryptionvminstructions\n"},{"title":"ACR-X Unhardened Active Directory","category":"Azure Configuration Review","contents":"ACR-X Unhardened Active Directory\r\n=================================\r\n\r\nDescription\r\n-----------\r\nAdditional hardening of the Azure environment has not been performed. The following steps have not been taken.\r\n* The Azure AD administration portal has not been restricted to administrators. \r\n* The privilege of assigning members to groups has not been restricted to administrators.\r\n* The \"All Users\" group has not been enabled to more easily apply restrictions across the environment.\r\n* Adding devices to the Azure environment does not require multi-factor authentication.\r\n\r\nReproduction Details\r\n--------------------\r\nThese settings can be found in Azure Active Directory under the users, groups, and devices settings.\r\n\r\nSystems Affected\r\n----------------\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nLow – Allowing any user to see the Active Directory portal could provide useful information about the Azure account to an attacker. Allowing users to assign members to groups and to add devices without multi-factor authentication increases the attack surface of the environment. Without being able to apply policy to all users, some individual account might remain unrestricted.\r\n\r\nRecommendation\r\n--------------\r\nThe AD portal and ability to assign members to groups should be restricted to administrators only. Adding devices should require multi-factor authentication and the All Users group should be enabled.\r\n"},{"title":"ACR-X Unrestricted Network Filtering","category":"Azure Configuration Review","contents":"ACR-X Unrestricted Network Filtering\r\n====================================\r\n\r\nDescription\r\n-----------\r\nApplied security groups allow access to administrative interfaces from anywhere. Port 22 is the port assigned to the SSH protocol and port 3389 is assigned to the remote desktop protocol. Both are used for remote administration. All security groups do not restrict outbound traffic.\r\n\r\nReproduction Details\r\n--------------------\r\nTo see that security groups have not been sufficiently restricted, browse to the following locations.\r\n* More services -> Type \"Network security groups\" -> [name of security group]\r\n\r\nSystems Affected\r\n----------------\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nHigh – Administrative interfaces are targets for attack since a compromise of these can lead to full control of a system and the chance of further infiltration. By not restricting outbound traffic, bidirectional communication and data exfiltration are facilitated.\r\nThe unrestricted exposure of services to the Internet increases the probability of compromise.\r\n\r\nRecommendation\r\n--------------\r\nUse network security groups to limit access to all services in the implementation to the specific IP addresses and networks which require access for intended functionality. Outbound traffic should be restricted to allow only expected connections or disabled completely. All other access should be disabled by default.\r\nAll security groups should restrict by port, protocol, and address.\r\n"},{"title":"ASA-X Infrequent Security Patching","category":"Cisco Asa","contents":"ASA-X Infrequent Security Patching\n==================================\n\nDescription\n-----------\nSecurity patches from the vendor are applied infrequently. Patching is one of the critical controls published by CERT NZ and part of the Essential Eight mitigations published by the Australian Signals Directorate to help prevent compromise.\n\nThe version of the Adaptive Security Appliance Software has the following well-known, published vulnerabilities:\n\n * ***Include CVEs***\n\nReproduction Details\n--------------------\nTo verify that the devices are running an unpatched version of IOS, issue the following command.\n```\nshow version\n```\nLook up these reported versions in a vulnerability database, such as:\n  * https://www.cvedetails.com/\n\nSystems Affected\n----------------\nThe following system is/systems are affected by this issue:\n  * ***SYSTEM***\n\nSeverity\n--------\nHigh – These published vulnerabilities may lead to arbitrary code execution or privilege escalation. They also include denial of service, which could cause serious interruption to dependant infrastructure and services. *** Some of these vulnerabilities were reported almost two years ago.***\n\nThis finding indicates a lack of adherence to NZISM 12.4.\n\nRecommendation\n--------------\nEnsure that a patching policy is in place, which meets the recommendations of NZISM at a minimum. This policy should include clear delegation of responsibility and mandate that patching occur on a routine basis. The operating systems on the servers should be upgraded to the most recent version supplied by the vendor.\n"},{"title":"ASA-X Insecure Administrative Interface","category":"Cisco Asa","contents":"ASA-X Insecure Administrative Interface\r\n=======================================\r\n\r\nDescription\r\n-----------\r\nA clear-text administrative protocol, Telnet, is enabled on the device. Telnet provides a command line interface to administrators, but the communication takes place unencrypted. Telnet, developed in 1969, was one of the earliest TCP/IP protocols.\r\n\r\nReproduction Details\r\n--------------------\r\nThe following line exists in the configuration.\r\n```\r\naaa authentication telnet console LOCAL\r\n```\r\n\r\nThe following string does not exist in the configuration of the device.\r\n```\r\nno telnet [...]\r\n```\r\n\r\nSystems Affected\r\n----------------\r\nThe following system is/systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nHigh – Were an attacker to gain access to the network between the administrator using Telnet and the device, the attacker could view or alter the communication. This could lead to a compromise of the device or the capture of sensitive credentials.\r\n\r\nRecommendation\r\n--------------\r\nTelnet should be disabled on all devices. A more secure protocol, such as SSH, should be used instead. Network filtering should prevent the use of clear-text protocols, such as Telnet, FTP, and others, by restricting the use of their common port numbers.\r\n"},{"title":"ASA-X Insecure Authentication","category":"Cisco Asa","contents":"ASA-X Insecure Authentication\r\n=============================\r\n\r\nDescription\r\n-----------\r\nThe devices do not follow authentication good practice. The administrative interfaces are configured to use Radius instead of TACACS+ and the NTP client does not authenticate its communication with the NTP server.\r\n\r\nReproduction Details\r\n--------------------\r\nTo see that Radius is being used instead of TACACAS+, observe that there are lines in the configuration like the following.\r\n```\r\naaa authentication ssh console Tacacs\r\n```\r\nTo see that NTP communication is not authenticated, observer that no line like the following exists in the configuration.\r\n```\r\nntp authenticate\r\n```\r\n\r\nSystems Affected\r\n----------------\r\nThe following system is/systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nLow – Some portions of the communication with the Radius authentication server will take place in the clear. This could allow an attacker to gain some information about valid credentials, such as the username. If NTP communication is not authenticated, then it might be possible to establish a rogue time server to supply the devices with false time information, making timestamps unreliable.\r\n\r\nRecommendation\r\n--------------\r\nConsider using TACACS+ for authentication and enable NTP authentication.\r\n"},{"title":"ASA-X Insecure Communication","category":"Cisco Asa","contents":"ASA-X Insecure Communication\r\n============================\r\n\r\nDescription\r\n-----------\r\nThe VPN and HTTPS services are configured to accept weak encryption algorithms. Below are ciphers accepted by the services to secure their traffic.\r\n* RC4-based ciphers - RC4 has biases in its cipherstream which an attacker can use to recover the plaintext of a communication.\r\n* MD5-based ciphers - MD5 is vulnerable to collision attacks.\r\n  * http://eprint.iacr.org/2013/170.pdf\r\n* SHA1-based ciphers - SHA-1 is vulnerable to collision attacks.\r\n  * https://shattered.io/\r\n* 3DES-based ciphers – 3DES uses a 64-bit block size, which is vulnerable to a birthday attack known as SWEET32.\r\n  * https://sweet32.info/\r\n* DES-based ciphers - There are three known attacks on DES which are faster than bruteforce attack. These are differential cryptanalysis, linear cryptanalysis, and Davie's attack.\r\n\r\nReproduction Details\r\n--------------------\r\nThe VPN service has been configured by the following lines to accept the weak ciphers.\r\n```\r\ncrypto ipsec transform-set ESP-DES-MD5 esp-des esp-md5-hmac\r\ncrypto ipsec transform-set ESP-DES-SHA esp-des esp-sha-hmac\r\ncrypto ipsec transform-set ESP-3DES-MD5 esp-3des esp-md5-hmac\r\ncrypto ipsec transform-set ESP-3DES-SHA esp-3des esp-sha-hmac\r\n```\r\nNote that, for HTTPS, the line below is not in the configuration.\r\n```\r\nssl server-version tlsv1.2\r\nssl cipher tlsv1.2\r\n```\r\n\r\nSystems Affected\r\n----------------\r\nThe following system is/systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nMedium – Were an attacker able to successfully exploit these weaknesses, sensitive data might be captured and exfiltrated. The organisation could suffer reputational damage from malicious use or leaks of this data.\r\n\r\nThis finding indicates a lack of adherence to NZISM 17.2.\r\n\r\nRecommendation\r\n--------------\r\nConfigure systems to secure communication using TLSv1.2 and modern ciphers with no known weaknesses. Disable compression and have a trusted certificate authority sign all certificates. More information about \"Next Generation Encryption\" from Cisco can be found at the following location.\r\n* https://www.cisco.com/c/en/us/about/security-center/next-generation-cryptography.html\r\n\r\nGeneral information about securing web communication can be found at the following location.\r\n* https://wiki.mozilla.org/Security/Server_Side_TLS\r\n\r\nThe widespread use of TLS v1.3 is imminent. Web browsers which support it have already been released to the public. How the environment could accommodate this new protocol should be considered.\r\n"},{"title":"ASA-X Insecure Logging","category":"Cisco Asa","contents":"ASA-X Insecure Logging\r\n======================\r\n\r\nDescription\r\n-----------\r\nThe logging protocol, Syslog, has not been configured to use encryption to secure its transport. Logging from the devices will occur in plain text.\r\n\r\nReproduction Details\r\n--------------------\r\nObserve that the line containing the string \"logging host\" does not include the word \"secure\". The absence of this word indicates that an SSL/TLS transport will not be used.\r\n\r\nSystems Affected\r\n----------------\r\nThe following system is/systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nLow – Were an attacker to gain access to the network between the device and log host, the attacker could view or alter the logs. This could facilitate certain attacks, provide information to the attacker about what is being recorded, and possible allow the attacker to erase evidence of attack.\r\n\r\nRecommendation\r\n--------------\r\nConfigure the devices and log hosts to use an encrypted protocol to perform centralised logging.\r\n"},{"title":"ASA-X Insecure Network Management","category":"Cisco Asa","contents":"ASA-X Insecure Network Management\r\n=================================\r\n\r\nDescription\r\n-----------\r\nManagement of the network devices uses a version of SNMP prior to version 3. These older versions of the protocol are not secure. SNMPv1 and SNMPv2c lack cryptographic security which helps to protect the sensitive diagnostic information and management access that SNMP provides. SNMPv1 and SNMPv2c use a community string for access control, and this string traverses the network in the clear. ***The devices are configured to use the default community string.***\r\n\r\nReproduction Details\r\n--------------------\r\n***Observe the following lines in the configuration.*** These tell the ASA not to pass SNMP v1 and version 3 traffic through the device. Version 2c is not denied. This indicates that version 2c is used on the networks.\r\n```\r\nsnmp-map asa_snmp_map\r\ndeny version 1\r\ndeny version 3\r\n```\r\n***Observe that the following string exists within the configuration.*** The existence of \"community\" means that either v1 or v2c of SNMP is in use by the device itself.\r\n```\r\nsnmp-server [...] community [...]\r\n```\r\n\r\nSystems Affected\r\n----------------\r\nThe following system is/systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nMedium – The devices are vulnerable to traffic sniffing for any attacker who might gain access to the network. The type of information typically provided over SNMP includes that which might help an attacker enumerate hosts, devices, and possibly even acquire passwords.\r\n\r\nThis finding indicates a lack of adherence to NZISM 18.1.14.\r\n\r\nRecommendation\r\n--------------\r\nSNMPv2c should be replaced with SNMPv3 for all devices on the network. Network management traffic should be segregated to a dedicated management network or it should be disabled.\r\n"},{"title":"ASA-X Insecure Timeouts","category":"Cisco Asa","contents":"ASA-X Insecure Timeouts\r\n=======================\r\n\r\nDescription\r\n-----------\r\nSome administrative services will not automatically terminate sessions which have had no activity after a recommended defined timeout period. ***The SSH interface has a long timeout of 30 minutes. The console and HTTPS interfaces have no timeout set.***\r\n\r\nReproduction Details\r\n--------------------\r\nSearch for the following strings in the configuration.\r\n```\r\nssh timeout\r\nconsole timeout\r\n```\r\nFor HTTPS, no “class-map” has been defined with a default connection timeout of 10 minutes or fewer.\r\n\r\nSystems Affected\r\n----------------\r\nThe following system is/systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nMedium – If recommended timeouts are not configured, then the chances that an attacker might gain control of an open administrative session increases. The ease of this attack would somewhat depend on the physical security of the console.\r\n\r\nRecommendation\r\n--------------\r\nReduce SSH timeout to 10 minutes from 30.\r\n```\r\nssh timeout 10\r\n```\r\nThe console had no timeout. This should be set to 10 minutes.\r\n```\r\nconsole timeout 10\r\n```\r\nNo HTTPS server session timeout was set. This should be set to 10 minutes. See the link below for more information.\r\n* https://www.cisco.com/c/en/us/support/docs/security/asa-5500-x-series-next-generation-firewalls/68332-pix7x-connection-timeout.html\r\n"},{"title":"ASA-X Insecure VPN Key Exchange","category":"Cisco Asa","contents":"ASA-X Insecure VPN Key Exchange\r\n===============================\r\n\r\nDescription\r\n-----------\r\nWhen negotiating an IPSec VPN tunnel, IKE is used. It can operate in one of two modes: main or aggressive. The Virtual Private Network (VPN) is configured for aggressive mode, which minimises the number of requests by sending a hash of the pre-shared key to the VPN service. An attacker who obtains this hash would be able to recover the pre-shared key with sufficient time by using brute force. The group name of the VPN needs to be known for a successful attack.\r\n\r\nReproduction Details\r\n--------------------\r\nAggressive mode is enabled by default. Observe that the following line is missing from the configuration.\r\n```\r\ncrypto ikev1 am-disable\r\n```\r\n\r\nSystems Affected\r\n----------------\r\nThe following system is/systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nMedium – An attacker could brute force the group name and encryption keys of the VPN session and gain complete access to the network. Depending on the strength of the VPN group name and pre-shared key, this may require some time. However, once the group name has been established, cracking the key can be performed offline. In the case of trying to crack the 3DES encryption, an attacker would need to perform a man in the middle attack to intercept the traffic first.\r\n\r\nRecommendation\r\n--------------\r\nLateral Security recommends that the VPN be configured to use main mode rather than aggressive mode for the initial session establishment. This will prevent the pre-shared key from being disclosed. A strong pre-shared key should be used (over ten characters, a mix of upper- and lower-case letters and numbers). If it is not in place already, centralised logging should be considered so if attempts are made to brute force the group name, these can be observed and responded to. If the VPN is used to connect several known locations or specific systems, IP address whitelisting should be used to prevent third parties from connecting to the VPN endpoints and attempting to crack the credentials.\r\n"},{"title":"ASA-X No Netflow","category":"Cisco Asa","contents":"ASA-X No Netflow\r\n================\r\n\r\nDescription\r\n-----------\r\nNetflow event logging is not enabled. Netflow event logging provides improved visibility of the traffic passing through a firewall. It can increase the chances of detecting unusual traffic entering or exiting the network.\r\n\r\nReproduction Details\r\n--------------------\r\nNo lines exist in the configuration which begin with the following string.\r\n```\r\nflow-export\r\n```\r\n\r\nSystems Affected\r\n----------------\r\nThe following system is/systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nLow – The absence of Netflow event logging will reduce the chances of detecting some forms of anomalous traffic. This might mean that attacks which would otherwise be caught will go undetected.\r\n\r\nRecommendation\r\n--------------\r\nEnable Netflow event logging to improve the chances that attacks will be brought to the attention of network administrators. For more information on configuring Netflow, see the link below.\r\n* https://www.cisco.com/c/en/us/td/docs/security/asa/special/netflow/guide/asa_netflow.html\r\n"},{"title":"ASA-X No Timestamps","category":"Cisco Asa","contents":"ASA-X No Timestamps\r\n===================\r\n\r\nDescription\r\n-----------\r\nIn the current configuration of the device, logged events will not include timestamps. Timestamps provide important information that helps correlate events on multiple devices and the order in which those events took place.\r\n\r\nReproduction Details\r\n--------------------\r\nTo verify that timestamps are not enabled, note that the following string is missing from the configuration.\r\n```\r\nlogging timestamp\r\n```\r\n\r\nSystems Affected\r\n----------------\r\nThe following system is/systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nLow – Without timestamps, determining when events occurred relative to events elsewhere on the network can be unreliable. This increases auditing difficulty.\r\n\r\nRecommendation\r\n--------------\r\nConfigure the device to include timestamps for all logging messages. This can be done with the \"service timestamps\" directive. Please see Logging Best Practices in the Cisco Guide to Hardening for more information.\r\n* http://www.cisco.com/c/en/us/support/docs/ip/access-lists/13608-21.html\r\n"},{"title":"ASA-X No Unicast RPF","category":"Cisco Asa","contents":"ASA-X No Unicast RPF\r\n====================\r\n\r\nDescription\r\n-----------\r\nUnicast reverse path forwarding (RPF) helps prevent IP spoofing attacks without having to add many additional rules to the configuration. This feature has not been enabled in the configuration.\r\n\r\nThe following interfaces do not have unicast RPF verification enabled.\r\n* ***inside***\r\n* ***outside***\r\n\r\nReproduction Details\r\n--------------------\r\nTo see that unicast RPF is not configured, note that no lines beginning with the following string are present in the configuration.\r\n```\r\nip verify reverse-path\r\n```\r\n\r\nSystems Affected\r\n----------------\r\nThe following system is/systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nMedium – An attacker could use a spoofed source address to perform denial of service attacks on the device.\r\n\r\nRecommendation\r\n--------------\r\nEnsure that unicast RPF verification is enabled. More information on unicast RPF can be found at the following location.\r\n* https://www.cisco.com/c/en/us/about/security-center/unicast-reverse-path-forwarding.html\r\n"},{"title":"ASA-X Unrestrictive Rules","category":"Cisco Asa","contents":"ASA-X Unrestrictive Rules\r\n=========================\r\n\r\nDescription\r\n-----------\r\nSeveral network access control lists are too permissive. This exposes sensitive services such as administrative interfaces and allows the use of insecure services, such as those which use clear-text protocols. ***See Appendix B for a list of the unrestrictive rules recorded during this review.***\r\n\r\nIn addition, no rule exists to restrict access to the control pane as a “catch all”.\r\n```\r\naccess-list <name> in interface <Interface_name> control-plane\r\n```\r\nReproduction Details\r\n--------------------\r\nObserve the lines enumerated in the description and appendix of this issue in the configuration of the devices.\r\n\r\nSystems Affected\r\n----------------\r\nThe following system is/systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nHigh – If network access control lists are too permissive, sensitive subnets and their services can be more easily attacked. This could lead to a compromise of the affected environments.\r\n\r\nRecommendation\r\n--------------\r\nThe rules should be made more restrictive, defining source, destination, and service if no business justification exists for their permissiveness.\r\n\r\n"},{"title":"CNA-X Insecure Network Management","category":"Cisco Not Asa","contents":"CNA-X Insecure Network Management\r\n=================================\r\n\r\nDescription\r\n-----------\r\nSNMPv2c is being used. All versions of SNMP before version 3 lack cryptographic security, which helps to protect the sensitive diagnostic information and management access that SNMP is typically used for. SNMPv1 and SNMPv2 use a community string which traverses the network in the clear.\r\n\r\nReproduction Details\r\n--------------------\r\nTo verify that SNMPv2 is in use, note that the following directive is included in the configuration.\r\n    version 2c\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nMedium – The implementation remains vulnerable to traffic sniffing for any attacker who might gain access to the network. The type of information typically provided over SNMP includes that which might help an attacker enumerate hosts, devices, and acquire passwords.\r\n\r\nThis issue indicates a lack of adherence to NZISM 18.1.14.\r\n\r\nRecommendation\r\n--------------\r\nLateral Security recommends that only SNMPv3 be used for network management. Once this change has been made, the community strings should be changed. If the functionality provided by SNMP is not required by the implementation, then it should be disabled. Please see Fortify the Simple Network Management Protocol in the Cisco Guide to Hardening for more information.\r\n  * http://www.cisco.com/c/en/us/support/docs/ip/access-lists/13608-21.html\r\n"},{"title":"CNA-X No Centralised Logging","category":"Cisco Not Asa","contents":"CNA-X No Centralised Logging\r\n============================\r\n\r\nDescription\r\n-----------\r\nThe configuration does not include a central log host. A central log host provides a facility for duplicate logging off-host, thereby increasing defence-in-depth and easing auditing.\r\n\r\nReproduction Details\r\n--------------------\r\nIn the configuration, look for a line with the following string. This line is not present.\r\n    logging host\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nMedium – Were a device to become compromised, logs which might indicate the compromise or how the compromise occurred could be erased or otherwise tampered with on the device. Devices are not often monitored individually. So, this might suggest that events are not being monitored at all. Logs on a device do not persist after a reboot unless the device contains non-volatile storage and is configured to keep the logs.\r\n\r\nThis finding indicates a lack of adherence to NZISM 16.5.12.\r\n\r\nRecommendation\r\n--------------\r\nLateral Security recommends that all device events be sent to a central log host and that the log host be configured to notify staff when events, which might point to a network compromise, occur. Please see Logging Best Practices in the Cisco Guide to Hardening for more information on logging best practices."},{"title":"CNA-X No Intrusion Detection","category":"Cisco Not Asa","contents":"CNA-X No Intrusion Detection\r\n============================\r\n\r\nDescription\r\n-----------\r\nNetflow event logging is not enabled. Netflow event logging provides improved visibility of the traffic passing through a firewall. It can increase the chances of detecting unusual traffic entering or exiting the network.\r\n\r\nReproduction Details\r\n--------------------\r\nTo verify that timestamps are not enabled, note that the following string is missing from the configuration.\r\n    flow-export\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nMedium – The absence of Netflow event logging will reduce the chances of detecting some forms of anomalous traffic. This might mean that attacks, which would otherwise be caught, will go undetected.\r\n\r\nThis finding indicates a lack of adherence to NZISM 18.4.6.\r\n\r\nRecommendation\r\n--------------\r\nIntrusion detection and intrusion prevention should be configured on the device as a means of defence in depth. Enable Netflow event logging to improve the chances that attacks will be brought to the attention of network administrators. Please see Traffic Identification and Traceback in the Cisco Guide to Hardening for more information.\r\n  * http://www.cisco.com/c/en/us/support/docs/ip/access-lists/13608-21.html\r\n"},{"title":"CNA-X Unhardened SSH Configuration","category":"Cisco Not Asa","contents":"CNA-X Unhardened SSH Configuration\r\n==================================\r\n\r\nDescription\r\n-----------\r\nSeveral settings in the network device configurations, which would harden their SSH service, are missing. The device is not configured to provide local authentication for an SSH user as a fall back, were the network authentication to fail. The SSH service will not automatically terminate sessions which have had no activity after a defined timeout period. SSHv1 has not been explicitly disabled to prevent SSHv1 clients from connecting.\r\n\r\nReproduction Details\r\n--------------------\r\nTo verify that no authentication has been configured for a local SSH user, notice that the following string is absent from the configuration.\r\n    aaa authentication ssh console LOCAL\r\nTo verify that no SSH session timeout has been set, notice that the following string is absent from the configuration.\r\n    ssh timeout\r\nTo see that SSHv1 has not been explicitly disabled, notice that the following string is absent in the configuration.\r\n    ssh version 2\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nLow – If the central authentication server fails or the network connection between it and the network devices fails, then it would be impossible to administer the devices. The lack of a timeout could allow an attacker to hijack a session, which has been left unattended. If SSHv1 is not explicitly disabled, then it might be possible for an SSHv1 client to connect to the device. This connection could be intercepted by an intermediary and compromised because SSHv1 has known weaknesses.\r\n\r\nRecommendation\r\n--------------\r\nEnsure that local authentication has been configured for SSH, that an SSH timeout has been set, and that only SSHv2 connections are allowed. Please see SSHv2 in the Cisco Guide to Hardening for more information.\r\n  * http://www.cisco.com/c/en/us/support/docs/ip/access-lists/13608-21.html\r\n"},{"title":"CNA-X No Timestamps","category":"Cisco Not Asa","contents":"CNA-X No Timestamps\r\n===================\r\n\r\nDescription\r\n-----------\r\nEvents, which are to be logged, will not include timestamps. Timestamps provide important information that helps correlate events on multiple devices and the order in which those events took place.\r\n\r\nReproduction Details\r\n--------------------\r\nTo verify that timestamps are not enabled, note that the following string is missing from the configuration.\r\nservice timestamps\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nLow – Without timestamps, finding when events occurred relative to events elsewhere on the network requires guesswork. This increases auditing difficulty.\r\n\r\nThis finding indicates a lack of adherence to NZISM 16.5.11.\r\n\r\nRecommendation\r\n--------------\r\nConfigure the device to include timestamps for all logging messages. This can be done with the \"service timestamps\" directive. Please see Logging Best Practices in the Cisco Guide to Hardening for more information.\r\n  * http://www.cisco.com/c/en/us/support/docs/ip/access-lists/13608-21.html\r\n"},{"title":"CNA-X Services Not Disabled","category":"Cisco Not Asa","contents":"CNA-X Services Not Disabled\r\n===========================\r\n\r\nDescription\r\n-----------\r\nThe following services have not been explicitly disabled on the device. By default, these services will be running.\r\n  * Finger\r\n  * BOOTP\r\n  * DHCP\r\n  * MOP\r\n  * CDP\r\n  * LLDP\r\n  * Configuration retrieval vis TFTP\r\n\r\nIn addition, it will attempt to perform DNS resolution.\r\n\r\nReproduction Details\r\n--------------------\r\nTo verify that these services have not been disabled, note that the following strings are missing in the configuration.\r\n    no ip finger\r\n    no ip bootp server\r\n    ip dhcp bootp ignore\r\n    no service dhcp\r\n    no mop enabled\r\n    no service pad\r\n    no service config\r\n    no cdp run\r\n    no cdp enable\r\n    no lldp run\r\n    no lldp transmit\r\n    no lldp receive\r\n    no ip domain-lookup\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nLow – The services enabled on the device do not represent a vulnerability, but do increase attack surface. Were a vulnerability discovered in one of these services, the device might become remotely exploitable. Allowing DNS resolution could be used to set up bidirectional communication to the Internet via DNS tunnelling.\r\n\r\nRecommendation\r\n--------------\r\nLateral Security recommends explicitly disabling the services enumerated in this issue if those services are not needed. Please see General Management Plane Hardening in the Cisco Guide to Hardening for more information.\r\n  * http://www.cisco.com/c/en/us/support/docs/ip/access-lists/13608-21.html\r\n"},{"title":"CNA-X Unhardened Network Settings","category":"Cisco Not Asa","contents":"CNA-X Unhardened Network Settings\r\n=================================\r\n\r\nDescription\r\n-----------\r\nSeveral network hardening settings do not meet good practice.\r\n  * service tcp-keepalives-in disabled\r\n  * service tcp-keepalives-out disabled\r\n  * IP redirects are enabled\r\n  * ICMP unreachables are enabled\r\n  * no fragmentation checks are performed\r\n\r\nTCP keepalives ensure that the device on the remote end of the connection is still accessible and that half-open or orphaned connections are removed from the local Cisco IOS device.\r\nIf a host tries to use the wrong router to route a packet, then the router sends an ICMP redirect response (IP redirect) back to the host to inform it to use a different route. This consumes resources on the router.\r\n\r\nICMP unreachable messages are enabled. When an access list has been applied to an interface and traffic is determined to be filtered by that configuration, ICMP unreachable messages are sent back to the origin address. This consumes resources on the router.\r\n\r\nThe device is not configured to prevent fragmented packets on external or high-risk interfaces. This is configured through network access control lists which are applied to the interfaces. IP fragmentation can be used to bypass intrusion detection systems because the contents of a packet are split among several packets, obscuring context.\r\n\r\nReproduction Details\r\n--------------------\r\nTo verify that TCP keepalives have not been configured on the devices, note that the following strings are missing from the configuration.\r\n    service tcp-keepalives-in\r\n    service tcp-keepalives-out\r\n\r\nTo verify that IP redirects have not been disabled, note that the following string is missing from the configuration.\r\n    no ip redirects\r\n\r\nTo verify that ICMP unreachable have not been disabled, note that the following string is missing from the configuration.\r\n    no ip unreachables\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nLow – A malicious user can exploit the ability of the router to send ICMP redirects by continually sending packets to the router, which forces the router to respond with ICMP redirect messages and results in an adverse impact on the CPU and performance of the router. A similar denial of service can also be achieved using ICMP unreachables.\r\n\r\nIf TCP keepalives are not set, then the device will have a more difficult time determining whether an open connection is a dangling session. This might be exploited by an attacker to consume resources on the device.\r\n\r\nRecommendation\r\n--------------\r\nUnless there is a business requirement for IP redirects and ICMP unreachables, the configuration should include the directives referenced in the reproduction details of this issue. Consideration should be given to setting TCP keepalive on the devices. Please see General Data Plane Hardening in the Cisco Guide to Hardening for more information.\r\n  * http://www.cisco.com/c/en/us/support/docs/ip/access-lists/13608-21.html\r\n\r\n"},{"title":"CNA-X Unpatched Operating System","category":"Cisco Not Asa","contents":"CNA-X Unpatched Operating System\r\n================================\r\n\r\nDescription\r\n-----------\r\nThe versions of IOS, which run on the devices, are out-of-date and have published vulnerabilities. Below are the reported versions and their respective CVEs.\r\n[Included CVEs]\r\n\r\nReproduction Details\r\n--------------------\r\nTo verify that the devices are running an unpatched version of IOS, issue the following command.\r\nshow version\r\nLook up these reported versions in a vulnerability database, such as:\r\n  * https://www.cvedetails.com/\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nMedium – These published vulnerabilities do not include arbitrary code execution or privilege escalation. They do include denial of service, which could cause serious interruption to dependant infrastructure and services. Some of these vulnerabilities were reported almost two years ago.\r\n\r\nThis finding indicates a lack of adherence to NZISM 12.4.\r\n\r\nRecommendation\r\n--------------\r\nEnsure that a patching policy is in place, which meets the recommendations of NZISM at a minimum. This policy should include clear delegation of responsibility and mandate that patching occur on a routine basis. The operating systems on the servers should be upgraded to the most recent version supplied by the vendor.\r\n"},{"title":"CNA-X Weak Account Requirements","category":"Cisco Not Asa","contents":"CNA-X Weak Account Requirements\n===============================\n\nDescription\n-----------\nSeveral account settings do not meet good practice. Passwords have not been securely hashed, but encoded in an easily reversed format known as the “Vigenère cipher”. This cipher was broken prior to 1846.\n\nPassword retry lockout is not being used. This feature helps prevent brute forced authentication by telling the device to lock out a user after a set number of failed attempts.\n\nPassword recovery has not been disabled. Password recovery allows a user to access the device configuration, clear the password, and access NVRAM.\n\nReproduction Details\n--------------------\nTo verify that the Vigenère cipher is in use, note that the following string is included in the configuration.\n    password 7\nTo verify that password retry lockout is not enabled, note the following string is missing from the configuration.\n    authentication attempts max-fail\nTo verify that password recovery has not been disabled, note the following is missing from the configuration.\n    no service password-recovery\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SYSTEM***\n\nSeverity\n--------\nMedium – The Vigenère cipher is not secure. Password can be reversed in seconds by anyone who has access to the device configuration. This might allow an attacker to gain access to other systems in the environment, which have been configured to use the same password.\n\nBy not setting max-fail, an attacker could use an arbitrarily long dictionary list to attempt many passwords over time against the devices, which might lead to their remote compromise.\n\nAllowing password recovery functionality exposes the device to configuration tampering.\n\nThis finding indicates a lack of adherence to NZISM 17.2.\n\nRecommendation\n--------------\nNever use “password 7” in a configuration. Instead, use an NZISM approved hashing algorithm, such as SHA-256. In IOS, this is provided by the “password 8” directive. All passwords used up to this point should be changed. The configuration directive, max-fail, should be added to the device configuration to help prevent brute force attacks. Password recovery should be disabled to prevent insecure console access. Please see General Management Plane Hardening in the Cisco Guide to Hardening for more information.\n  * http://www.cisco.com/c/en/us/support/docs/ip/access-lists/13608-21.html\n"},{"title":"CR-X TEMPLATE","category":"Code Review","contents":"CR-X TEMPLATE\n=============\n\nDescription\n-----------\n\n\nReproduction Details\n--------------------\n\n\nSystems Affected\n----------------\nThe following ***file(s) is/are*** affected by this issue:\n  * ***FILES***\n\nSeverity\n--------\nInfo – \n\n\nRecommendation\n--------------\n\n\n"},{"title":"EPT-X TEMPLATE","category":"External Network Pentest","contents":"EPT-X TEMPLATE\n=============\n\nDescription\n-----------\n\n\nReproduction Details\n--------------------\n\n\nSystems Affected\n----------------\nThe following ***host(s) is/are*** affected by this issue:\n  * ***SITE***\n\nSeverity\n--------\nInfo – \n\n\nRecommendation\n--------------\n\n\n"},{"title":"EPT-X Weak Encryption Supported","category":"External Network Pentest","contents":"EPT-X Weak Encryption Supported\n=============\n\nDescription\n-----------\nEncryption is a cryptographic process to mitigate against untrusted parties reading data in transit.\nIt relies on two key principles: verifying the server's identity and obfuscating communications.\n\nServers typically verify their identity by presenting named certificates; either already known to the user or signed by a trusted party (Certificate Authority).\nClients then use this certificate to negotiate a common shared secret to encrypt traffic going forward.\nDecryption of historical data may be possible if server secrets are compromised, dependent on the algorithm used to negotiate the shared secret (Perfect Forward Secrecy).\n\nRecommended encryption practices have evolved over time as existing algorithm flaws/biases are discovered and new methods are developed to address them.\nAs malicious network users may be able to influence which algorithms are selected, support for protocols/ciphers containing known flaws should be explicitly disabled within server configuration.\n\nThe following mechanisms are considered weak:\n* Self-signed Certificates - Does not verify the server.\n* Certificates using MD5 hashes - Hash collisions are feasible.\n* Certificates using SHA1 hashes - Hash collisions are feasible by state actors.\n* Wildcard Certificates - Increases the impact should a certificate be compromised.\n* RSA key exchange - Significantly weaker than alternatives.\n* Anonymous key exchange (ADH) - Does not verify the server.\n* TLSv1.1 - Has been formally deprecated, as it does not support modern ciphers.\n* TLSv1.0 - Has been formally deprecated, as it has known weaknesses and does not support modern ciphers.\n* SSLv2.0 / SSLv3.0 - Numerous published flaws.\n* 64 bit block ciphers (3DES / DES / RC2 / IDEA) - Published weaknesses.\n* RC4 - Published flaws.\n* Export Grade encryption - Intentionally weak.\n* Null cipher encryption - Does not encrypt.\n* Not supporting \"Fallback Signaling\" - TLS_FALLBACK_SCSV mitigates against protocol downgrade attacks.\n* Not supporting the “Extended Master Secret” TLS extension - This extension mitigates against the triple handshake attacks (3SHAKE).\n\nIn this case, ***Brief description of how bad it is...***\n\n\nReproduction Details\n--------------------\nScan hosts using an SSL/TLS enumeration tool, such as sslscan (https://github.com/rbsec/sslscan) or nmap (https://nmap.org/).\nOnline tools are also available for externally facing systems (https://www.ssllabs.com/ssltest/).\n```\nsslscan {HOST}\nnmap --script ssl-enum-ciphers,ssl-cert {HOST} -p {PORT}\n```\n\nSystems Affected\n----------------\nThe following ***host(s) is/are*** affected by this issue:\n  * ***SITE***\n\n  *** You don't have to itemise everything, unless some are practically bad. ***\n\nSeverity\n--------\nLow – Practical exploitation of cryptographic encapsulation is typically complex; However, identification of supported ciphers is trivial.\nThe severity of this issue primarily relates to the ease of identification, with insecure configurations often being used by the media and general public as indicators of overall security posture. \n\nIf left unresolved, this issue may lead to reputational impacts for the organisation.\n\n*** Consider increasing severity if practical attacks are feasible (untrusted certificate, anonymous exchange, or null cipher) ***\n\n\nRecommendation\n--------------\nLateral Security recommends explicitly disabling support for insecure ciphers and protocols, with manual verification (according to reproduction details) to confirm settings have been correctly applied.\nInternal documentation should be established for the commissioning of future systems to ensure appropriate settings are applied from conception.\n\nA guide to recommended encryption practices can be found at: \n```\nhttps://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices\n```\n\nConsider applying Certificate Authority Authorization (DNS CAA) as a defense-in-depth security measure against ad-hoc certificate generation (dependent on the organisation's existing certificate deployment and management solution).\n"},{"title":"Tester Notes: (ref https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices)","category":"External Network Pentest","contents":"Tester Notes: (ref https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices)\n* Private Keys\n  * Private keys should be >=2048bit RSA, or >=256bit ECDSA (eliptic curve). These provide 112 and 128 bits of security respectively.\n  * A small number of older clients don't support ECDSA. Support both if possible.\n  * Keys should be encrypted (but we shouldn't have visibility over key storage in most cases)\n* Certificate naming\n  * Certificates should be valid for all the hostnames they are used on. e.g. both \"www.lateralsecurity.com\" and \"lateralsecurity.com\"\n  * Wildcard certificates should be avoided as it increases the likely number of people having access to an \"impersonate entire domain\" free-pass.\n  * The subject alternative name (SAN) extension should be used and >= the Common Name (CN) field. Newer browsers don't check CN for validation.\n* Certificate Authority\n  * Should be trusted. (I'm lookin' at you GeoTrust, https://en.wikipedia.org/wiki/GeoTrust) None of these should still be in circulation though.\n  * Shouldn't be self-signed. An internal CA may be fine if the site is only consumed / accessible internally.\n  * Should support Certificate Revocation List (CRL) and Online Certificate Status Protocol (OCSP).\n  * Issuing CA can be whitelisted by adding a DNS CAA record to the domain. We don't typically check this.\n* Certificate Signing\n  * Leaf certificate SHOULD be SHA256 signed. (MD5 is breakable in practice, SHA1 is likely breakable by state level).\n  * Intermediate certificates MUST be SHA256, otherwise will be rejected by browsers.\n  * Entire certificate chain should be sent to the client, rather than assuming the client knows about the intermediaries.\n\n* Protocol Support\n  * SSLv2 and SSLv3 are insecure, TLSv1.0 and TLSv1.1 are considered legacy/deprecated, TLSv1.2 and TLSv1.3 are recommended.\n  * TLSv1.0 and TLSv1.1 may be required to support older clients. Credit card payments (PCI DSS) MUST NOT use SSLvX or TLSv1.0.\n  * TLSv1.1 doesn't contain known vulnerabilities; however, it also does not support modern ciphers.\n  * TLSv1.3 provides better performance, security, and removes insecure features; ciphers,compression, etc\n\n* Cipher Suites to Avoid\n  * Anonymous Diffie-Hellman (ADH) - This does not provide authentication.\n  * NULL cipher - This does not provide encryption.\n  * Export ciphers (usually prefixed with EXP) - These are intentionally weak so that they could get around USA crypto-export requirements.\n  * Weak ciphers (112 bits or less).\n  * RC4 - Straight up insecure, uses XOR keystreams.\n  * 3DES / DES / RC2 / IDEA - These are 64bit block ciphers, old, and weak.\n  * RSA key exchanges (TLS_RSA) - Also old and weak. Preferred alternative is ECDHE, with DHE as fallback.\n\n* Cipher Suites to Recommend\n  * AEAD (Authenticated Encryption with Associated Data) cipher suites – CHACHA20_POLY1305, GCM and CCM.\n  * PFS (Perfect Forward Secrecy) ciphers – ECDHE_RSA, ECDHE_ECDSA, DHE_RSA, DHE_DSS, CECPQ1 and all TLS 1.3 ciphers.\n    * Does not rely on the server's private key, meaning that historical traffic cannot be decrypted if the private key is compromised.\n\nReally good reference (from other security consultancy vendor)\n-> https://gracefulsecurity.com/tls-ssl-vulnerabilities/"},{"title":"ENP-X IKE Aggressive Mode Enabled","category":"External Network Pentest","contents":"ENP-X IKE Aggressive Mode Enabled\r\n=================================\r\n\r\nDescription\r\n-----------\r\nWhen negotiating an IPSec VPN tunnel IKE is used, and it can operate in one of two modes either ‘Main mode’ or ‘Aggressive mode’. The Virtual Private Network (VPN) configuration ***within the firewall files provided*** was found to be running in aggressive mode, in which the number of requests is minimized and a hash of the preshared key is sent to the VPN service. The preshared key hash can be brute forced with sufficient time. The VPN’s group name also needs to be known for a successful attack.\r\n\r\nReproduction Details\r\n--------------------\r\nTo reproduce this issue, run:\r\n  * ike-scan -A ***ip***\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nLow – An attacker can brute force the group name and encryption keys of the VPN session and gain complete access to the network. Depending on the strength of the VPN group name and pre-shared key, this may require some time, however once the group name has been established, cracking the key can be performed offline. ***In the case of trying to crack the 3DES encryption, an attacker would need to perform a man in the middle attack to intercept the traffic first.***\r\n\r\nRecommendation\r\n--------------\r\nLateral Security recommends the VPN is configured to use main mode rather than aggressive mode for the initial session establishment. This will prevent the preshared key from being disclosed. Irrespective of whether aggressive mode or main mode is used, if a preshared key is used, it should be strong (over ten characters, a mix of upper and lower case letters and numbers).\r\nIf it is not in place already, centralised logging should be considered so if attempts are made to brute force the group name, these can be observed and responded to in a prompt manner.\r\nFinally, if the VPN is used to connect the several known locations or specific systems, IP address whitelisting should be used to prevent third parties from connecting to the VPN endpoints and attempting to crack the credentials.\r\n\r\n"},{"title":"﻿ENP-4 Insecure Transport Layer Security","category":"External Network Pentest","contents":"﻿ENP-4 Insecure Transport Layer Security\r\n=======================================\r\n\r\nDescription\r\n-----------\r\nThe implementation is using weak cryptographic protocols to secure communication. Transport Layer Security (TLS) and the Secure Sockets Layer (SSL) protocols are cryptographic protocols designed to secure the communication between networked computers. All versions of SSL and some versions of TLS are known to be insecure. Some ciphers accepted by the servers to secure these protocols are weak and known to be insecure.\r\nSome servers are accepting SSLv3 connections. SSLv3 has vulnerabilities. These include:\r\n  * BEAST (CVE-2011-3389) - a man-in-the-middle attack of TLSv1.0 and SSL can be performed on some CBC mode ciphers in order to expose the plaintext of a communication\r\n  * POODLE (CVE-2014-3566) - an attack on the SSLv3 padding which allows the calculation of the plaintext of a communication\r\nThe servers are accepting ciphers with known weaknesses. These include:\r\n  * RC4-based ciphers - RC4 has biases in its cipherstream which an attacker can use to recover the plaintext of a communication\r\n  * MD5-based ciphers - MD5 is vulnerable to collision attacks\r\n    * http://eprint.iacr.org/2013/170.pdf\r\n  * SHA1-based ciphers - SHA-1 is vulnerable to collision attacks\r\n    * https://shattered.io/\r\n  * 3DES-based ciphers – 3DES uses a 64-bit block size, which is vulnerable to a birthday attack known as SWEET32.\r\n    * https://sweet32.info/\r\n\r\nSome servers have self-signed certificates which are expired. Self-signed certificates have not been signed by a trusted authority. Self-signed certificates prevent users from detecting man-in-the-middle attacks. If a certificate is expired, it is not possible to detect its revocation status. Some of these certificates do not seem to reflect the hostname of the hosts to which they are assigned.\r\n\r\nReproduction Details\r\n--------------------\r\nTo see that some servers use weak protocols and ciphers, use a command line tool, such as sslscan, to query the web server for supported cryptographic protocols and ciphers. However, this finding was discovered through a Nessus scan.\r\n```\r\nsslscan --nofailed <IP>\r\n```\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***See Appendix B***\r\n\r\nSeverity\r\n--------\r\nMedium – Were an attacker able to successfully exploit these weaknesses, sensitive data might be captured and exfiltrated. The organisation could suffer reputational damage from malicious use or leaks of this data.\r\n\r\nRecommendation\r\n--------------\r\nConfigure the servers to secure communication using TLSv1.2 and modern ciphers with no known weaknesses. Disable compression and have a trusted certificate authority sign all tickets. More information about securing web communication can be found at the following location:\r\n  * https://wiki.mozilla.org/Security/Server_Side_TLS\r\nThe widespread use of TLS v1.3 is imminent. Web browsers, which support it, have already been released to the public. How the implementation could accommodate this new protocol should be considered.\r\n"},{"title":"EPT-X Remote Desktop Enabled","category":"External Network Pentest","contents":"EPT-X Remote Desktop Enabled\n============================\n\nDescription\n-----------\n\nThe Remote Desktop Web Service (RD Web) was exposed to the Internet and using NTLM authentication. Remote Desktop commonly authenticates against Active Directory. By having this exposed, an attacker may be able to brute force domain passwords. This poses two key threats:\n * An attacker could use common dictionary words (and variations of them) across a large number of user accounts and attempt to gain access to remote desktop. This could result in remote access to machines within the network.\n * An attacker could attempt to lock out a large number of accounts by intentionally entering invalid passwords, resulting in disruptions to users and increased helpdesk calls.\n \nLateral Security did not attempt to gain access to accounts using this technique, however exploitability would depend on a number of factors, including:\n * The password policies in place\n * The account lockout policies\n * The number of users in the groups which have access\n * Whether 2FA is in use which is activated after login\n \nUsernames and potentially passwords can be obtained using password leaks or open source intelligence (OSINT) databases.\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***HOST***\n  \nSeverity\n--------\nMedium – An attacker could gain access to remote desktop and gain access to the network. They could also potentially lock out user accounts.\nThe degree of access obtained after a successful login would depend heavily on the network architecture, the hardening of the remote desktop services/applications and the permissions provided to the compromised account.\n\nRecommendation\n--------------\nThis is an issue inherent in exposing Remote Desktop Web Services to the Internet, however a number of settings can be configured to mitigate the potential threats associated with it:\n * As the administrator account does not lock out, ensure the administrator account has been renamed.\n * Configure a separate Remote Access lockout policy with a lockout threshold which is less than for the on-premise domain.\n * Enable multi-factor authentication to ensure a password compromise alone would not result in remote access to systems on the network.\n * If practical, ensure the remote desktop systems are on a network zone with access to as few resources as can be achieved.\n * Ensure as few users as required have permission to log in using remote desktop. Processes should be in place for on-boarding and off-boarding, and the users in this group should be audited regularly.\n * Ensure the accounts which have remote access have only the access on the network which is required to perform their roles/functions.\n * Restrict access using IP Whitelisting, if practical.\n * Carry out hardening on any applications/servers which are exposed over remote desktop. Hardening should be in line with an industry benchmark such as those provided by the Center for Internet Security.\n * Ensure a strong password policy is in place. Lateral Security recommends it is based on the recommendations in the New Zealand Information Security Manual (NZISM).\n * Ensure logs are retained on a centralised logging server, and that these are monitored, and alerts are generated for anomalous activity.\n"},{"title":"Taken from:","category":"External Network Pentest","contents":"Taken from:\nhttps://supportforums.cisco.com/document/12276506/diffie-hellman-groups\n\nDiffie-Hellman group 1  -  768 bit modulus  - AVOID\nDiffie-Hellman group 2  - 1024 bit modulus  - AVOID\nDiffie-Hellman group 5  - 1536 bit modulus  - AVOID\nDiffie-Hellman group 14 - 2048 bit modulus – MINIMUM ACCEPTABLE\nDiffie-Hellman group 19 - 256 bit elliptic curve – ACCEPTABLE\nDiffie-Hellman group 20 - 384 bit elliptic curve – Next Generation Encryption\nDiffie-Hellman group 21 - 521 bit elliptic curve – Next Generation Encryption\nDiffie-Hellman group 24 - modular exponentiation group with a 2048-bit modulus and 256-bit prime order subgroup – Next Generation Encryption\n"},{"title":"CR-7 Exposed Administrative Interface","category":"Fortinet Device Review","contents":"CR-7 Exposed Administrative Interface\n=====================================\n\nDescription\n-----------\nRemote management has not been disabled on the external interface. ***The remote interface, “wan0”, has been set to allow ping and https.***\n\nReproduction Details\n--------------------\nTo see that remote management is enabled on the external interface, ***notice that the stanza for the configuration of “wan1” has not disallowed access. The example below provides an example of the “unset” directive, which is missing.***\nconfig system interface\nedit \"wan1\"\nunset allow access\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SYSTEM***\n\nSeverity\n--------\nLow – Leaving this interface accessible increases the attack surface of the implementation. ***An interface, suitable for remote administration, the VPN, already exists. ***\n\nRecommendation\n--------------\nDisable remote management on the external interface. Instead, one of the internal interfaces should be used by way of the VPN. See “Only allow administrative access to the external interface when needed” from the link below for more information.\n  * https://docs.fortinet.com/document/fortigate/6.2.0/hardening-your-fortigate/612504/hardening-your-fortigate\n"},{"title":"CR-9 Malware Statistics Disclosure","category":"Fortinet Device Review","contents":"CR-9 Malware Statistics Disclosure\n==================================\n\nDescription\n------------\nThe firewall has not been configured to explicitly disable the sending of malware statistics to the vendor. By default, the firewall will provide information to the vendor to help the vendor provide better support.\n\nReproduction Details\n--------------------\nTo see that sending malware statistics to Fortiguard has not been explicitly disabled in the configuration, notice that a stanza is not included which contains the following strings:\n\nconfig system global\nset fds-statistics disable\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SYSTEM***\n\nSeverity\n--------\nLow – This does not follow the recommended hardening guide from the vendor. This information might provide information to the vendor which would indicate vulnerabilities in the implementation.\n\nRecommendation\n---------------\nTo prevent this information disclosure, this feature should be disabled. For more information, see the section, “Disable sending Malware statistics to Fortiguard” in the link below.\n * https://docs.fortinet.com/document/fortigate/6.2.0/hardening-your-fortigate/612504/hardening-your-fortigate\n"},{"title":"CR-8 No Two-factor Authentication","category":"Fortinet Device Review","contents":"CR-8 No Two-factor Authentication\n=================================\n\nDescription\n-----------\nTwo-factor authentication has not been configured for access to the administrative interface of the firewall. The firewall provides multiple means of two-factor authentication, including certificate, email, SMS, and FortiToken.\n\nReproduction Details\n--------------------\nTo see that two-factor authentication has not been enabled in the configuration, notice that a stanza is not included which contains the following strings.\n\nconfig user local\nset two-factor <2nd factor>\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SYSTEM***\n\nSeverity\n--------\nLow – Two-factor decreases the chances that compromised credentials would allow an attacker to gain access to the implementation. Not using two-factor authentication does not follow good practice.\n\nRecommendation\n--------------\nConfigure the firewall to use two-factor authentication. Lateral Security recommend using certificate-base two-factor authentication. More information can be found in the section, “Two-factor authentication” of the link below.\n * https://docs.fortinet.com/document/fortigate/6.2.0/hardening-your-fortigate/612504/hardening-your-fortigate\n"},{"title":"CR-11 Vulnerable Configuration","category":"Fortinet Device Review","contents":"CR-11 Vulnerable Configuration\n==============================\n\nDescription\n-----------\nThe firewall device has been configured to allow its configuration to be reset with a USB drive inserted into the device followed by a device power cycle. Under these conditions, the device will attempt to load its configuration from the USB drive.\n\nReproduction Details\n--------------------\nTo see that auto-install via USB has not been disabled, notice that a stanza is not included which contains the following strings. Instead, these are set to “enable”.\n\nconfig system auto-install\nset auto-install-config disable\nset auto-install-image disable\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SYSTEM***\n\nSeverity\n--------\nMedium – This vulnerability would require physical access to the device, but could allow an attacker to replace the configuration of the device with one provided by the attacker.\n\nRecommendation\n--------------\nThe auto-install via USB functionality should be disabled on the device. For more information, see \"Disable auto installation via USB\" in the link below.\n * https://docs.fortinet.com/document/fortigate/6.2.0/hardening-your-fortigate/612504/hardening-your-fortigate\n"},{"title":"CR-10 Weak Password Requirements","category":"Fortinet Device Review","contents":"CR-10 Weak Password Requirements\nDescription\nThe firewall configuration does not require password to meet the standards of the New Zealand Information Security Manual. The default password length requirement of the firewall is 8 characters.\nReproduction Details\nTo see that the configuration is not following a password policy recommended by NZISM, notice that a stanza is not included which contains the following strings.\nconfig system password-policy\nstatus enable\nset minimum-length 16\nSystems Affected\n\t[SYSTEM]\nSeverity\nMedium – Weak password requirements make it easier for an attacker to brute force a system.\nThis configuration does not meet the requirements of NZISM 16.1.21.\nRecommendation\nThe configuration should adhere to the password recommendations of NZISM. Lateral Security recommend setting a minimum length for passwords of 16 characters.\n"},{"title":"Pay attention to the upgrade paths.","category":"Fortinet Device Review","contents":"Pay attention to the upgrade paths.\r\nhttp://cookbook.fortinet.com/sysadmins-notebook/supported-upgrade-paths-fortios/#Build_Numbers\r\n\r\nthe command to see the version is:\r\nget system status\r\n\r\none way to figure this out might be to google the build number\r\n"},{"title":"GHR-X DNS Tunnelling","category":"Generic Host Review","contents":"GHR-X DNS Tunnelling\n====================\n\nDescription\n-----------\nDNS tunnelling is a technique used to communicate arbitrary data through the DNS protocol. The technique can evade common network controls, such as firewalls. The network configuration permits DNS tunnelling, so bidirectional communication to the Internet is possible.\n\nFurther information can be found within the SANS whitepaper, \"Detecting DNS Tunnelling\", at the following location:\n  * https://www.sans.org/reading-room/whitepapers/dns/detecting-dns-tunnelling-34152\n\nThis issue was identified as part of a system configuration review, but this issue might not be limited to reviewed systems. The configuration of DNS servers enables DNS tunnelling.\n\nReproduction Details\n--------------------\nTo see that DNS tunnelling is possible, issue the ping command to any externally hosted domains. Observe that the domain name is resolved to an IP address.\n```\nping -4 -n 1 yahoo.com\n```\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SYSTEM***\n\nSeverity\n--------\nLow – An attacker could send a small amount of data along with a domain record request to an Internet-residing domain which is controlled by the attacker. The DNS response from this domain record request could carry data from the Internet, allowing the attacker to receive and exfiltrate data outside of the organisation. This technique can be used by any attacker with local access to an affected system.\n\nRecommendation\n--------------\nConfigure a dedicated DNS service for the project. For specific systems which require recursive queries, specifically allow such hosts to query upstream servers. Consider either disabling queries or implementing a separate \"split-view\" DNS configuration for those systems. Ensure recursive DNS is not required by any service for normal operation.\n"},{"title":"GHR-X Unfiltered Egress","category":"Generic Host Review","contents":"GHR-X Unfiltered Egress\r\n=======================\r\n\r\nDescription\r\n-----------\r\nThe implementation allows unrestricted egress. Connections originating from a host to the Internet will not be restricted. A brief list of examples of traffic allowed would include web traffic, DNS lookups, file transfers, and remote administrative sessions.\r\n\r\nReproduction Details\r\n--------------------\r\nFrom the host, issue the commands below. This will return OK 200.\r\n```\r\ninvoke-webrequest http://www.google.com/ | select StatusDescription,StatusCode\r\n```\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nMedium – An attacker could use this weak configuration to exfiltrate data from the implementation. If sensitive data were exfiltrated, reputational harm might result to the organisation. This attack would require that the attacker already have access to a system within the implementation.\r\n\r\nRecommendation\r\n--------------\r\nNetwork devices, such as routers and firewalls, should restrict access to the Internet. Only external services required by the hosts should be allowed. The host firewalls should also restrict outgoing connection to only those required.\r\n"},{"title":"GHR-X Unsecured IPv6 Configuration","category":"Generic Host Review","contents":"GHR-X Unsecured IPv6 Configuration\r\n==================================\r\n\r\nDescription\r\n-----------\r\nIPv6 is enabled on several systems, but has not been secured. IPv6, Internet Protocol version 6, is a replacement for IPv4 currently used for addressing most of the Internet. IPv6 comes enabled by default on many operating systems and network devices, but this is often forgotten and IPv6 security measures are frequently omitted.\r\n\r\nReproduction Details\r\n--------------------\r\nTo see that a Windows host is configured for IPv6, issue the following command from PowerShell.\r\nipconfig|select-string IPv6\r\nTo see that a Linux host is configured for IPv6, issue the following command from the console.\r\nifconfig|egrep inet6\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nLow – Any exposed service and protocol increases the chances that vulnerabilities of a system, its attack surface, will be discovered. IPv6 provides an additional vector of attack in the environment and network controls for this protocol are often left out of an implementation. An attacker might be able to reach a host or service over IPv6, even if access over IPv4 has been blocked.\r\nEnabling IPv6 does not create a vulnerability, by itself.\r\n\r\nRecommendation\r\n--------------\r\nMicrosoft does not recommend disabling IPv6 support on Windows operating systems, citing potential stability concerns:\r\n\"Internet Protocol version 6 (IPv6) is a mandatory part of Windows Vista and later versions. We do not recommend that you disable IPv6 or its components, or some Windows components may not function.\"\r\n  * http://support.microsoft.com/kb/929852\r\nUnless IPv6 will be used by the implementation, Lateral Security recommends prohibiting IPv6 communication through Windows Firewall. Create new inbound firewall rules to deny communication for all services for both IPv6 and ICMPv6. NDP is a subset of ICMPv6. Preventing such communication will prevent NDP from successfully communicating.\r\nThe implementation of IPv6 networks will continue to increase, just as its addressing has increased on the Internet. If a policy does not exist which speaks to this trend and how the organisation will leverage it, then consider such a policy and how IPv6 services will be secured.\r\n"},{"title":"INP-X SNMP With Default Community Strings","category":"Internal Network Pentest","contents":"INP-X SNMP With Default Community Strings\n===============================\n\nDescription\n-----------\nSNMP (Simple Network Management Protocol) is a UDP based service which typically provides diagnostic information and sometimes offers the ability to reconfigure device parameters. This protocol is unencrypted and for most versions (v1, v2c), relies solely on the consumer knowing the configured “community string” of the device. This string is most commonly the value “public” or “private” although some vendors use their own default values.\n**Remove this if the issue only relates to one system:** Lateral Security identified that SNMP was available on multiple hosts within the networked environment.\n\nThis can sometimes be used for reflected denial-of-service (DoS) attacks, which are achieved by sending a small request to the server which results in a large response back.\nIf an attacker impersonates a targeted system when sending this small packet, then the SNMP will send the larger packet to the victim, consuming network resources.\n\nInformation disclosed by the service can often be of benefit to an attacker, potentially including:\n* Routing rules.\n* Additional networking interfaces.\n* Running services (including run flags).\n\n\nReproduction Details\n--------------------\nTo identify hosts running SNMP, conduct a network scan for UDP port 161.\n```\nnmap -sU -p 161 –script snmp-info <host>\n```\nIndividual instances can be confirmed using snmpwalk or other tools from the net-snmp package.\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * *** SYSTEM - Indicate if GETBULK/DoS is supported or if any interesting info is disclosed ***\n\nSeverity\n--------\nLow – An attacker can leverage SNMP access to gain information about the running device. This often includes software versions, active processes, or active network connections. In some cases, it may permit the reconfiguration of the device.\n\n\nRecommendation\n--------------\nLateral Security recommends reviewing whether the identified hosts require SNMP to be enabled, disabling it where deemed unnecessary or restricting access to only required hosts via firewall rules when it is required. \n\nIt is suggested to change the community string used by the devices; however, this is not considered to be a robust security control. \nSNMPv3 permits the use of authentication prior to accepting request; however, many devices do not support this revision.\n\n"},{"title":"INP-X TEMPLATE","category":"Internal Network Pentest","contents":"INP-X TEMPLATE\n===============================\n\nDescription\n-----------\n\n\nReproduction Details\n--------------------\n\n\nSystems Affected\n----------------\n  * ***SITE***\n\n\n  Severity\n--------\nInfo – \n\n\nRecommendation\n--------------\n\n\n"},{"title":"INP-X Layer 2 Information Disclosure","category":"Internal Network Pentest","contents":"INP-X Layer 2 Information Disclosure\r\n====================================\r\n\r\nDescription\r\n-----------\r\nDevices broadcast layer 2 network packets which might provide useful information to an attacker. The CDP packets being broadcast indicate the version of Cisco IOS running on a switch. The STP packets indicate that it might be possible to influence network topology.\r\n\r\nReproduction Details\r\n--------------------\r\nUse a tool, such as Wireshark, to passively listen to all packets on the link for about a minute. To ease reading, you can filter the capture so that only CDP and STP packets are shown.\r\nClick on a CDP packet. Expand the tree until all of \"Software Version\" can be read.\r\nThe CDP packets indicate that version 10.0(0)A1 is running on the switch. That version has at least one published vulnerability at the time of reporting.\r\n  * CVE-1993-0900\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nMedium – The information provided by these packets could help an attacker learn which exploits the broadcasting device is vulnerable to. In this case, the version of IOS on the switch has at least one vulnerability. The CDP packets also indicate the native VLAN of the switch.\r\n\r\nThis issue indicates a lack of adherence to NZISM:\r\n  * 18.1.13. Management Traffic\r\n\r\nRecommendation\r\n--------------\r\nDisable CDP packet broadcasts. STP packets should not be disabled, but, instead, ensure that Cisco's BDPU guard is enabled, if not already, on all ports which connect to client hosts and devices to prevent those from affecting the network topology. Cisco provide documentation on this feature:\r\n  * http://www.cisco.com/c/en/us/support/docs/lan-switching/spanning-tree-protocol/10586-65.html\r\n\r\nOther hardening should be configured on the device, if it has not already been done. Cisco provide a guide to hardening Cisco devices.\r\n  * http://www.cisco.com/c/en/us/support/docs/ip/access-lists/13608-21.html\r\n"},{"title":"INP-X Circumventable Jump Host","category":"Internal Network Pentest","contents":"INP-X Circumventable Jump Host\r\n==============================\r\n\r\nDescription\r\n-----------\r\nA jump host has been configured for the environment, but is not required for access to most of the hosts in scope. A jump host is a computer which has been secured to manage hosts and devices in a separate security zone from where connections originate, such as an internal network. Jump hosts aide in accountability and monitoring, since they act as a choke point for all access into separate security zones.\r\n\r\nReproduction Details\r\n--------------------\r\nTo reproduce this issue, log into the firewall. This will allow you to access the jump host and most of the other servers within the scope of the engagement directly from the corporate LAN.\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nLow – The lack of a jump host increases the attack surface of the environment from the perspective of an attacker coming from the corporate LAN. This is because more of the environment is visible from the corporate LAN, once authentication to the firewall has occurred. If any of the machines that the jump host is meant to protect has a vulnerability, then that host becomes directly exploitable from the corporate LAN.\r\n\r\nRecommendation\r\n--------------\r\nOnly allow one server, a secured jump host, to reach the administrative interfaces on hosts which are in a separate security zone. Patch that jump host routinely and ensure that monitoring and logging has been configured.\r\n"},{"title":"INP-X Default Credentials in Use","category":"Internal Network Pentest","contents":"INP-X Default Credentials in Use\n===============================\n\nDescription\n-----------\nThe use of default credentials on devices and services is a security weakness which allows attackers to connect to the affected systems, \nperforming actions as the authenticated user-level associated with the credentials (typically administrative).\n\nManagement of authentication is included in CERT NZ's top 10 Critical Controls, based on attacks observed within New Zealand organisations.\n\n\nReproduction Details\n--------------------\n\nConnect to the following hosts using the supplied default credentials:\n* *** Add hosts/creds here ***\n\n\n\n\nSystems Affected\n----------------\nThe following hosts are affected by this issue: \n  * ***SITE***\n\nWhile this list contains the systems observed as having default credentials during testing, \nit should not be considered as a comprehensive credential review for the organisation as a whole.\n\n\nSeverity\n--------\nCritical/Medium – The access achieved through authenticated access to these systems permits at attacker to:\n* Fully compromise hosts.\n* Replace device firmware to maintain persistent access to the environment.\n* Access sensitive information from the hosts.\n* *** Make sure these bullets are correct (obviously) add/remove as required ***\n\n\nRecommendation\n--------------\nLateral Security recommends changing default credentials to unique, secure passwords.\nThese should be stored in a secure location (password manager or similar).\n\nCERT NZ provides guidance for this issue at:\n* https://www.cert.govt.nz/it-specialists/critical-controls/manage-authentication/changing-default-credentials/\n\nIf passwords are hardcoded (unable to be changed) or key functionality is available without authentication,\nthen it is recommended to either remove the device/service or isolate it through network segmentation and separation.\n\nInternal confirmation across all devices in the organisation is suggested to cover instances which may have been missed during testing."},{"title":"INP-X Domain Cached Credentials","category":"Internal Network Pentest","contents":"INP-X Domain Cached Credentials\n===============================\n\nDescription\n-----------\nThroughout the network, Lateral Security identified the registry key 'HKLM\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\ Winlogon\\CachedLogonsCount' is not 0. Using a value greater than 0 for the CachedLogonsCount key indicates that the remote Windows host locally caches the passwords of the users when they login, in order to continue to allow the users to login in the case of the failure of the primary domain controller (PDC).\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SYSTEM***\n\nSeverity\n--------\nMedium – Cached logon credentials could be accessed by an attacker and subjected to brute force cracking attempts result in account compromise.\n\nRecommendation\n--------------\nLateral Security recommends setting the registry key: 'HKLM\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon\\CachedLogonsCount' to a value of ‘0’ with the exception of devices such as laptops used by staff who work off-site frequently or have limited access to the physical network.\n"},{"title":"INP-X Exposed Administrative Interfaces","category":"Internal Network Pentest","contents":"INP-X Exposed Administrative Interfaces\r\n=======================================\r\n\r\nDescription\r\n-----------\r\nDevices on the wired network have exposed administrative web interfaces, which are reachable from all subnets. At least one device is configured with the default administrative login and password. Some other devices with exposed administrative interfaces include printers and phones.\r\n\r\nReproduction Details\r\n--------------------\r\nUse a program, such as arp-scan, to perform an ARP ping scan on a network link of the solution. The example below would scan the first of the wired subnets.\r\n\r\n    arp-scan --interface=eth0 10.0.0.0/24\r\n\r\nLook for the IP address of the device with the MAC of 00:00:00:00:00:00. This is a phone. From a web browser, enter that resultant IP in the address bar to view the configuration utility. The default administrative username and password, which has been published on the Internet, can be used to log in to web interface.\r\nOther administrative interfaces for devices on the network can be seen by following a similar process.\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nHigh – Because configuration of the phones can be altered, telecommunication services could be disrupted. Were printers reconfigured maliciously, then printing services could suffer the same consequence. It might be difficult to trace the cause of the disruption. In worse cases, these devices might be used as platforms to launch attacks on the rest of the solution and might help an attacker acquire sensitive information.\r\n\r\nThis issue indicates a lack of adherence to NZISM:\r\n  * 16.3.5. Use of priviliged accounts\r\n  * 18.3.10. Local area network traffic separation\r\n\r\nRecommendation\r\n--------------\r\nPlace all devices, which clients will not need to reach directly, on a separate physical network or VLAN. Configure those devices so that their administrative web interfaces are disabled, if not needed. Change the default administrative password for each device."},{"title":"INP-X Insecure Device Failover","category":"Internal Network Pentest","contents":"INP-X Insecure Device Failover\r\n==============================\r\n\r\nDescription\r\n-----------\r\nAt least one network device is configured for failover through the use of the Hot Standby Router Protocol (HSRP) with the default, plain text password. This password is sent insecurely across the network. An implementation uses HSRP to meet high availability requirements. Two or more network devices can share a virtual IP address. This IP address acts as the router for a given network, and should one device fail, that IP address is automatically acquired by one of the remaining network devices which will then act as the router.\r\n\r\nReproduction Details\r\n--------------------\r\nUse a tool, such as Wireshark, to passively listen to all packets on the link for about a minute. To ease reading, you can filter the capture so that only HSRP packets are shown.\r\nClick on the HSRP packet. Expand the tree of \"Cisco Hot Standby Router Protocol\" so that it can be read.\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nHigh – With this information, the platform of an attacker could be configured to act as the router in order to launch a denial of service or a man-in-the-middle attack on the network by pre-empting the HSRP election process.\r\nThe existence of HSRP communication indicates a lack of adherence to NZISM v2.4 18.1.13.C.01, which states that agencies should implement protection measures to minimise the risk of unauthorised access to network management traffic on a network.\r\n\r\nRecommendation\r\n--------------\r\nIf the solution does not require high availability and does not have device redundancy on the network, then disable HSRP on the device. Otherwise, change the HSRP password and configure HSRP to use hash authentication instead of plain text. Other hardening should be configured on the device, if it has not already been done. Cisco provide a guide to hardening Cisco devices.\r\n    http://www.cisco.com/c/en/us/support/docs/ip/access-lists/13608-21.html\r\n"},{"title":"INP-X Insecure FTP Service","category":"Internal Network Pentest","contents":"INP-X Insecure FTP Service\r\n==========================\r\n\r\nDescription\r\n-----------\r\nThe FTP server running on some devices would allow an attacker to connect to a third party host or device and some directories on those same devices have world writable directories. Anyone on the network with access to this service can use the device to store data.\r\n\r\nReproduction Details\r\n--------------------\r\nUse a tool, such as Nessus, to scan the internal network for vulnerabilities.\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nLow – An attacker could use this vulnerability to enumerate services which, otherwise, would not be reachable due to firewall restrictions. An attacker could use the world writable directories to aid in data exfiltration or to store tools for further penetration.\r\n\r\nRecommendation\r\n--------------\r\nConsider disabling FTP on these devices, patching the devices, or configuring them to reject connections from reserved ports and writing from all users."},{"title":"INP-X Insecure Network Management","category":"Internal Network Pentest","contents":"INP-X Insecure Network Management\r\n=================================\r\n\r\nDescription\r\n-----------\r\nDevices on the network have been configured to use a version of SNMP prior to version 3. These older versions of the protocol are not secure. SNMPv1 and SNMPv2 lack cryptographic security which helps to protect the sensitive diagnostic information and management access that SNMP provides. SNMPv1 and SNMPv2 use a community string for access control, and this string traverses the network in the clear. The devices are configured to use the default community string.\r\n\r\nReproduction Details\r\n--------------------\r\nUse a tool, such as Wireshark, to passively listen to all packets on the link for about a minute. To ease reading, you can filter the capture so that only SNMP packets are shown. Click on an SNMP packet. Expand the tree of \"Simple Network Management Protocol\" so that it can be read. The community parameter shows that the string is \"public\", which is the default.\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nMedium – By using SNMPv1, the implementation remains vulnerable to traffic sniffing for any attacker who might gain access to the network. The type of information typically provided over SNMP includes that which might help an attacker enumerate hosts, devices, and possibly even acquire passwords.\r\n\r\nThis issue indicates a lack of adherence to NZISM:\r\n  * 18.1.14. Simple Network Management Protocol\r\n\r\nRecommendation\r\n--------------\r\nSNMPv1 should be replaced with SNMPv3 and segregated to a dedicated management network or it should be disabled.\r\n"},{"title":"INP-X Insecure RDS","category":"Internal Network Pentest","contents":"INP-X Insecure RDS\r\n==================\r\n\r\nDescription\r\n-----------\r\nThe remote desktop service (RDS) does not require that administrators use network level authentication (NLA) during login. NLA forces a client computer to present credentials for authentication before the server will create a session for the user. Because a full session is not created until this authentication occurs, the chance of denial of service is reduced.\r\n\r\nThe RDS configuration enables the weak cryptographic algorithms, RC4 and MD5.\r\n\r\nRC4 has small biases in its generated ciphertext. After the encryption of a given plaintext many times, the probability to decrypt the ciphertext approaches near certainty.\r\n  * http://blog.cryptographyengineering.com/2013/03/attack-of-week-rc4-is-kind-of-broken-in.html\r\n\r\nMD5 is an algorithm which is known not to be collision resistant. As a result, exploits of MD5 have made it possible to fake SSL certificate validity.\r\n  * http://www.kb.cert.org/vuls/id/836068\r\n\r\nReproduction Details\r\n--------------------\r\nUse a tool, such as Nessus, to scan the internal network for vulnerabilities. The report will indicate these weaknesses.\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nMedium – The current RDS configuration is vulnerable to a man-in-the-middle attack. An attacker could hijack an administrative session to steal the credentials of an administrator.\r\n\r\nExploitation of the cryptographic weaknesses is possible. Disclosure of sensitive information, including login credentials, might be obtained. However, the difficulty and time required for the exploitation make other attacks more attractive.\r\n\r\nThis issue indicates a lack of adherence to NZISM:\r\n  * 17.8.14. HMAC algorithms\r\n\r\nRecommendation\r\n--------------\r\nForce all RDS use to use NLA. Disable RDS on all hosts which will not require it.\r\n\r\nEnsure that clients connect with secure cryptographic algorithms. Microsoft have a page for Server 2008 R2 RDS security settings.\r\n  * https://technet.microsoft.com/en-us/library/cc753488.aspx\r\n"},{"title":"INP-X Insecure Remote Desktop Service","category":"Internal Network Pentest","contents":"INP-X Insecure Remote Desktop Service\n=====================================\n\nDescription\n-----------\nThe remote desktop service (RDS) does not require that administrators use Network Level Authentication (NLA) during login. NLA forces a client computer to present credentials for authentication before the server will create a session for the user. Because a full session is not created until this authentication occurs, the likelihood of denial of service is reduced.\nThe RDS configuration enables the weak cryptographic algorithms, RC4 and MD5, which both contain vulnerabilities which could undermine the confidentiality of the transport.\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n * ***SYSTEMS***\n \nSeverity\n--------\nLow –The remote desktop service has not been hardened in line with good practice guidelines. Having NLA disabled increases the exposure of the service to attackers and is a violation of the principle of least privilege. \n\nRecommendation\n--------------\nRequire remote desktop users to use NLA. Disable remote desktop on all hosts which do not require it.\n\nEnsure that clients connect with secure cryptographic algorithms.\n\nFor more information, see:\n * https://technet.microsoft.com/en-us/library/cc753488.aspx\n"},{"title":"INP-X Insecure SSH","category":"Internal Network Pentest","contents":"INP-X Insecure SSH\n==================\n\nDescription\n-----------\nSSH uses the weak cryptographic algorithms, CBC and SHA-1. CBC, cipher block chaining, is vulnerable to padding oracle attacks.\n  * https://grymoire.wordpress.com/2014/12/05/cbc-padding-oracle-attacks-simplified-key-concepts-and-pitfalls/\n\nSHA-1, a hash function, is probably vulnerable to collision attacks.\n\nReproduction Details\n--------------------\nUse a tool, such as Nessus, to scan the internal network for vulnerabilities. The report will indicate that some hosts and devices are using weak cryptographic algorithms.\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SYSTEM***\n\nSeverity\n--------\nMedium – Exploitation of the cryptographic weaknesses is possible. Disclosure of sensitive information, including login credentials, might be obtained. However, the difficulty and time required for the exploitation make other attacks more attractive.\n\nThis issue indicates a lack of adherence to NZISM:\n  * 17.2.10. SHA-1, 3DES, DH, DSA and RSA MUST NOT be used for new implementations but are approved only for current legacy systems already running these algorithms. It is important to note that the use of these older cryptographic algorithms has been deprecated in several countries including Australia and the US. \n  * 17.2.24. Using the Advanced Encryption Standard\n\nRecommendation\n--------------\nThe possible configurations for SSH will depend on the versions running on the host or device. The most modern cryptographic algorithms should be used in the configuration and all weak ones should be disabled."},{"title":"INP-X Insecure Device Failover","category":"Internal Network Pentest","contents":"INP-X Insecure Device Failover\n==============================\n\nDescription\n-----------\nLateral Security identified a host that can be accessed as a low privileged user allowing access to files with read permissions. ***The affected host(s) contain a number of sensitive documents (around X GB), some of which are related to X.***\n\nReproduction Details\n--------------------\nBrowse to the affected hosts using Windows Explorer.\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SYSTEM***\n\nSeverity\n--------\nMedium – The noted configuration does not appear to align with the principle of least privilege which dictates that a user should have access to only the resources required to accomplish their intended tasks. The current configuration allows access to sensitive files to users who have no reason to access those resources.\n\nA user who plugs in to the network would be able to access the data on this file share and  ***COMPLETE***\n\nRecommendation\n--------------\nLateral Security recommends conducting a thorough review of information sharing practices within the organisation and consider archiving information that is no longer current or required to continue day to day business operations.\nConsider appointing information owners that are responsible for managing sensitive information. These users will be responsible for logging access requests to the service desk to either grant or revoke permissions based on a user’s requirement.\n"},{"title":"INP-X IPMI v2.0 Support","category":"Internal Network Pentest","contents":"INP-X IPMI v2.0 Support\n===============================\n\nDescription\n-----------\nIPMI (Intelligent Platform Management Interface) is a protocol used to remotely monitor and manage server hardware; \nproviding access to CPU, firmware, and operating system data.\n\nThis service supports a cryptographic protocol (RAKP) which involves sending hashed versions of passwords to remote users.\nThese hashes can then be used in offline brute-force attacks to determine the original value used to create the hash.\n\n\nReproduction Details\n--------------------\nThis vulnerability was enumerated using the automated scanning tool \"nessus\", but it can also be validating using \"nmap\":\n```\nnmap -sU --script ipmi-version -p 623 {TARGET_IP}\n```\n\n\nSystems Affected\n----------------\n  * ***SITE***\n\n\n  Severity\n--------\nHigh – This vulnerability allows attackers to attempt offline brute-force attacks to determine credentials for the IPMI service.\nOnce compromised, the attacker will have the equivalent permissions as a user with physical access to the host.\n\n\nRecommendation\n--------------\n\nLateral Security recommends either disabling the service if it is not required, \nalternatively isolating it through network segmentation and separation if it fulfils a business requirement.\n\nA strong password is suggested to increase the effort required for brute-force attacks as part of a defense-in-depth security strategy.\nThis vulnerability is the result of the IPMI specification and cannot be patched out."},{"title":"INP-X Offline Password Bruteforce Through Kerberoasting","category":"Internal Network Pentest","contents":"INP-X Offline Password Bruteforce Through Kerberoasting\n=======================================================\n\nDescription\n-----------\nLateral Security performed an attack using a provided low privileged user account which takes advantage of the Kerberos authentication mechanism and how service accounts work (known as Kerberoasting). Any domain user can request service tickets (TGTs) for service accounts that have the Service Principle Name (SPN) value set. By design, Active Directory returns an encrypted ticket that uses the NTLM hash of the account that is associated to the specified SPN as an encrytion key.\n\n\n\nSystems Affected\n----------------\nThe following service principles are affected by this issue:\n  * ***List the principles and names***\n\nSeverity\n--------\nMedium – If an attacker were to compromise a user account then perform a Kerberoasting attack, they will be able to obtain an encrypted NTLM hash which can then be subjected to a brute force dictionary cracking attempt. Because the brute force attack is carried out locally by the user without further interaction with network resources, attempting to crack the encrypted ticket cannot be detected and will not cause a user’s account to become locked out.\n\nRecommendation\n--------------\nAlthough this attack allowed access to the tickets, Lateral Security was unsuccessful in cracking these captured tickets during the course of the engagement. An adversary may not be limited to time or technical constraints. Therefore, it is recommended to ensure service accounts that use Kerberos authentication with SPN values are configured with complex and long passwords.\n\nGroup managed service accounts can leverage random, complex passwords that are automatically rotated centrally in Active Directory.\n\nFor more information, see:\n  * https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and2012/hh831782(v=ws.11)?redirectedfrom=MSDN\n"},{"title":"INP-X Insecure Name Resolution","category":"Internal Network Pentest","contents":"INP-X Insecure Name Resolution\r\n==============================\r\n\r\nDescription\r\n-----------\r\nAt least one device is configured to broadcast Link-Local Multicast Name Resolution (LLMNR) packets, a multicast name resolution protocol which is used by Windows hosts. LLMNR is the successor to NBT-NS.\r\n\r\nReproduction Details\r\n--------------------\r\nUse a tool, such as Wireshark, to passively listen to all packets on the link for about a minute. To ease reading, you can filter the capture so that only LLMNR packets are shown.\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nInfo – A host configured to use LLMNR for name resolution might be vulnerable to a man-in-the-middle attack. The host will query all hosts on the network for names which it cannot resolve through other means. An attacker could wait for these queries, reply that their platform is the sought host, and then request credentials from the victim. The attack is mitigated by the requirement that the credentials must then be cracked by the attacker.\r\n\r\nRecommendation\r\n--------------\r\nLateral Security recommends that multicast name resolution be disabled in group policy on all hosts which are part of the implementation.\r\n"},{"title":"INP-X Missing Network Segmentation","category":"Internal Network Pentest","contents":"INP-X Missing Network Segmentation\n===============================\n\nDescription\n-----------\nNetwork segmentation and separation is a security control used to isolate sensitive devices from untrusted environments.\nIt is listed by CERT NZ (cert.govt.nz) as one of the \"Ten Critical Controls\" to mitigate against common attacks observed within New Zealand organisations.\n\nLateral Security identified that the organisation's network was predominately flat, allowing users to access various services including:\n* Routing Hardware\n* Firewalls\n* Server Management (IPMI / iLO)\n* Telephony Services\n* Domain Controllers\n* Web Servers\n* Mail Servers\n* File Shares\n* Printers\n* User Workstations\n\nThis allows an attacker positioned within the network to target any of these systems, moving laterally throughout the environment.\n\n\nReproduction Details\n--------------------\nScan the environment using a network enumeration tool, such as \"nmap\" or \"nessus\" to identify live hosts and exposed services.\n\n\nSystems Affected\n----------------\n  * Systemic\n\n\n  Severity\n--------\nHigh – Network segmentation is a critical security control to mitigate against infrastructure-based attacks.\nIt increases the complexity in exploiting vulnerable systems and reduces the readily available attack surface of the environment.\n\n\nRecommendation\n--------------\nLateral Security recommends segmenting networked devices by intended function, progressively implementing separation/segregation while maintaining business continuity.\nCERT-NZ provides guides for this process at:\n* https://www.cert.govt.nz/it-specialists/critical-controls/network-segmentation-and-separation/\n"},{"title":"INP-X No Port Security","category":"Internal Network Pentest","contents":"INP-X No Port Security\r\n======================\r\n\r\nDescription\r\n-----------\r\nOne shared service is secured by IP filtering. Any device or host on the network may spoof this IP from any switchport and reach that service. This is possible because port security has not been configured on the switches. Port security configures a switchport to only allow a connection from a preregistered MAC address.\r\n\r\nReproduction Details\r\n--------------------\r\nApproach one of the devices of the implementation. Use its configuration menu to find its IP address. Unplug that device from the wall jack. Plug a laptop into that same wall jack. Assign the laptop the same IP address that the printer was using.\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nLow – If any device can access the wired network that the printers are on, then it might be possible for an attacker to reach a vulnerable service.\r\n\r\nRecommendation\r\n--------------\r\nPlace the hosts and devices which should not be reached by clients on a separate, wired physical subnet or wired VLAN. Filter traffic to and from that subnet. Enable port security. Limit the maximum number of secure MAC addresses to 1. Set the restricted MAC address to that of the approved host or device. Ensure that the host or device will not display its MAC address without user authentication.\r\nMore information on port security can be found on Cisco's website.\r\n  * http://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst2960x/software/15-0_2_EX/security/configuration_guide/b_sec_152ex_2960-x_cg/b_sec_152ex_2960-x_cg_chapter_010010.html#concept_10B8CCC6EA6043CB937BF3990D686F76\r\n"},{"title":"INP-X Outdated Software and Systems","category":"Internal Network Pentest","contents":"INP-X Outdated Software and Systems\n=================================\n\nDescription\n-----------\nPatching is number one on CERT NZ's list of Critical Controls for mitigation against published/known vulnerabilities.\nDuring testing, Lateral Security identified:\n* Outdated services/daemons.\n* Outdated hardware/firmware.\n* Outdated operating systems.\n\nThese systems were correlated to versions containing published vulnerabilities, but exploitation was not attempted due to the potential impact on the hosts.\n\nIt is noted that mitigating factors (unmet attack prerequisites, configuration requirements, backported patches, etc) may limit the exploitability of these issues.\n\nReproduction Details\n--------------------\nSoftware and system versions were enumerated using various fingerprinting methods, these included:\n* Automated scanning.\n* Application banners.\n* Web-based disclosures (headers, content, comments).\n\nThis identified:\n* ***LIST VULNS***\n\nAdditional outdated systems may also be present within the environment and internal investigation is suggested for completeness of findings.\n\n\nSystems Affected\n----------------\nThe following hosts are affected by this issue:\n  * ***SITE***\n\nSeverity\n--------\nHigh – Patching is number one on CERT NZ's Critical Controls, as compromise through outdated technologies is a major cause of security incidents.\nThe identified versions contain published vulnerabilities, potentially leading to:\n* ***Example Impacts***\n\nA lack of patching processes is likely to result in other systems remaining vulnerable if future security exploits are identified.\n\n\nRecommendation\n--------------\n\nLateral Security recommends updating the identified systems to the latest available versions.\nIf no patch is available, consider disabling the service or isolating (network segmentation) the host.\n\nInternal version auditing should be conducted, leveraging administrative access to gain greater visibility of product versions.\n\nA patching policy and process should be established to ensure systems continue to be maintained. Guidance for these processes can be found at:\n* https://www.cert.govt.nz/it-specialists/critical-controls/patching/\n"},{"title":"INP-X Remote Code Execution Vulnerability","category":"Internal Network Pentest","contents":"INP-X Remote Code Execution Vulnerability\r\n=========================================\r\n\r\nDescription\r\n-----------\r\nA network scan indicated that hosts are vulnerable to CVE-1993-0900, a remote code execution vulnerability in Usenet. A remote code execution gives an attacker the ability to run a program, regardless of where the machine is located.\r\n  * https://www.cvedetails.com/cve/CVE-1993-0900\r\n\r\nReproduction Details\r\n--------------------\r\nUse a tool, such as Nessus, to scan the network for vulnerabilities. The report will indicate that some hosts are vulnerable to CVE-1993-0900.\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nHigh – An attacker could use this vulnerability to exploit a host, remotely. Any client user on the network or able to gain access to the network might be able to exploit this vulnerability.\r\n\r\nThis issue indicates a lack of adherence to NZISM:\r\n  * 12.4.3. Vulnerabilities and patch availability awareness\r\n  * 12.4.4. Patching vulnerabilities in products\r\n\r\nRecommendation\r\n--------------\r\nA patch has been provided by Usenet to correct this. Ensure that all hosts are patched and that a patching policy which mandates regular patching exists for the solution.\r\n"},{"title":"INP-X SMBv1.0 Supported","category":"Internal Network Pentest","contents":"INP-X SMBv1.0 Supported\n===============================\n\nDescription\n-----------\nServer Message Block (SMB) is a network protocol used primarily to access shared files and printers. \nModern versions of this protocol have no known vulnerabilities when configured in line with good practice, however ***Organisation's*** configuration deviates from this configuration by supporting SMBv1.0.\n\n\nReproduction Details\n--------------------\nDetermine whether a particular host exposes SMBv1 using the nmap script below:\n```\nnmap --script smb-protocols -p 139,445 <host>\n```\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SYSTEM***\n\nSeverity\n--------\nCritical – Support for SMBv1 was a key factor in vulnerability to the ETERNALBLUE exploit and the WannaCry ransomware. While Microsoft released patches for those specific vulnerabilities, the deprecated SMBv1 protocol is considered to be insecure.\nIt is likely that future vulnerabilities in this protocol version will be identified, resulting in arbitrary access to shared files or even remote code execution. Further to this, SMBv1 does not support key security controls which are present in later versions and considered to be requirements in a modern environment. \nFor more information, see the following URL:\n*\thttps://blogs.technet.microsoft.com/filecab/2016/09/16/stop-using-smb1/\n\n\nRecommendation\n--------------\nDisable support for SMBv1. \nFor instructions, see the following URL:\n*\thttps://blogs.technet.microsoft.com/filecab/2016/09/16/stop-using-smb1/\nIt is also recommended that message signing be enabled and required. \nIf continuing to support SMBv1 is required due to environmental limitations, ensure that the impact of this requirement is well understood. Develop a migration plan for reducing the presence of this vulnerable protocol in the environment. \n\n\n\n"},{"title":"INP-X Server Message Block (SMB) Signing Disabled","category":"Internal Network Pentest","contents":"INP-X Server Message Block (SMB) Signing Disabled\n=================================================\n\nDescription\n-----------\nLateral Security identified hosts with Server Message Block (SMB) enabled on the network which do not require SMB Signing. SMB Signing is a feature that can be used to digitally sign packets before transmission. Digitally signing the packets enables the recipient of the packets to confirm their point of origination and their authenticity.\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SYSTEM***\n\nSeverity\n--------\nMedium – In the event an attacker had physical access to the same local network as target hosts, they could carry out an SMB relay attack in order to gain authenticated access to hosts on the network. The attack works by sniffing the network for SMB authentication packets and then replaying them to target hosts where signing is not required. A successful attack would grant an attacker access to the target hosts with the same privilge as the legitimate client. This could be used to gain access to sensitive data or move laterally throughout a network.\n\nRecommendation\n--------------\nLateral Security recommends enforcing message signing in the host's configuration as both an SMB client and server. In Group Policy Management, this can be achieved either through Server Manager > Tools > Group Policy Management, or by running ‘gpmc.msc’ in PowerShell or the Command Prompt. \nWithin the policy navigate to Computer Configuration > Policies > Windows Settings > Security Settings > Local Policies > Security Options.\n"},{"title":"INP-X Unrestricted Outbound Traffic","category":"Internal Network Pentest","contents":"INP-X Unrestricted Outbound Traffic\r\n===================================\r\n\r\nDescription\r\n-----------\r\nTraffic going from the internal network to the Internet is not restricted by firewall and web proxy. A firewall can be configured to filter traffic to external hosts and ports which are not required by the organisation devices, or to force those devices to access outside web services through a proxy. A proxy can be configured which will enable web traffic to be inspected and controlled at the application layer.\r\n\r\nReproduction Details\r\n--------------------\r\nUse a program, such as curl, to connect to an external website. The command will return the contents of the website.\r\n\r\n    curl --no-proxy http://www.webcrawler.com/\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nMedium – Sensitive organisational information might be leaked and misuse of organisational resources might occur. It also remains difficult to prevent users from connecting to unsanctioned sites and services.\r\n\r\nThis issue indicates a lack of adherence to NZISM:\r\n  * 7.1.4. Preventing and detecting information security incidents\r\n  * 14.1.6. Developing hardened SOEs\r\n  * 14.3.6. Web proxy\r\n  * 14.2.12. Web content filter\r\n\r\nRecommendation\r\n--------------\r\nConfigure the firewall to filter all outbound traffic from the internal network. Install a web proxy which will inspect and restrict access to external web resources based on organisational policies. Configure all client devices to use this web proxy to access external websites."},{"title":"INP-X Unrestricted Zone Transfer","category":"Internal Network Pentest","contents":"INP-X Unrestricted Zone Transfer\n================================\n\nDescription\n-----------\nDomain controllers of the following domains allow unrestricted DNS zone transfer:\n  * XYZ\n  * XYZ\n\nA zone transfer is used to copy the contents of the zone file from one DNS server to another DNS server, exposing information about the domains the DNS server is managing. Access to this information should be restricted to other DNS servers which are legitimately expected to request the information.\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SYSTEM***\n\nSeverity\n--------\nLow – A zone transfer enables an attacker to instantly populate a list of potential targets. In addition, companies often use a naming convention that can give hints as to a primary application (for instance, proxy.example.com, payroll.example.com, swift1.example.com, etc.).\n***Note that the vulnerable domain controllers are not on the primary domain \"XYZ\" and do not contain useful additional information to attackers. Therefore, this issue has been assigned a severity rating of Low.***\n\nRecommendation\n--------------\nLateral Security recommend that DNS zone transfer be limited to only servers that need this information.\n"},{"title":"INP-X Weak Passwords in Use","category":"Internal Network Pentest","contents":"INP-X Weak Passwords in Use\n===========================\n\nDescription\n-----------\nLateral Security identified multiple weak passwords in use on domain accounts in the internal environment.\nAlthough these passwords meet the minimum requirements of the current password settings, they are still considered insufficiently strong and are likely to be guessed by an attacker. If guessed, an attacker would be granted domain level user access.\n\nReproduction Details\n--------------------\nTo reproduce this issue:\n  * ***XYZ***\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SYSTEM***\n\nSeverity\n--------\nCritical – These passwords were discovered after breaching the domain admin account and downloading the NTDS database where Windows credentials are saved in an encrypted format for Active Directory Domains. These encrypted credentials were subjected to a dictionary-based attack that leverages passwords from publicly disclosed data breaches. ***200*** accounts in total were compromised as a result of this effort.\n\nMany of the passwords breached consisted of commonly known passwords such as “Password123, Welcome123, Tuesday17 etc”.\nWhile it is likely that a brute-force attack conducted on the network would result in account lockout or a similar control being triggered, tools demonstrated during testing allowed the obtained credentials to be compromised offline by means of a dictionary-based attack without triggering lockout of accounts.\n\nOnce credentials are revealed an attacker can return to make a login attempt or target internet facing services such as mail servers and VPN connections.\n\nRecommendation\n--------------\nLateral Security recommend that DNS zone transfer be limited to only servers that need this information.\n"},{"title":"LHR-X Disabled SELinux","category":"Linux Host Review","contents":"LHR-X Disabled SELinux\n======================\n\nDescription\n-----------\n*** if it is permissive, change this description and the title above ***\n\nSecurity-enhanced Linux (SELinux) is not enabled. SELinux provides additional security to a system by restricting the system resources that each system process may use. These restrictions can prevent specific classes of attacks. A well-configured SELinux may halt some privilege escalation exploits.\n\nBecause SELinux is disabled, the system defaults to a \"permissive\" state.\n\nReproduction Details\n--------------------\nTo verify that SELinux is not enabled, issue the following command:\n\n    getenforce\n\nThe following excerpt is from the SELinux configuration file:\n\n    *** SELINUX=disabled ***\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SYSTEM***\n\nSeverity\n--------\nMedium – This configuration does not follow the information assurance concept of defence in depth. A disabled SELinux may leave the system vulnerable to mitigable exploits found in other software.\n\nThis finding indicates a lack of adherence to NZISM 14.2.4.\n\nRecommendation\n--------------\nSELinux defines access controls for the applications, processes, and files on a system. It uses security policies, which are a set of rules that tell SELinux what can or cannot be accessed. A policy must be created for each process. The vendor should provide these policies, when possible. For further information on SELinux and its implementation, please refer to the official, operating system vendor manual.\n"},{"title":"LHR-X Infrequent Operating System Patching","category":"Linux Host Review","contents":"LHR-X Infrequent Operating System Patching\n==========================================\n\nDescription\n-----------\nThe system operating system receives patches from the vendor infrequently. Patching is one of the critical controls published by CERT NZ and part of the Essential Eight mitigations published by the Australian Signals Directorate to help prevent compromise. Below are samples from each reviewed system, which show the most recently applied patch and patch date.\n\n*** Update this ***\n\nSYSTEM\n\\[package\\] \\[date\\]\n\nReproduction Details\n--------------------\nTo reproduce this issue, issue the following command.\n\nDEBIAN\tegrep '( install | upgrade )' /var/log/dpkg.log\nRED HAT\trpm -qa --last\n\n***At least four critical security advisories have been published since these systems have received updates.***\nhttps://access.redhat.com/errata/#/?q=&p=1&sort=portal_publication_date%20desc&rows=10&documentKind=PortalProduct&portal_severity=Critical&portal_advisory_type=Security%20Advisory\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SYSTEM***\n\nSeverity\n--------\nHigh – ***The likelihood is high that the reviewed systems are affected by at least four vulnerabilities, which the vendor has raised as critical.*** Were an attacker to successfully exploit an unpatched system, the system could be compromised. The system could then be used as a platform to launch other attacks within the environment.\n\nThis does not comply with NZISM 12.4.\n\nRecommendation\n--------------\nEnsure that the systems are patched and that a patching policy clearly delegates patch release monitoring and patch application responsibility. All critical vulnerabilities should be patched within 48 hours of their publication. Perform regular audits of these processes.\n"},{"title":"LHR-X Infrequent Third-party Software Patching","category":"Linux Host Review","contents":"LHR-X Infrequent Third-party Software Patching\n==============================================\n\nDescription\n-----------\nThe system third-party software is infrequently patched. The version of VMware Tools installed on all reviewed systems indicates that the underlying virtual machine host is running a version of VMware ESXi with known vulnerabilities.\n\n*** Update these ***\n\ncpe:/a:vmware:tools:10.1.5 was released 23 Feb 2017.\n  * https://docs.vmware.com/en/VMware-Tools/10.1/rn/vmware-tools-1015-release-notes.html\n\nThe newest version is cpe:/a:vmware:tools:10.2.0, released 14 Dec 2017.\n  * https://docs.vmware.com/en/VMware-Tools/10.2/rn/vmware-tools-1020-release-notes.html\n\ncpe:/a:vmware:tools:10.1.5 indicates cpe:/o:vmware:esxi:6.0\n  * https://packages.vmware.com/tools/versions\n\ncpe:/o:vmware:esxi:6.0 has the following known vulnerabilities.\n  * CVE-2017-4941\tExec Code Overflow\n  * CVE-2017-4940\tXSS\n  * CVE-2017-4933\tExec Code Overflow\n  * CVE-2017-4925\n  * CVE-2017-4905\t+Info\n  * CVE-2017-4904\tDoS Exec Code Overflow\n  * CVE-2017-4903\tExec Code Overflow\n  * CVE-2016-7463\tXSS\n  * CVE-2016-5331\tHttp R.Spl.\n  * CVE-2016-5330\t+Priv\n  * CVE-2015-6933\n  * https://www.cvedetails.com/vulnerability-list/vendor_id-252/product_id-22134/version_id-188904/Vmware-Esxi-6.0.html\n\nReproduction Details\n--------------------\nTo see that the third-party software is infrequently patched, issue the following command.\n*** Update this***\nvmware-toolbox-cmd -v\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SYSTEM***\n\nSeverity\n--------\nHigh – ***The reviewed systems might be vulnerable to remote code execution and privilege escalation.*** Were an attacker to successfully exploit an unpatched system, the system could be compromised. This could lead to a compromise of the underlying infrastructure and the system environment.\n\nThis does not comply with NZISM 12.4.\n\nRecommendation\n--------------\nEnsure that the systems are patched and that a patching policy clearly delegates patch release monitoring and patch application responsibility. All critical vulnerabilities should be patched within 48 hours of their publication. Perform regular audits of these processes.\n"},{"title":"LHR-X Insecure File System Partitioning","category":"Linux Host Review","contents":"LHR-X Insecure File System Partitioning\n=======================================\n\nDescription\n-----------\n\n*** Update these as appropriate ***\n\nFile system partitioning allows an operating system to control information on different parts of the file system with different options and resources.\n  * The current partitioning configuration cannot mitigate file system resource exhaustion, which occurs when a user or process writes to a file or files until no free space remains for other users or processes.\n  * The current partitioning configuration will not allow some parts of the file system to be mounted with different mount options.\n  * The current partitioning configuration will not prevent hard link attacks.\n\nThe partitioning scheme will not prevent hard link attacks. Hard links are equivalent to file names. At least two types of hard link attacks exist. One involves bypassing quota restrictions by filling a world writable directory with hard links. The other attacks take advantage of POSIX file systems, which allow files to be referenced by more than one hard link on the same partition. An example attack proceeds like this:\n  1. A hard link is made to pieces of system software which an attacker believes might be exploitable in the future\n  2. A vulnerability is discovered in one of those pieces of software\n  3. The system administrator attempts to remove the vulnerable software by deleting the file name\n  4. The file name is removed, but the vulnerable file is still referenced by another file name (hard link) on the same partition\n  5. The attacker exploits the software through the remaining hard link\n\nSeveral published attacks depend on hard links.\n  * http://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=hardlink\n\nReproduction Details\n--------------------\nTo view the file system mount configuration and the file system mount options, use the following command.\n\n    cat /etc/fstab\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SYSTEM***\n\nSeverity\n--------\nLow – The current partition layout is not exploitable unless unprivileged users can log in, an unprivileged process malfunctions, or an unprivileged process is manipulated to write to user writable file systems through remote exploitation. Under these circumstances, the current partition layout would not prevent file system resource exhaustion, which would deny critical operating system services the ability to write, and it would not mitigate hard link attacks.\n\nSome settings; such as nodev, nosuid, and noexec; cannot be configured for parts of the file system which should not allow device files, suid files, and executables.\n\nRecommendation\n--------------\n*** Update these as appropriate ***\nDirectories which are writable by an unprivileged user should be mounted separately and with mount options that meet good practices. These partitions should be mounted on separate block devices with these settings.\n  * /tmp should be mounted nodev, nosuid, noexec\n  * /var\n  * /var/log\n  * /var/log/audit\n  * /home should be mounted nodev\n\nThe /var/tmp file system should not reside on a separate block device. Instead:\n  * /var/tmp should be bind mounted to /tmp\n\nThe tmpfs file systems should be mounted defaults,nodev,nosuid,noexec.\n"},{"title":"LHR-X Insecure File System Permissions","category":"Linux Host Review","contents":"LHR-X Insecure File System Permissions\n======================================\n\nDescription\n-----------\nSome file system locations have insecure settings. File system ownership and permission settings help prevent system exploitation by keeping attacker from altering or executing sensitive files, or exhausting system resources.\n\nThe sticky bit, when set on world-writable directories, prevents users from renaming or deleting files that they do not own. The following world-writable directories do not have this bit set:\n\n***include file list***\n\nCertain locations, which are not usually world-writable, are world-writable:\n\n***include file list***\n\nCertain locations have no owner:\n\n***include file list***\n\nReproduction Details\n--------------------\nTo see that some directories are world-writable without the sticky bit, issue the following command:\n```\nfind / -xdev -perm -o+w -type d -exec /bin/ls -ld {} \\;\n```\nTo see that some files are world-writable, issue the following command:\n```\nfind / -xdev -perm -o+w -type f -exec /bin/ls -ld {} \\;\n```\nTo see that some locations are unowned, issue the following command:\n```\nfind / -xdev \\( -nouser -o -nogroup \\) -print;\n```\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SYSTEM***\n\nSeverity\n--------\nLow – These settings could be used by an attacker to cause a denial of service or some unpredictable behaviour on the systems. This could occur if the attacker were to rename an important file or delete it, or continuously write to a writable file on a sensitive partition.\n\nIf a new user were assigned the same uidNumber as the unowned paths, then the new user will own those paths.\n\nRecommendation\n--------------\nEnsure that the directories enumerated in the description have the sticky bit set. This can be done with the following command:\n```\nchmod a+t <path>\n```\nConsider changing the permissions of world-writable locations, and assign ownership to unowned files. If no regular user should own them, then assign them to root.\n"},{"title":"LHR-X Insecure Passwords","category":"Linux Host Review","contents":"LHR-X Insecure Passwords\n========================\n\nDescription\n-----------\nPasswords were found in miscellaneous files and in the running configuration of certain processes, ***some of these passwords appear to be default passwords that have not been changed.***\n\nReproduction Details\n--------------------\n***To see that the running configuration of some Java processes contains passwords, issue the following command:***\n\n    ps auxwww | grep -i password\n\nTo see that some files contain passwords, issue the following command:\n\n    find / -xdev -name \"*.xml\" -print0 | xargs -0 grep -i -n \"password\"\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SYSTEM***\n\nSeverity\n--------\nHigh – It is unclear what access could be gained with these passwords in the applications that they seem to be configured for. However, privilege escalation might be achieved through the use of these passwords which might otherwise not be possible - especially in the processes which are running as root. These passwords might be reused elsewhere on the system or on other systems. Therefore, successful exploitation might lead to the compromise of the environment.\n\nThe existence of default passwords does not comply with NZISM v2.3 14.1.8.\n\nRecommendation\n--------------\nLateral Security recommends that these configurations be reviewed by staff to determine what is necessary to keep. It might be possible to configure the processes from a file which is unreadable by unprivileged users. Most of the files containing passwords are in the /tmp directory and are probably unneeded. Consider these for purging.\n"},{"title":"LHR-X Insecure SSH Configuration","category":"Linux Host Review","contents":"LHR-X Insecure SSH Configuration\n================================\n\nDescription\n-----------\nThe SSH server has the following insecure settings.\n  * Protocol tells the daemon which versions of the SSH protocol should be accepted. SSHv1 is insecure.\n  * PermitEmptyPasswords tells the daemon whether empty password should be accepted.\n  * PermitRootLogin tells the daemon whether to allow root to log in.\n\n  * X11Forwarding allows X11 traffic through the connection and is enabled.\n  * MaxAuthTries specifies that maximum number of authentication attempts permitted per connection, but is not set.\n  * Ciphers limits the types of ciphers that the SSH server will accept, but is not set.\n  * ClientAliveInterval specifies the length of time that no activity is allowed before a session is terminated, but is not set.\n  * ClientAliveCountMax tells the SSH server to send client alive messages at the time specified in ClientAliveInterval, but is not set.\n  * Banner specifies a file whose contents will be sent to the user before authentication, but is not set.\n\nReproduction Details\n--------------------\nTo check for these settings, issue the following command and look for the underlined words in the description.\n/usr/sbin/sshd -T\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SYSTEM***\n\nSeverity\n--------\n\nMedium – These settings do not follow good practice. The ciphers accepted will prevent SSH from forcing clients to connect with a well secured transport. Other settings weaken the behaviour of the daemon.\n\nThis finding indicates a lack of adherence to NZISM 17.2, Approved Cryptographic Algorithms.\n\nRecommendation\n--------------\nLateral Security recommends that the SSH daemon have the following in /etc/sshd_config.\n\n    Protocol 2\n    PermitEmptyPasswords no\n    PermitRootLogin no\n    X11Forwarding no\n    MaxAuthTries 4\n    Ciphers aes256-gcm@openssh.com,aes128-gcm@openssh.com\n    KexAlgorithms curve25519-sha256@libssh.org\n    MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256\n    ClientAliveInterval 300\n    ClientAliveCountMax 0\n\nBanner should be set to a file which contains an appropriate warning banner. This should be approved by the legal department. Lateral Security would recommend that chacha20-poly1305@openssh.com be given preference among ciphers, but it is not one of the approved algorithms in NZISM 17.2.\n"},{"title":"LHR-X Insufficient Account Constraints","category":"Linux Host Review","contents":"LHR-X Insufficient Account Constraints\n======================================\n\nDescription\n-----------\nSeveral account configuration settings do not meet good practice:\n***Update these as appropriate***\n* Accounts are configured to create world readable files, by default.\n* Password reuse is allowed.\n* Passwords do not expire.\n* The use of su is not sufficiently restricted.\n\nReproduction Details\n--------------------\n***Update these as appropriate***\nTo verify that accounts create writable files, by default, issue the following commands. This returned nothing. The umask command returned \"0002\".\n```\negrep '^umask' /etc/bash*\negrep '^umask' /etc/profile*\n```\nTo verify that the system is not remembering already used passwords nor restricting how often they can be changed, issue the following commands.\n```\ngrep remember /etc/pam.d/*\ngrep PASS_MIN_DAYS /etc/login.defs\n```\nTo verify that passwords do not expire, issue the following command. This returned \"99999\".\n```\ngrep PASS_MAX_DAYS /etc/login.defs\n```\nTo verify that the use of su is not sufficiently restricted, issue the following command. This returned comment lines.\n```\ngrep wheel /etc/pam.d/su\n```\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SYSTEM***\n\nSeverity\n--------\nMedium – This configuration does not follow the information assurance concept of defence in depth.\n\nThis finding indicates a lack of adherence to 16.1.23.\n\nRecommendation\n--------------\nLateral Security recommends that the following steps be taken to correct the configuration.\n***Update these as appropriate***\n* Set a more secure default umask of 077 or 027 in the bash configuration and /etc/profile.\n* Make sure that password reuse is prevented by setting a \"remember=5\" directive in the PAM authentication configuration.\n* Ensure that PASS_MIN_DAYS is set to 7 in login.defs, so that password cannot be changed in rapid succession to bypass the remember setting.\n* Set password expiry to 90 days in login.defs.\n* Restrict the use of su to users in the wheel group by uncommenting one of the two lines in \"/etc/pam.d/su\".\n"},{"title":"LHR-X Insufficient System Auditing","category":"Linux Host Review","contents":"LHR-X Insufficient System Auditing\n==================================\n\nDescription\n-----------\n\nThe reviewed host was not logging to a central log host. A central log host provides a facility for duplicate logging off-host, thereby increasing defence-in-depth and easing auditing.\n\nThe auditd installation was not configured according to the recommendation of well-known security benchmarks. The auditd package is a part of the Linux audit framework and it is the logging facility for this framework and SELinux. The configuration will not keep logs.\n\nThe aide package was not installed. The aide package allows files and directories to be audited for changes. It does this using message digest algorithm checksumming.\n\nReproduction Details\n--------------------\nTo verify that logging is not being duplicated to a central log server, issue the following command. ***The matching lines were commented out and no logs were sent to a log host.***\n```\negrep '^*.*[^I][^I]*@' /etc/rsyslog.conf\n```\nTo verify that the auditd configuration is not following good practices, perform these steps:\nIssue the following command to determine whether logs from auditd are configured to be kept. ***This was set to \"ROTATE\", which will purge oldest logs after num_logs has been reached.***\n```\ngrep max_log_file_action /etc/audit/auditd.conf\n```\nReview the grub configuration to determine whether auditing is occurring during boot before the auditd daemon has had time to start. An audit directive would be present in the kernel command line. This directive was not present in the conifguration.\n\nView the auditd configuration configuration in /etc/audit. The files did not contain the recommendations of well-known security benchmarks. A compilation of these settings has been included in **Appendix B - audit.rules**.\n```\nview /etc/audit/audit.rules\n```\nTo verify that aide is installed on the host, issue the following command. During review, aide was not installed.\n```\nrpm -q aide\n```\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SYSTEM***\n\nSeverity\n--------\nMedium – Were a host to become compromised, any logs which might point to the compromise or how the compromise occurred could be erased or otherwise tampered with to prevent proper audit. It also indicates that hosts might not be monitored, since hosts would have to be monitored individually, which is unlikely.\n\nBecause auditd is not configured correctly, some informative, loggable system call information will not be recorded to a logging facility.\n\nThe aide package shows modification to files on the file system, and the lack of this tool means that should an attacker gain access to the host, certain changes may go unnoticed.\n\nInsufficient host auditing does not follow best practices and means that the source of compromise of a host could be more difficult to determine.\n\nThis finding indicates a lack of adherence to NZISM 14.1 and NZISM 16.5.\n\nRecommendation\n--------------\nLateral Security recommends that all logging be duplicated to a central log host over a TLS encrypted transport. Instructions on how to set this up can be found at the link below:\n  * http://www.rsyslog.com/doc/v8-stable/tutorials/tls_cert_summary.html\n\nSet max_log_file_action to \"keep_logs\". Ensure that auditing will occur during boot before auditd is started by setting the \"audit=1\" directive in the grub kernel command line. Set the auditd configuration to that recommended in a well-known security benchmark, such as those provided by the STIG or Center for Information Security and install the aide package and initialise its database.\n\nA good auditing configuration should attempt to answer several questions:\n* What are desired parameters for a given environment?\n* What changes have been made to these desired parameters?\n* Who made the changes?\n* Can the record of these changes be proven authentic?\n\nAudit logs should be automatic, accurate, up-to-date, unalterable, and relevant to policy compliance. They should not be so copius as to be unusable.\n\nSee the contents of **Appendix B**.\n\nAppendix B - audit.rules\n========================\n\nThe following command will produce output specific to the system that it is run on. This output will be rule, which should be added to \"/etc/audit/audit.rules\".\n```\nfind <partition> -xdev \\( -perm -4000 -o -perm -2000 \\) - type f | awk '{print \" -a always,exit -F path=\"$1\" -F perm=x -F auid>=500 -F auid!=4294967295 -k privileged\"}'\n```\nThe following rules should also be added to \"/etc/audit/audit.rules\".\n```\n# RECORD EVENTS THAT MODIFY DATE OR TIME\n-a always,exit -F arch=b64 -S adjtimex -S settimeofday -k time-change\n-a always,exit -F arch=b32 -S adjtimex -S settimeofday -S stime -k time-change\n-a always,exit -F arch=b64 -S clock_settime -k time-change\n-a always,exit -F arch=b32 -S clock_settime -k time-change\n-w /etc/localtime -p wa -k time-change\n\n# RECORD EVENTS THAT MODIFY USERS OR GROUPS\n-w /etc/group -p wa -k identity\n-w /etc/passwd -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/security/opasswd -p wa -k identity\n\n# RECORD EVENTS THAT MODIFY NETWORK CONFIGURATION\n-a always,exit -F arch=b64 -S sethostname -S setdomainname -k system-locale\n-a always,exit -F arch=b32 -S sethostname -S setdomainname -k system-locale\n-w /etc/issue -p wa -k system-locale\n-w /etc/issue.net -p wa -k system-locale\n-w /etc/hosts -p wa -k system-locale\n-w /etc/sysconfig/network -p wa -k system-locale\n\n# RECORD EVENTS THAT MODIFY THE SYSTEMS MANDATORY ACCESS CONTROLS\n-w /etc/selinux/ -p wa -k MAC-policy\n\n# RECORD LOGIN AND LOGOUT EVENTS\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/log/tallylog -p wa -k logins\n\n# RECORD SESSION INITIATION EVENTS\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n\n# RECORD DISCRETIONARY ACCESS CONTROL PERMISSION MODIFICATION EVENTS\n-a always,exit -F arch=b64 -S chmod -S fchmod -S fchmodat \\\n-F auid>=500 -F auid!=4294967295 -k perm_mod\n-a always,exit -F arch=b32 -S chmod -S fchmod -S fchmodat \\\n-F auid>=500 -F auid!=4294967295 -k perm_mod\n-a always,exit -F arch=b64 -S chown -S fchown -S fchownat -S lchown \\\n-F auid>=500 -F auid!=4294967295 -k perm_mod\n-a always,exit -F arch=b32 -S chown -S fchown -S fchownat -S lchown \\\n-F auid>=500 -F auid!=4294967295 -k perm_mod\n-a always,exit -F arch=b64 -S setxattr -S lsetxattr -S fsetxattr \\\n-S removexattr -S lremovexattr -S fremovexattr -F auid>=500 \\\n-F auid!=4294967295 -k perm_mod\n-a always,exit -F arch=b32 -S setxattr -S lsetxattr -S fsetxattr \\\n-S removexattr -S lremovexattr -S fremovexattr -F auid>=500 \\\n-F auid!=4294967295 -k perm_mod\n\n# RECORD UNSUCCESSFUL, UNAUTHORISED FILE ACCESS\n-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate \\\n-S ftruncate -F exit=-EACCES -F auid>=500 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S creat -S open -S openat -S truncate \\\n-S ftruncate -F exit=-EACCES -F auid>=500 -F auid!=4294967295 -k access\n-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate \\\n-S ftruncate -F exit=-EPERM -F auid>=500 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S creat -S open -S openat -S truncate \\\n-S ftruncate -F exit=-EPERM -F auid>=500 -F auid!=4294967295 -k access\n\n# RECORD SUCCESSFUL FILE SYSTEM MOUNTS\n-a always,exit -F arch=b64 -S mount -F auid>=500 -F auid!=4294967295 -k mounts\n-a always,exit -F arch=b32 -S mount -F auid>=500 -F auid!=4294967295 -k mounts\n\n# RECORD USER FILE DELETION EVENTS\n-a always,exit -F arch=b64 -S unlink -S unlinkat -S rename -S renameat \\\n-F auid>=500 -F auid!=4294967295 -k delete\n-a always,exit -F arch=b32 -S unlink -S unlinkat -S rename -S renameat \\\n-F auid>=500 -F auid!=4294967295 -k delete\n\n# RECORD SYSTEM ADMINISTRATOR SCOPE CHANGES\n-w /etc/sudoers -p wa -k scope\n\n# RECORD SYSTEM ADMINISTRATOR ACTIONS\n-w /var/log/sudo.log -p wa -k actions\n\n# RECORD KERNEL MODULE LOADING AND UNLOADING\n-w /sbin/insmod -p x -k modules\n-w /sbin/rmmod -p x -k modules\n-w /sbin/modprobe -p x -k modules\n-a always,exit -F arch=b64 -S init_module -S delete_module -k modules\n\n# MAKE THE AUDIT CONFIGURATION IMMUTABLE\n-e 2\n```\n"},{"title":"LHR-X Job Scheduling Information Disclosure","category":"Linux Host Review","contents":"LHR-X Job Scheduling Information Disclosure\n===========================================\n\nDescription\n-----------\nThe current permissions and configurations of the job schedulers are not optimised for security. The job schedulers, cron and at, are responsible for running processes at specified times in the future. As a result, their configurations must contain information about future executions on a system.\n\n***In particular:***\n  * Any user can schedule jobs.\n  * Scheduled jobs are viewable by all users.\n\nReproduction Details\n--------------------\n*** Update Theses ***\nTo verify the permissions of the cron configuration, issue the commands below. These files were viewable to all users. The file, cron.allow, is missing and cron will allow all users to schedule without it.\n\n    ls -l /etc/cron*\n\nTo verify the permissions of the files responsible for the at daemon configuration, issue the following commands. The file, at.allow, is missing and cron will allow all users to schedule without it.\n\n    ls -l /etc/at.*\n\nThe crontab for root included scripts which are world-readable. As root, issue the following command to see the root crontab.\n\n    crontab -l\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SYSTEM***\n\nSeverity\n--------\n*** Update this ***\nLow/High – This configuration discloses information about the systems. One way in which this information might be exploited would be that an attacker reads the configuration and learns which executables will be run. The attacker, then, modifies the executable file to elevate privilege. This attack depends on the scheduled file being writable through some means.\n\nThe scripts in the root crontab are owned and writable by the tomcat2 user, which runs a TCP/IP listening, application service. If this service were compromised in some way, then an attacker might be able to cause the service to alter the scripts executed by cron. This would allow arbitrary code execution and privilege escalation to root.\n\nRecommendation\n--------------\nLateral Security recommends that cron and at be set to default deny. All cron configuration files should be readable and writable only by root. The following commands will set the configuration as recommended:\n\n    rm /etc/at.deny\n    rm /etc/cron.deny\n    touch /etc/at.allow\n    touch /etc/cron.allow\n    chown root:root /etc/at.allow\n    chown root:root /etc/cron.allow\n    chmod og-rwx /etc/at.allow\n    chmod og-rwx /etc/cron*\n\nEnsure that any files executed by the root crontab or controlling execution of the root crontab, either directly or subsequently, are only writable by root.\n"},{"title":"LHR-X Insecure Debugging","category":"Linux Host Review","contents":"LHR-X Insecure Debugging\n========================\n\nDescription\n-----------\nA debugging feature of the operating system kernel, core dumps, is enabled. A core dump file contains the memory contents of an executable program at the time the dump was created. The contents of a file could contain sensitive information, such as credentials and passwords, and might not be limited to the information of the user if the program is setuid.\n\nReproduction Details\n--------------------\nTo see that memory dumps are enabled, issue the following command.\n```\nsysctl fs.suid_dumpable \n```\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SYSTEM***\n\nSeverity\n--------\nLow – If an attacker were able to cause a program containing senstive information in its memory to dump its contents to a\nfile, then that attacker might be able to use the sensitive information to escalate privilege.\n\nRecommendation\n--------------\nEnsure that the /etc/security/limits.conf has the following directive.\n```\n* hard core 0\n```\nThe system control file, /etc/sysctl.conf, should have the following directive.\n```\nfs.suid_dumpable = 0\n```\nAdd this to a running configuration with the following command.\n```\nsysctl -w fs.suid_dumpable=0\n```\n"},{"title":"LHR-X No Host Firewall","category":"Linux Host Review","contents":"LHR-X No Host Firewall\n======================\n\nDescription\n-----------\nNo host firewall was found to be configured and active. The default firewall in modern Linux installations is configured through the use of iptables, which reports that input, output, and forwarding of packets are all default allow.\n```\nChain INPUT (policy ACCEPT)\ntarget     prot opt source               destination\n\nChain FORWARD (policy ACCEPT)\ntarget     prot opt source               destination\n\nChain OUTPUT (policy ACCEPT)\ntarget     prot opt source               destination\n```\nReproduction Details\n--------------------\nTo verify that no firewall has been configured, issue the following commands:\n```\niptables -L\nip6tables -L\n```\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SYSTEM***\n\nSeverity\n--------\nLow – The lack of a firewall might leave services vulnerable to denial of service or remote code execution. ***This issue is mitigated by the firewall device of the network.***\n\nRecommendation\n--------------\nLateral Security recommends that a host firewall be configured to be default deny with only needed services allowed. If IPv6 is not required, disabled it through the use of ip6tables. The firewall should, then, be enabled on the host.\n"},{"title":"LHR-X Unencrypted Data at Rest","category":"Linux Host Review","contents":"LHR-X Unencrypted Data at Rest\n==============================\n\nDescription\n-----------\nFull disk encryption is not enabled. Data is unsecured at rest. Data at rest is stored data, usually a hard drive or another block device. This form of data contrasts with data in transit, such as through a network, and data in use, such as through a central processing unit.\nSeveral solutions can provide storage encryption on Linux. The following are some of the most common.\n  * Loop-AES\n  * dm-crypt +/- LUKS\n  * TrueCrypt\n  * VeraCrypt\n  * eCryptfs\n  * EncFs\n\nReproduction Details\n--------------------\nTo see that storage encryption has not been deployed, issue the following command, which indicates that all file systems are backed by regular block devices.\n```\nlsblk -a -i\n```\nThe following command output indicates that no common solution is running on the systems\n```\nps -ef\n```\nThe following command output indicates that dmcrypt has not been configured.\n```\ncat /etc/crypttab\n```\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SYSTEM***\n\nSeverity\n--------\nLow – Securing data at rest helps prevent the loss of sensitive data after the physical hardware has been disposed of due to end of life or failure. If hardware, which contains sensitive data is released to the public, the data could be used to harm the reputation of the organisation.\n\nRecommendation\n--------------\nEnsure that sensitive data is encrypted at rest. This should be performed as a preliminary to and in tandem with actions governed by media destruction policy.\n"},{"title":"LHR-X Unhardened Network Configuration","category":"Linux Host Review","contents":"LHR-X Unhardened Network Configuration\r\n======================================\r\n\r\nDescription\r\n-----------\r\nThe network configuration has not been hardened.\r\n  * ICMP *redirects* tell a system about alternate routes and the current setting allows a routing device to update the routing tables of the system, which is normally not needed unless the system is a router\r\n  * The *log_martians* setting tells a system to log packets with non-routable source addresses to the kernel log\r\n  * The *icmp_echo_ignore_broadcasts* setting helps prevent the system from participating in a Smurf attack\r\n  * Source route validation, *rp_filter*, prevents the system from receiving certain bogus routing packets\r\n\r\nReproduction Details\r\n--------------------\r\nTo verify that redirects have been disabled, issue the following command. During review, these were set to \"1\".\r\n\r\n    sysctl -a | egrep 'net.ipv4.*(all|default).*_redirects'\r\n\r\nTo verify that martians will be logged, issue the following command. During review, these were set to \"0\".\r\n\r\n    sysctl -a | egrep 'net.ipv4.*(all|default).log_martians'\r\n\r\nTo verify that source route validation has been enabled, issue the following command. During review, this was set to \"0\".\r\n\r\n    sysctl net.ipv4.conf.all.rp_filter\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\n\r\nInfo – This is not a vulnerability, but the current settings increase the attack surface of the system and do not follow the information assurance concept of defence in depth.\r\n\r\nRecommendation\r\n--------------\r\nLateral Security recommends that each setting mentioned above be set to its opposite, binary setting, which would be the more secure one in /etc/sysctl.conf. A reboot will be required using this method.\r\n\r\nFor *_redirects:\r\n\r\n    echo 'net.ipv4.conf.all.accept_redirects = 0' >> /etc/sysctl.conf\r\n    echo 'net.ipv4.conf.default.accept_redirects = 0' >> /etc/sysctl.conf\r\n    echo 'net.ipv4.conf.all.secure_redirects = 0' >> /etc/sysctl.conf\r\n    echo 'net.ipv4.conf.default.secure_redirects = 0' >> /etc/sysctl.conf\r\n    echo 'net.ipv4.conf.all.send_redirects = 0' >> /etc/sysctl.conf\r\n    echo 'net.ipv4.conf.default.send_redirects = 0' >> /etc/sysctl.conf\r\n\r\nFor log_martians:\r\n\r\n    echo 'net.ipv4.conf.all.log_martians = 1' >> /etc/sysctl.conf\r\n    echo 'net.ipv4.conf.default.log_martians = 1' >> /etc/sysctl.conf\r\n\r\nFor rp_filter:\r\n\r\n    echo 'net.ipv4.conf.all.rp_filter = 1' >> /etc/sysctl.conf\r\n"},{"title":"MA-X Certificate Pinning","category":"Mobile Application Review","contents":"MA-X Certificate Pinning\n========================\n\nDescription\n-----------\n\nCertificate pinning is an additional layer of hardening that can be applied to SSL/TLS connections to reduce the risk of Man-in-the-Middle attacks and prevent users from examining network traffic. \n\nThis control is not in place in either the Android version or the iOS version of the application. However, the Android version is built on a relatively new version of the Android API which increases the effort required to intercept traffic.  \n\nReproduction Details\n--------------------\n\nUse an intercepting proxy such as Burp Suite and observe that it is possible to inspect and modify traffic. \n\nOn iOS this can be accomplished by adding a custom CA certificate from a file or the web. Note that in order to use this CA for intercepting traffic, it first has to be marked as trusted in the following location:\n  * Settings → General → About → Certificate Trust Settings\n\nEnsure client isolation is not enabled on the wireless network then in the phone settings set a proxy for the wired connection set to the proxy. \n\nSign into the application and observe whether traffic is visible in the proxy or the application returns an error message instead. \n\nSystems Affected\n----------------\n\nThe following application***s are*** affected by this issue: \n  * ***APPNAME*** (iOS version)\n  * ***APPNAME*** (Android version)\n\nSeverity\n--------\nLow – Certificate pinning is a mitigation which increases the difficulty an attacker faces in profiling the application behaviour and API to identify weaknesses as well as the general structure of communications. \n\nRecommendation\n--------------\n\nIt is recommended that certificate pinning be implemented by all mobile applications. \n\nSpecific instructions for iOS can be found at the URL below:\n * https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning#iOS\n "},{"title":"0365-X Insecure Account Access","category":"Office 365 Review","contents":"0365-X Insecure Account Access\n==============================\n\nDescription\n-----------\nSome accounts are not configured to use multifactor authentication. Multifactor authentication requires a user to enter a unique, one-time, authentication code which is generated by an approved device or service along with a password. This is sometimes referred to as \"something you know and something you carry,\" since the password is memorised and the unique code is typically provided by a device.\n* 5 global admins do not have MFA configured\n* 40 users do not have MFA configured\n\nReproduction Details\n--------------------\nTo see that MFA is not enabled for certain accounts, visit the following link:\n* https://securescore.microsoft.com/\n\nSeverity\n--------\nMedium – Leaving MFA disabled leaves accounts more vulnerable to account compromise and privilege escalation.\n\nThis finding indicates a lack of adherence to the following New Zealand Information Security Manual control.\n* NZISM 16.1.19. Methods for system user identification and authentication\n  * https://www.nzism.gcsb.govt.nz/ism-document/#1824\n\nThis finding indicates a lack of adherence to the following vendor recommendation:\n* Use multi-factor authentication (MFA)\n\nRecommendation\n--------------\nEnsure that all accounts require MFA for login. After the configuration change has been made, observe the reproduction details to verify that MFA has been enabled for all accounts.\n\nFor information on how to configure MFA, see:\n  * https://docs.microsoft.com/en-us/microsoft-365/admin/security-and-compliance/set-up-multi-factor-authentication?view=o365-worldwide\n"},{"title":"O365-X Insecure Mobile Device Access","category":"Office 365 Review","contents":"O365-X Insecure Mobile Device Access\r\n===================================\r\n\r\nDescription\r\n-----------\r\nMultiple settings in the implementation have not been configured to secure mobile access to implementation services. The Azure Intune configuration has not been configured to require that mobile devices access follow secure practices when accessing implementation services.\r\nThe profiles have not been assigned to any group.\r\n* no minimum password length\r\n* no complexity\r\n* no inactivity timeout\r\n* no expiration\r\n* no previous remembered\r\n* encryption not required\r\n* no IP-based geolocation filtering\r\n* text messages and phone calls have not been disabled as MFA methods\r\n\r\nReproduction Details\r\n--------------------\r\nTo see that Intune has not been configured to require secure access to implementation services, browse to the following location in Azure.\r\n* Device Compliance -> Policies -> [policy names]\r\n\r\nTo see that MFA is configured to use text messages and phone calls, browse to the following location in Azure.\r\n* Azure Active Directory -> All users -> Multi-Factor Authentication\r\n\r\nTo see that IP-based geolocation does not restrict access, use the Azure “What If” tool.\r\n\r\nSeverity\r\n--------\r\nMedium – Mobile devices expose a large attack surface. Insufficient controls are emplaced to prevent sensitive data loss. Any compromised device which can access the services of the implementation could lead to a compromise of the implementation and its data. This loss could occur outside of New Zealand jurisdiction.\r\nThis finding indicates a lack of adherence to the New Zealand Information Security Manual.\r\n* 21. Working Off-Site\r\n\r\nThis finding contravenes the top 10 critical controls of Cert NZ.\r\n* 6. Deploy multi-factor authentication -- Multi-factor authentication: key takeaways\r\n  * https://www.cert.govt.nz/it-specialists/critical-controls/multi-factor-authentication/\r\n* 10. Manage your mobile devices\r\n  * https://www.cert.govt.nz/it-specialists/critical-controls/10-critical-controls/\r\n\r\nRecommendation\r\n--------------\r\nA policy should be developed which mandates the recommendations of NZISM. A detailed design for the implementation should carefully and clearly document how each relevant recommendation is satisfied by the implementation. The implementation should follow the policy and be tested. Consider disabling functionality if any cannot be implemented in-line with NZISM. SMS and phone calls should not be used as MFA authentication methods.\r\n"},{"title":"O365-X Insufficient Auditing","category":"Office 365 Review","contents":"O365-X Insufficient Auditing\r\n============================\r\n\r\nDescription\r\n-----------\r\nInsufficient auditing has been conducted in the environment. Recording events and frequent auditing of those records gives an organisation visibility over the environment. Visibility enables the organisation to remain aware of configuration changes which can reduce the security of the environment and who made the changes.\r\nThe following components of the Office 365 environment have not been reviewed at least once a week.\r\n* audit data (audit log or activity API)\r\n* signs-ins after multiple failures report\r\n* role changes\r\n* mailbox forwarding rules\r\n* malware detections report\r\n* account provisioning activity report\r\n* non-global administrators\r\n\r\nThe following components of the Office 365 environment have not been reviewed at least once a week.\r\n* mailbox access by non-owners report\r\n\r\nThe following Office 365 capability has not been enabled.\r\n* enable mailbox auditing for all users\r\n* malware notifications\r\n\r\nRisky sign-ins, which indicate bad logging attempts, such as from outside the country, are not enabled.\r\n\r\nReproduction Details\r\n--------------------\r\nTo see that some components have not been reviewed as often as is recommended by the vendor, visit the following link.\r\n* https://securescore.microsoft.com/\r\n\r\nTo see that malware notifications have not been enabled for users and administrators, browse to the following location.\r\n* protection.office.com -> Threat management -> Policy -> Anti-malware\r\n\r\nTo see that Risky sign-ins have not been enabled, browse to the following location in the Azure portal.\r\n* Azure Active Directory -> Risky sign-ins\r\n\r\nSeverity\r\n--------\r\nMedium – Insufficient auditing makes awareness of compromise and locating the source of compromise more improbable.\r\n\r\nThis finding indicates a lack of adherence to the following New Zealand Information Security Manual controls.\r\n* NZISM 7.2.12. Reporting information security incidents\r\n  * https://www.nzism.gcsb.govt.nz/ism-document#1184\r\n* NZISM 15.2.12. Email server maintenance activities\r\n  * https://www.nzism.gcsb.govt.nz/ism-document#1734\r\n* NZISM 16.5.14. Event log auditing\r\n  * https://www.nzism.gcsb.govt.nz/ism-document#1983\r\n\r\nThis finding indicates a lack of adherence to the following vendor recommendation.\r\n* Enable mailbox audit logging\r\n\r\nRecommendation\r\n--------------\r\nEnsure that recorded events are audited weekly and bi-weekly, as enumerated in the description of this issue. Audit policy should clearly delegate monitoring responsibility. The metrics recommended by the SecureScore website should be enabled. Revisit this website after these recommendations have been followed.\r\nEnsure that administrators are notified of malware being sent to the organisation so that appropriate mitigation steps can be taken. Consider warning users.\r\n"},{"title":"O365-X Insufficient Data Loss Prevention","category":"Office 365 Review","contents":"O365-X Insufficient Data Loss Prevention\r\n========================================\r\n\r\nDescription\r\n-----------\r\nInsufficient steps have been taken to prevent data loss from the implementation. The following features in Office 365 have not been enabled.\r\n* Client Rules Forwarding Block has not been enabled.\r\n* Information Rights Management (IRM) is not used.\r\n\r\nClient Rules Forwarding Block prevents users from setting rules which automatically forward emails to address outside the organisation.\r\n* https://blogs.technet.microsoft.com/office365security/mitigating-client-external-forwarding-rules-with-secure-score/\r\n\r\nIRM helps prevent data loss via email by controlling who can access data stores in emails.\r\n* https://technet.microsoft.com/en-us/library/dn792011.aspx\r\n\r\nReproduction Details\r\n--------------------\r\nTo see that Client Rules Forwarding Block and IRM have ot been enabled, visit the following link.\r\n* https://securescore.microsoft.com/\r\n\r\nSeverity\r\n--------\r\nMedium – Data from email communications might be exfiltrated through automatic forwarding rules. Without classifying data through IRM, all rights management will be managed by human actions.\r\n\r\nThis finding indicates a lack of adherence to the following New Zealand Information Security Manual control.\r\n* NZISM 15.2.10. Automatic forwarding of emails\r\n  * https://www.nzism.gcsb.govt.nz/ism-document/#1734\r\n* NZISM 22.1.24. Unauthorised Access\r\n  * https://www.nzism.gcsb.govt.nz/ism-document#4760\r\n\r\nRecommendation\r\n--------------\r\nConsider enabling Client Rules Forwarding Block and IRM in the Office 365 configuration.\r\n"},{"title":"O365-X Insufficient Spoofing Prevention","category":"Office 365 Review","contents":"O365-X Insufficient Spoofing Prevention\r\n=======================================\r\n\r\nDescription\r\n-----------\r\nThe implementation has been configured with insufficient email spoofing preventative measures. A spoofed email is an email with a forged sender address. Email can be spoofed due to the original email protocol lacking an in-built method of authenticating senders. Over time, authentication protocols have been bolted on to the email protocol by leveraging DNS: SPF, DKIM, and DMARC. The implementation does not leverage two of these protocols.\r\n* No DKIM record exists in domain record.\r\n* DMARC is not configured.\r\nDomainKeys Identified Mail (DKIM) associates legitimate emails with their domain by including digital signatures with each legitimate email.\r\nDomain-based Message Authentication, Reporting and Conformance (DMARC) relies on SPF and DKIM and describes how delivery failures should be handled by upstream servers.\r\n\r\nReproduction Details\r\n--------------------\r\nTo test the configuration for the affected domains, visit a site recommended by the vendor and enter the domain name.\r\n* https://dmarcian.com/domain-checker/\r\n\r\nTo see that DKIM has not been configured, browse to the following location.\r\n* protection.office.com -> Threat management -> Policy -> DKIM -> [domains] (Status: Not signing DKIM signatures for this domain.)\r\n\r\nSeverity\r\n--------\r\nMedium – If these preventative measures are not configured, then receives of email sent by the organisation might not be able to tell whether the emails are legitimate. If the receivers default to a trusting position, then attackers might be able to convince receivers that their email originated from the organisation. If the receivers default to an untrusting position, then email from the organisation might be marked as spam and its servers might be added to blacklists.\r\n\r\nThis finding indicates a lack of adherence to the following New Zealand Information Security Manual control.\r\n* NZISM 15.2.16. DomainKeys Identified Mail (DKIM)\r\n  * https://www.nzism.gcsb.govt.nz/ism-document#1734\r\n\r\nRecommendation\r\n--------------\r\nEnsure that SPF, DKIM, and DMARC have been configured for each domain under the organisations control. All incoming email should be validated by checking the DKIM signatures from the originating domain.\r\n"},{"title":"OAS-X No Messages Authentication","category":"Oracle As2 Service","contents":"OAS-X No Messages Authentication\r\n================================\r\n\r\nDescription\r\n-----------\r\nAS2 request messages submitted without signatures or encryption are accepted by the service, and return a valid response. This lack of signing means that any system with access to the service can claim to be any other user, simply by setting the \"AS2-From\" HTTP header to the name of that user. This raises serious concerns regarding auditing accuracy and accountability.\r\n \r\nSecondly, the fact that security requirements are not enforced by the service means that the responsibility for ensuring requests are submitted securely lies entirely with the client. If it is possible to receive responses to insecure requests, it is possible implementers will misunderstand or ignore the security requirements.\r\n \r\nLateral Security was informed that this issue appears to be caused by a bug in the latest version of Oracle SOA Suite which prevents message signing and encryption from being properly enforced for incoming messages.\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nHigh – The lack of message signing constitutes a fundamental issue within the authentication and authorisation controls of the service. An attacker who gains access to the system is easily able to pose as any other user and submit malicious requests on their behalf.\r\n\r\nAlthough a potential attacker will not receive the response to their request, the response will be sent to the user the attacker is impersonating, thus allowing an attacker to trigger the sending of messages from the service to other clients. This is aggravated by the fact that data supplied by the attacker may be included in the response message, such as the MessageId, or the entire request. By including malicious data in these fields, an attacker may be able to exploit vulnerabilities in software used by other clients while the messages appear to originate from the service, resulting in reputational damage.\r\n\r\nThe prerequisites of conducting any such attack by an outside third-party are significant. Appropriate firewall access for a particular source IP address must be established and the attacker must have knowledge of how to interact with the service.\r\n\r\nExposure or misuse of sensitive information would likely cause significant reputational damage and may also carry a potential threat of legal action.\r\n\r\nRecommendation\r\n--------------\r\nLateral Security advises that the system should not be made available until this issue is resolved. \r\nContact the software vendor for a resolution to this issue. The \"AS2-From\" header should never be trusted.\r\n"},{"title":"ODB-X Default Auditing Configured","category":"Oracle Database","contents":"ODB-X Default Auditing Configured\r\n=================================\r\n\r\nDescription\r\n-----------\r\nExamination of the database auditing within DBA_STMT_AUDIT_OPTS and DBA_PRIV_AUDIT_OPTS shows that the default audit rules exist. The default settings leave a fair audit trail of the most pertinent database queries. Secure auditing becomes more difficult when highly sensitive data is hosted within the database.\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nHigh – In the event that an attacker gains sufficient access to the database, all data may be obtained without any effective audit trail.\r\n\r\nRecommendation\r\n--------------\r\nRefer to the design documentation to ascertain specifically what and how access to stored sensitive data should be audited. Investigate whether database-level auditing is stipulated within the design to decide if this is an oversight. In the event that it is the latter, conduct remedial discussions surrounding how project-wide audit data should be stored.\r\n\r\nDue care must be taken to ensure additional auditing does not create another vector for the sensitive information to be stored. The fact that a particular user account conducted a query against a particular table resulting in a large set of results is pertinent. The results of the query may not be pertinent and would cause duplication of the data. "},{"title":"ODB-X Insecure User Accounts","category":"Oracle Database","contents":"ODB-X Insecure User Accounts\r\n============================\r\n\r\nDescription\r\n-----------\r\nThe following user account issues were identified:  \r\n  * The database instance has a user account named \"test\". This account has minimal privilege. However, if this account is a test account it may have an insecure password. \r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nMedium – User accounts should be documented and managed appropriately to ensure inappropriate or unauthorised access is not permitted. Oracle Database has been vulnerable to privilege escalation vulnerabilities.\r\n\r\nRecommendation\r\n--------------\r\nThe identified account is not likely to be needed for normal operation and should therefore be removed. "},{"title":"ODB-X Unhardened Database Interfaces","category":"Oracle Database","contents":"ODB-X Unhardened Database Interfaces\r\n====================================\r\n\r\nDescription\r\n-----------\r\nA number of security controls, which can further strengthen the TNS Listener interface, have not been configured. Strong encryption is not enforced. The directive, \"SQLNET.ENCRYPTION_SERVER\", is not set to \"REQUIRED\" within the \"sqlnet.ora\" configuration files. It therefore allows a database client to decide how the communications should be secured.\r\n\r\nNo evidence of Class of Secure Transport (\"COST\") was identified within the \"tnslistener.ora\" configuration files. The following directives were not found:\r\n  * DYNAMIC_REGISTRATION_listener_name\r\n  * SECURE_CONTROL_listener_name\r\n  * SECURE_REGISTER_listener_name\r\n  * SECURE_PROTOCOL_listener_name\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nMedium – To conduct an attack, there is a prerequisite of gaining sufficient network access. A successful attack would yield sensitive credentials, database contents and may lead to a compromise of the underlying host operating system.\r\n\r\nRecommendation\r\n--------------\r\nConsider enforcing the use of encryption to ensure all database communication is protected from eavesdropping. \r\nImplement COST security controls to prevent TNS Listener poisoning. Ensure \"Dynamic Registration\" is explicitly disabled. \r\nLateral Security recommends that the database security controls be hardened in accordance with the CIS Oracle Database 11g benchmark, which may be found at the following location: \r\n  * https://benchmarks.cisecurity.org/downloads/multiform/index.cfm "},{"title":"ODB-X User Account Security","category":"Oracle Database","contents":"ODB-X User Account Security\r\n===========================\r\n\r\nDescription\r\n-----------\r\nA single user account profile of \"DEFAULT\" exists within the database instances. The following user account security options are set: \r\n  * Passwords may be reused indefinitely. \r\n  * Unlimited number of sessions per user account. \r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nLow – Allowing passwords to be reused defeats the purpose of forcing passwords to be changed. Users can choose the same password or from among several passwords when a password change occurs. This weakened the security provided by authentication mechanisms and might enable an attacker to more easily enter a system.\r\n\r\nIf the number of sessions allowed per user is not restricted, the host could be more susceptible to a denial of service attack. This occurs when a user opens too many sessions, exhausting the memory of the host.\r\n\r\nRecommendation\r\n--------------\r\nConsider setting restrictions on password reuse. Investigate whether it is appropriate to limit the number of open sessions for particular accounts. In particular, administrative accounts would most likely benefit from such a restriction.\r\n"},{"title":"ODR-X No Configuration Management","category":"Oracle Design Review","contents":"ODR-X No Configuration Management\r\n=================================\r\n\r\nDescription\r\n-----------\r\nThe provided documentation does not explicitly detail the post-installation configuration that must be implemented. Currently, a manual process must be conducted to complete the following tasks:\r\n  * Configuration of rsyslog.\r\n  * Installation and configuration of a monitoring solution and instances of third-party software (such as OHS and Weblogic).\r\n  * Manual modification of OHS configuration files. It is unclear how the necessary details are currently stored and managed.\r\n  * General system hardening efforts, with the exception of additional configuration conducted through Kickstart scripts.\r\n  * Custom configuration of third-party software to conduct the server's role.\r\n\r\nIn the event that a system requires replacement or a rebuild, the process is manual with no central documentation of the necessary changes.\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nMedium – The rebuild process will likely take a substantially long time. A successful attack which forces a rebuild would have a greater overall impact on the solution due to downtime. Without an automated system in place, rebuild documentation becomes essential to recover from a security event in a timely manner.\r\n\r\nRecommendation\r\n--------------\r\nModern Unix-based systems rely on both build scripts and configuration management to quickly build a host when required. Build scripts limit the amount of human intervention required. It is debatable whether the creation and management of such a system is worthwhile for a limited number of systems. Systems such as Puppet are seen as industry-standard solutions, but they are not likely to be suitable for more complex Oracle software installations such as Oracle Database and WebLogic.\r\n\r\nIf an automated approach is not to be conducted, then sufficiently detailed documentation on the system build process must be created.\r\n\r\nConsider estimating the required time to rebuild the solution from scratch and identify the documentation that must be finalised for it to occur. If the rebuild time is potentially unacceptable, possibly due to SLA metrics, consider implementing a configuration management process.\r\n"},{"title":"ODR-X Unmanaged Software","category":"Oracle Design Review","contents":"ODR-X Unmanaged Software\r\n========================\r\n\r\nDescription\r\n-----------\r\nSome software examined is not managed by the software repository that has been explicitly set up for the environment. This software includes:\r\n  * Oracle HTTP Server\r\n  * WebLogic\r\n  * Apache Tomcat\r\n\r\nInstallation \"answer\" files may be provided to hasten the process, but an administrator must initiate the installation. Updates to the above installed software must be manually tracked and correlated against hotfixes or new releases provided by the software vendor.\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nMedium – This process is prone to human error and would likely delay implementation of critical patches.\r\n\r\nRecommendation\r\n--------------\r\nAmend the build process to install the software directly from a software repository. Consider automatically installing updates from the vendor which patch critical vulnerabilities."},{"title":"OFM-X Divergent Patching","category":"Oracle Fusion Middleware","contents":"OFM-X Divergent Patching\r\n========================\r\n\r\nDescription\r\n-----------\r\nThe running kernels on the Oracle Enterprise Linux hosts are the Oracle UEK (Unbreakable Enterprise Kernel) variant. However, the hosts are being patched against the upstream vendor's (RedHat) kernel. This has created a mismatch as the patching process is not providing a UEK kernel.\r\n\r\nNo patching process currently exists for third-party software which includes Apache Tomcat, Oracle WebLogic, Oracle HTTP Server, Oracle Database, and Oracle SOA. This software has been installed manually and is not backed by any software management solution. As such, future patches would have to be applied manually across the hosts individually.\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nHigh – The process used to patch the hosts is not effective. Some host software might have critical vulnerabilities and never be patched. This could lead to a compromise of internal systems and a loss of sensitive data.\r\n\r\nRecommendation\r\n--------------\r\nEnsure that a patching policy exists which mandates all of the following:\r\n  * Patches deemed to be \"important\" or \"critical\" by either the operating system or third-party software vendors must be implemented as quickly as possible. This should be conducted separately from any regular patch cycle in order to minimise the potential exposure period.\r\n  * Include Oracle UEK kernel packages into the managed YUM repository.\r\n  * Investigate whether it is possible to manage third-party software installations through the package repository of the operating system vendor. This will create a consistent method for both installing and updating the software. \r\n  * All third party software installations that are not native to the operating system installation should be documented. Regular checks for software updates should be conducted. All patches must be applied as rapidly as possible.\r\n  * Ensure systems are rebooted after kernel upgrades have been performed."},{"title":"OFM-X Unhardened Web Server Configuration","category":"Oracle Fusion Middleware","contents":"OFM-X Unhardened Web Server Configuration\r\n=========================================\r\n\r\nDescription\r\n-----------\r\nThe web server configuration has not been hardened according to industry good practices.\r\n  * An \"alias\" map exists for the \"cgi-bin\" path. This is explained in further detail within issue OAS-7 Unnecessary Content Available\r\n  * The following modules are not likely needed for normal operation:\r\n    * autoindex_module \r\n    * alias_module \r\n    * auth_basic_module \r\n    * authn_file_module \r\n    * usertrack_module \r\n    * proxy_[...]_module \r\n    * rewrite_module \r\n  * SSLVerifyClient is not enabled, which prevents the web server from conducting mutual SSL authentication\r\n  * Default Oracle content exists within the htdocs web root\r\n  * Custom generic error pages defined by ErrorDocument directives have not been configured\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nMedium – An attacker with suitable network access may issue HTTP requests to the server without the need for a valid client SSL certificate and key. This increases the attack surface beyond what is necessary for normal operation. The \"SSLVerifyClient\" directive prevents an attacker from being able to establish an HTTPS connection to the server.\r\n\r\nLoading modules increases the attack surface of the web server. The configuration does not currently use any functionality provided by the modules.\r\n\r\nUsing the default responses could disclose information to an attacker. The attacker could use this information to further profile the web server and refine attacks.\r\n\r\nRemoving the defined cgi-bin alias and the default web content will further limit access to unneeded content. In particular, the content hosted under cgi-bin could be misconstrued to be a security issue.\r\n\r\nRecommendation\r\n--------------\r\nConsider making further changes based on the elements highlighted within the description of this issue. For further information, refer to the Centre for Internet Security's Apache benchmark, which can be located at the following URL:\r\n  * http://benchmarks.cisecurity.org/tools2/apache/CIS_Apache_Benchmark_v2.1.pdf  "},{"title":"OFM-X Insecure WebLogic Configuration","category":"Oracle Fusion Middleware","contents":"OFM-X Insecure WebLogic Configuration\r\n===================\r\n\r\nDescription\r\n-----------\r\nThe WebLogic configuration has development settings enabled and has not been hardened. The following elements could further harden the environment and align it to industry good practice. \r\n  * OHS WebLogic plugin \r\n    * Remove debug settings, defined by the parameters \"WlLogFile\" and \"Debug\" \r\n    * Set a custom generic error page via the \"ErrorPage\" directive to limit information disclosure\r\n    * Handle application errors in the configuration file of the application\r\n  * WebLogic installation \r\n    * Configure WebLogic coherence clustering and server identities\r\n    * Specify a custom CA trust store within the WebLogic process arguments\r\n    * Strengthen the minimum supported SSL protocol level\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nMedium – Failure to remove debugging prior to production will increase load on system resources. This higher load will make the implementation more prone to denial of service attacks. The debugging might also present detailed information to an attacker. The attacker could use this information to further profile the application and refine attacks.\r\n\r\nAn attacker with significant network access might be able to eavesdrop on highly sensitive information because communication among the clustered WebLogic servers is insecure.\r\n\r\nRecommendation\r\n--------------\r\nRemove the debugging functionality on the OHS instances prior to production. Consider implementing generic error pages within the OHS instances. Examine the running public-facing application's settings to identify how the application handles an unexpected error. An effective balance between security and usability must be reached. Removing too much debugging information may prevent a third-party from diagnosing errors when interacting with the service. \r\n\r\nConsider configuring the WebLogic instances to be more in line with Oracle's best practices. More information may be found at the following locations: \r\n  * http://docs.oracle.com/middleware/1212/wls/SECMG/\r\n  * http://docs.oracle.com/middleware/1212/coherence/COHSG/\r\n"},{"title":"PSR-X Undocumented Physical Access Control","category":"Physical Security Review","contents":"PSR-X Undocumented Physical Access Control\r\n==========================================\r\n\r\nDescription\r\n-----------\r\nThe design does not sufficiently document the physical access control systems to the facility. Access control systems include a combination of psychological barriers, the presence of security staff at entry/exit points, surveillance equipment, locks, and multi-factor identity validation (authentication). Multi-factor authentication can include some combination of something known by personnel (PINs, codes, etc.), something carried by personnel (cards, keys, etc.), and/or biometric recognition (face, fingerprint, etc.).\r\n\r\nSeverity\r\n--------\r\nMedium – Without sufficient documentation, it is impossible to determine whether security requirements have been met.\r\n\r\nThis issue indicates a lack of adherence to NZISM:\r\n  * 8.1.9 Facility physical security\r\n\r\nNZISM 8.1.9 refers to the PSR (Protective Security Requirements).\r\n  * PHYSEC1 states \"agencies must provide clear direction on physical security through the development and implementation of an agency physical security policy, and address agency physical security requirements as part of the overall agency security plan.\"\r\n\r\nRecommendation\r\n--------------\r\nRefer to the PSR. Physical Security Management Protocol, Security Zones and Risk Mitigation Control Measures, Section 4.5 includes information on access control. The documentation should include the physical security requirements for the facility, how those requirements were determined, and the specific measures taken to meet those requirements.\r\n  * https://www.protectivesecurity.govt.nz/\r\n"},{"title":"﻿SDR-X Exchange Denial of Service","category":"Security Design Review","contents":"﻿SDR-X Exchange Denial of Service\r\n================================\r\n\r\nDescription\r\n-----------\r\nActive Directory password policy includes account lockout after 5 invalid logon attempts. Active Directory logon is exposed to the Internet through both Active Sync and Outlook Web Access (OWA) as well as the connectivity to the wireless network. Incorrect logon attempts to Exchange services will result in the corresponding Active Directory Account being locked out.\r\n\r\nReference\r\n---------\r\n***Which section of which document are we referring to?***\r\n\r\nSeverity\r\n--------\r\nHigh – An attacker could perform a denial of service attack. Repeated attempts to authenticate to Outlook or ActiveSync will lock out Active Directory accounts. This would lead to a loss of staff productivity and a denial of service to customers.\r\n\r\nRecommendation\r\n--------------\r\nLimit authentication against Active Directory to trusted devices. Unsuccessful logon attempts through the Exchange should be set to one fewer than the Active Directory Account Lockout setting to prevent a denial of service while still preventing unlimited password attempts."},{"title":"SDR-X Insufficient Data Remanence Policy","category":"Security Design Review","contents":"SDR-X Insufficient Data Remanence Policy\r\n========================================\r\n\r\nDescription\r\n-----------\r\nThe design does not contain a sufficient policy on data remanence. Data remanence concerns the residual data left on storage hardware even after hardware failure or attempted erasure has occurred. Data remanence policy includes measures that will help prevent data loss after hardware decommissioning and how hardware, which has been used to store data, should be disposed.\r\n\r\nReference\r\n---------\r\n***Which section of which document are we referring to?***\r\n\r\n\r\nSeverity\r\n--------\r\nMedium – Without sufficient documentation, it is impossible to determine whether security requirements have been met. If hardware which contains sensitive data is released to the public, the data could be used to harm the reputation of the organisation.\r\n\r\nRecommendation\r\n--------------\r\nThe documentation should mandate data encryption where possible and the destruction of data storage hardware which has been used by the implementation. This should include the process for the destruction of this hardware and a sign off to ensure that it has occurred.\r\n"},{"title":"SDR-X Insufficient Database Security Policy","category":"Security Design Review","contents":"SDR-X Insufficient Database Security Policy\r\n===========================================\r\n\r\nDescription\r\n-----------\r\nThe design does not detail the steps taken to secure the database. It neither enumerates roles nor defines the privileges which will be assigned. Database hardening is not detailed in the design.\r\n\r\nReference\r\n---------\r\n***Which section of which document are we referring to?***\r\n\r\n\r\nSeverity\r\n--------\r\nLow – Without sufficient documentation, it is impossible to determine whether security requirements have been met. If roles are not defined, then it remains unclear whether the appropriate roles will be created after sign off. Roles might have too much authority or there might be too many, unnecessarily increasing the attack surface of the implementation.\r\n\r\nRecommendation\r\n--------------\r\nThe design should enumerate the roles which will be needed by the applications of the implementation. These roles should be strictly defined. Policy should describe when application users should be added and removed from these roles.\r\nDatabase hardening should occur. Care should be given to the configuration of the TNS listener interface. Strong encryption should be enabled. The CIS Oracle has good recommendations for hardening of the Oracle database.\r\n  * https://benchmarks.cisecurity.org/downloads/multiform/index.cfm\r\n"},{"title":"DR-X Insufficient Documentation Provided","category":"Security Design Review","contents":"DR-X Insufficient Documentation Provided\n=============================================\n\nDescription\n-----------\nThe documentation supplied provides insufficient detail regarding the security requirements of the environment and the security controls designed to meet those requirements.\n\nThe documentation provided does not provide the necessary information to “ensure the stated security objectives and risks are appropriately managed, and to identify any gaps in the technical design\" which is the objective of this review.\n\n**Further detail on what has been provided and how it deviates from requirements***\n\nReference\n---------\n***Which section of which document are we referring to?***\n\n\nSeverity\n--------\nHigh – A lack of documentation regarding the organisation and the environment's security requirements and how those requirements will be met is likely to lead to decisions with a security impact being made in an ad-hoc manner, increasing the likelihood of compromise and the loss or unauthorised disclosure of information\n\nRecommendation\n--------------\nThe solution design should be more thoroughly defined, especially with regards to security risks and mitigations. Lateral Security recommends following the recommendations of the most recent version of the New Zealand Information Security Manual, which is produced by the Government Communications Security Bureau. When solving the problems detailed by the design, the topics covered in the manual should be addressed as part of the documented solutions. The most recent version of NZISM can be found at the following link:\n- https://www.gcsb.govt.nz/publications/the-nz-information-security-manual/\n"},{"title":"DR-X Insufficient Hardening Requirements","category":"Security Design Review","contents":"DR-X Insufficient Hardening Requirements\n=============================================\n\nDescription\n-----------\nNo industry standard hardening guides are required or referenced by the design. Hardening guides include security manuals, security benchmarks, security technical implementation guides, and vendor documentation.\n\nReference\n---------\n***Which section of which document are we referring to?***\n\n\nSeverity\n--------\nMedium – Hardening guides are an important part of securing an implementation. These guides often contain knowledge which has come from years of experience, testing, and many environments. If the recommendations of these guides are not followed, common security vulnerabilities might be introduced to the implementation. Recommended standards are not being followed.\nThis finding indicates a lack of adherence to:\n-\tNZISM 5.5. Standard Operating Procedures\n-\tNZISM 14.1. Standard Operating Environments\n\n\nRecommendation\n--------------\nEnsure that hardening guides are referenced in documentation and required for all implementations. Hardening should take place before testing to ensure that the expected functionality remains.\n"},{"title":"SDR-X Insufficient Monitoring Policy","category":"Security Design Review","contents":"SDR-X Insufficient Monitoring Policy\r\n====================================\r\n\r\nDescription\r\n-----------\r\nThe design does not detail the log facility and responsibilities of monitoring. Centralised logging facilitates monitoring the events within an implementation and can better provide a big picture view of what might otherwise seem like unrelated events and provides an easier point for the backup of logs. Assigning monitoring responsibilities can better ensure that monitoring will occur.\r\n\r\nReference\r\n---------\r\n***Which section of which document are we referring to?***\r\n\r\n\r\nSeverity\r\n--------\r\nInfo – If logging is not centralised, important coincidences which point to an attacker infiltrating the implementation may go unnoticed. Were a host to become compromised, any logs which might point to the compromise or how the compromise occurred could be erased or otherwise tampered with to prevent proper audit. It also raises the question of, \"how are host events being monitored?\" If responsibilities are not delegated by policy, then monitoring might not be performed. This finding is not a vulnerability, but does not follow good practice.\r\n\r\nRecommendation\r\n--------------\r\nThe design should mandate centralised, duplicated logging. Monitoring should be clearly delegated in policy.\r\n"},{"title":"﻿SDR-X Insufficient Password Policy","category":"Security Design Review","contents":"﻿SDR-X Insufficient Password Policy\r\n==================================\r\n\r\nDescription\r\n-----------\r\nPassword policy includes the creation, changing, and expiration of passwords within an organisation or implementation. The design does not describe password policy concerning:\r\n  * Password length\r\n  * Password complexity\r\n  * Password expiration\r\n  * How often passwords may be changed\r\n  * Password reuse\r\n\r\nReference\r\n---------\r\n***Which section of which document are we referring to?***\r\n\r\n\r\nSeverity\r\n--------\r\nMedium – If a password could be guessed or brute forced, then the implementation remains vulnerable to compromise. This could lead to corruption of data, exfiltration of data, and ultimately to reputation damage to the organisation.\r\n\r\nRecommendation\r\n--------------\r\nPassword policy should mandate that passwords:\r\n  * Have a minimum length of 10 characters consisting of at least 3 character classes or\r\n  * Have a minimum length of 16 characters with no complexity requirements\r\n  * Be changed every 90 days\r\n  * Not be changed more often than 1 time a day\r\n  * Be changed upon password reset\r\n  * Not be the same within 8 resets\r\n"},{"title":"DR-X Insufficient Patching Policy","category":"Security Design Review","contents":"DR-X Insufficient Patching Policy\r\n=============================================\r\n\r\nDescription\r\n-----------\r\nThe design does not describe the process for upgrading the components of the implementation. \r\nIt also does not describe how vulnerabilities and available patches will be monitored, \r\nhow soon patching occurs after a patch has been released, what mitigations will be taken should a patch be unavailable for any of the components, \r\nnor who will be responsible for the patching and mitigations. \r\n\r\nPatching is one of the critical controls published by CERT NZ and part of the Essential Eight mitigations published by the Australian Signals Directorate to help prevent compromise.\r\n\r\nReference\r\n---------\r\n***Which section of which document are we referring to?***\r\n\r\n\r\nSeverity\r\n--------\r\nMedium – Without a well-defined patching policy, some components may go unpatched, leaving the overall implementation vulnerable to exploitation. \r\nThis could lead to corruption of data, exfiltration of data, and ultimately to reputational damages and other losses to the organisation.\r\n\r\nRecommendation\r\n--------------\r\nFor each component of the implementation, the documentation should include:\r\n* How vulnerabilities and available updates will be monitored\r\n* How quickly lesser severity patches and critical patches must be applied\r\n    * Lesser severity patches should be applied as soon as possible\r\n    * Critical patches should be applied within 2 days\r\n* What mitigations are available and detailed steps to achieve mitigation if patching is not possible\r\n* Who will be responsible for monitoring, patching, and mitigation\r\n    * This person or these people must have adequate authority to fulfil their responsibilities\r\n\r\n"},{"title":"DR-X Insufficient User Access Policy","category":"Security Design Review","contents":"DR-X Insufficient User Access Policy\r\n=============================================\r\n\r\nDescription\r\n-----------\r\nThe design neither details the criteria used to determine who should be granted access to the components of the implementation nor the authorities responsible for granting access. It does not place a limit on the number of administrators for each component.\r\nSpecifically described by the design, administrators or administrative staff will have access to:\r\n* **Add me**\r\n\r\nReference\r\n---------\r\n***Which section of which document are we referring to?***\r\n\r\n\r\nSeverity\r\n--------\r\nLow – Without a policy to follow, it might be difficult to prevent an unsafe number of administrators and users from having access to critical components, increasing the likelihood of compromise. Responsibilities maybe become unclear, neglected, or executed by the wrong staff members. If multiple users use the same account, then attribution cannot be determined.\r\nThis finding indicates a lack of adherence to:\r\n* NZISM 6.3. Change Management\r\n\r\n\r\nRecommendation\r\n--------------\r\nAccess policy should include:\r\n* The party responsible for the administration of each component\r\n* The criteria for adding administrative and regular users\r\n* The criteria for removing administrative and regular users\r\n* The change management authorities\r\n\r\nThe number of users should be kept to a minimum to reduce the attack surface of the implementation. Accounts should never be shared. Policy should mandate that all changes be recorded along with their business justification.\r\nEnsure that sensitive data repositories, such as those enumerated in the description, have controls which limit access to their contents according to authorisation.\r\nAudits should also be regularly carried out, and systems in place to identify users who have not logged in for a prolonged period of time.\r\n\r\n"},{"title":"DR-X Key or Certificate Management Undefined","category":"Security Design Review","contents":"DR-X Key or Certificate Management Undefined\n=============================================\n\nDescription\n-----------\nThe management of cryptographic keys and certificates was not defined in the documentation. Key management is important as the private keys and certificates are used to encrypt the data throughout an environment. If keys are not appropriately provisioned, stored and destroyed, an attacker may be able to decrypt and intercept network traffic. If perfect forward secrecy is not in use, this would allow an attacker to retroactively decrypt previously captured traffic.\n\nReference\n---------\n***Which section of which document are we referring to?***\n\n\nSeverity\n--------\nLow – Without appropriate key management in place, an attacker may be able to obtain the private keys in use throughout the environment and obtain access to sensitive traffic.\n\nRecommendation\n--------------\nLateral Security recommends all key management practices are defined in accordance with NZISM 17.9. This should include the provisioning and generation of keys, as well as the storage and the destruction of them. \nThe policy should also define policies regarding key revocation, rotation frequency, backups, etc.\n"},{"title":"DR-X No Incident Response Policy","category":"Security Design Review","contents":"DR-X No Incident Response Policy\n=============================================\n\nDescription\n-----------\nThe design does not include or reference an incident response policy. No emergency contact details have been included in the design.\n\nReference\n---------\n***Which section of which document are we referring to?***\n\n\nSeverity\n--------\nLow – A lack of emergency policy and contact details could make response to an attack or disaster more difficult to respond to and might lead to longer downtimes or further penetration into the solution.\n\nRecommendation\n--------------\nIncident response policy should include:\n* emergency contact details (incident authority)\n* definition of an incident\n* short-term response instructions until the incident authority can be reached\n* how to safeguard evidence of the incident\n* how to formally report incidents\n"},{"title":"DR-X No Mutual TLS","category":"Security Design Review","contents":"DR-X No Mutual TLS\n=============================================\n\nDescription\n-----------\nThe design will not use mutual TLS (mTLS) to establish connections. This mode forces both sides of a connection to authenticate themselves to establish their connection, which can help prevent untrusted client systems from establishing a connection to a trusted server.\n\nReference\n---------\n***Which section of which document are we referring to?***\n\n\nSeverity\n--------\n***Rating*** – ***Description***\n\nRecommendation\n--------------\nConnections between interfaces should use mTLS ***include reasons related to design***.\n"},{"title":"DR-X NZISM Considerations Omitted","category":"Security Design Review","contents":"DR-X NZISM Considerations Omitted\n=============================================\n\nDescription\n-----------\nIt is expected that the solution will require compliance with the New Zealand Information Security Manual (NZISM), however it was noted that no reference to this document is made in the provided documentation. If security requirements are not mapped to NZISM standards and these standards incorporated into the design, it could be difficult to ensure that the solution will be aligned with this standard.\nLateral Security was not provided with the following types of documents as defined in the NZISM (section 5.1.5):\n* Information Security Policy\n* Systems Architecture\n* Security Risk Management Plan\n* System Security Plan\n* Site Security Plan\n* Standard Operating Procedures\n* Incident Response Plan\n* Emergency Procedures\n\nReference\n---------\n***Which section of which document are we referring to?***\n\n\nSeverity\n--------\nMedium – If the security guidance provided by NZISM is not used within the design process, this may cause significant issues in the future which may delay the solution certification.\n\n\nRecommendation\n--------------\nEnsure the solution has been designed to meet the security standards set by NZISM to ensure it is appropriately configured and architected for the intended certification.\n"},{"title":"DR-X Technical Testing Recommended","category":"Security Design Review","contents":"DR-X Technical Testing Recommended\n==================================\n\nDescription\n-----------\nBased on the security analysis carried out by Lateral Security, a number of technical testing assurance activities are recommended. The following diagram provides context on the environment:\n\n***Insert diagrams***\n\nThe following testing is recommended:\n  * Firewall rulebase review - this will ensure that the firewall rules between zones only allow the minimum traffic required for the implementation. In particular, management traffic is expected, along with database traffic from the application VLAN to the database VLAN. HTTPS traffic is expected in to the application VLAN.\n  * Web application penetration testing - this will identify any potential vulnerabilities within the web application.\n  * Mobile application penetration testing and/or code review - this will identify any vulnerabilities within the mobile application. Of particular concern is ensuring that data is encrypted while cached on the device.\n  * Data warehouse hardening review - this should ensure that other tenants using the data warehouse cannot gain access to the data for the application.\n\n*** These are obviously examples, fill these out as appropriate ***\n\nReference\n---------\n***Which section of which document are we referring to?***\n\n\nSeverity\n--------\nInfo – This observation is raised to capture recommended technical testing as determined from the Security Design Review.\n\n\nRecommendation\n--------------\n\n"},{"title":"﻿SDR-X Undocumented Cipher Requirements","category":"Security Design Review","contents":"﻿SDR-X Undocumented Cipher Requirements\r\n======================================\r\n\r\nDescription\r\n-----------\r\nThe design does not contain a policy on cipher requirements. A cipher is an algorithm which encrypts plaintext to ciphertext or decrypts ciphertext to plaintext. The security of a ciphertext is dependent on the strength of its cipher. Some widely supported ciphers have known weaknesses.\r\nOther components will also make use of encryption. All of these should allow some configuration of their ciphers.\r\n\r\nReference\r\n---------\r\n***Which section of which document are we referring to?***\r\n\r\n\r\nSeverity\r\n--------\r\nLow – Without documentation, it is impossible to determine whether security requirements have been met. The use of weak ciphers may make data transfers to, from, and within the implementation vulnerable to interception either now or the near future. Disclosure of sensitive information could damage the reputation of the organisation.\r\n\r\nRecommendation\r\n--------------\r\nPolicy should detail the use of encryption in every component which supports it. Some examples would include web applications, file transfer protocols, volume/file system encryption, websites, and remote administration. Use modern ciphers which are not known to be weak. Disable all other ciphers within configurations. Do not use pieces of software or protocols which do not support strong ciphers. NZISM 17.2, Approved Cryptographic Algorithms, provides a baseline for cryptographic cipher selection.\r\n"},{"title":"SDR-X Undocumented Physical Access Control","category":"Security Design Review","contents":"SDR-X Undocumented Physical Access Control\r\n==========================================\r\n\r\nDescription\r\n-----------\r\nThe design does not document the physical access control systems protecting the implementation. Access control systems include a combination of psychological barriers, the presence of security staff at entry/exit points, surveillance equipment, locks, and multi-factor identity validation (authentication). Multi-factor authentication can include some combination of something known by personnel (PINs, codes, etc.), something carried by personnel (cards, keys, etc.), and/or biometric recognition (face, fingerprint, etc.).\r\n\r\nReference\r\n---------\r\n***Which section of which document are we referring to?***\r\n\r\n\r\nSeverity\r\n--------\r\nInfo – Without sufficient documentation, it is impossible to determine whether security requirements have been met. Lateral Security understands that physical access control might be outside the scope of the review. However, this finding is being raised for completeness.\r\n\r\nRecommendation\r\n--------------\r\nThe documentation should include the physical security requirements for the facility housing the implementation, how those requirements were determined, and the specific measures taken to meet those requirements.\r\n"},{"title":"﻿SDR-X Unencrypted Private WAN","category":"Security Design Review","contents":"﻿SDR-X Unencrypted Private WAN\r\n=============================\r\n\r\nDescription\r\n-----------\r\nLateral Security observed that traffic on the private WAN is not encrypted and that the private WAN is provided by a third party. The security of the WAN depends on the third party. The employees of the third party also have access to this data and would likely not have signed any documents which bind them to keep the traversing data confidential.\r\n\r\nReference\r\n---------\r\n***Which section of which document are we referring to?***\r\n\r\n\r\nSeverity\r\n--------\r\nMedium – If traversing data were to be disclosed by the third party, reputational damage might occur along with financial loss due to resulting litigation. This data could include database records, credentials, internal emails, and other sensitive information.\r\n\r\nRecommendation\r\n--------------\r\nLateral Security recommends performing a thorough audit of the traffic going over the WAN to gain a better understanding of any breaches which might have occurred. Going forward, Lateral Security recommends encrypting all data going across the WAN using a technology such as IPsec at layer 3 in conjunction with encryption at the application layer when the application provides the option. The WAN, being private, along with encryption at more than one layer will act as a means of defence in depth for sensitive traffic which exits the organisation.\r\n"},{"title":"DR-X Issue Name","category":"Security Design Review","contents":"DR-X Issue Name\n=============================================\n\nDescription\n-----------\nDescription\n\nReference\n---------\n***Which section of which document are we referring to?***\n\n\nSeverity\n--------\nRating – Description\n\nRecommendation\n--------------\nRecommendation\n"},{"title":"The use of wildcards indicates that the certificates will be stored on multiple systems, thereby increasing the attack surface of the implementation. Compromise of any one of these systems could lead to the compromise of the wildcard certificates. This would allow an attacker to stand a new service up, which uses the stolen certificate. Such a service would appear to be legitimate to any connecting client. Wildcard use is discouraged by RFC 6125, section 7.2.","category":"Security Design Review","contents":"The use of wildcards indicates that the certificates will be stored on multiple systems, thereby increasing the attack surface of the implementation. Compromise of any one of these systems could lead to the compromise of the wildcard certificates. This would allow an attacker to stand a new service up, which uses the stolen certificate. Such a service would appear to be legitimate to any connecting client. Wildcard use is discouraged by RFC 6125, section 7.2.\r\n  * http://www.rfc-editor.org/rfc/rfc6125.txt\r\n"},{"title":"WA-X TEMPLATE","category":"Web Application","contents":"WA-X TEMPLATE\r\n=============\r\n\r\nDescription\r\n-----------\r\n\r\n\r\nReproduction Details\r\n--------------------\r\n\r\n\r\nSystems Affected\r\n----------------\r\nThe following ***application(s) / host(s) is/are*** affected by this issue:\r\n  * ***SITE***\r\n\r\nSeverity\r\n--------\r\nInfo – \r\n\r\n\r\nRecommendation\r\n--------------\r\n\r\n\r\n"},{"title":"WA-X Access Control Issues","category":"Web Application","contents":"WA-X Access Control Issues\n==========================\n\nDescription\n-----------\nThe access control systems present in the application were found to behave inappropriately in a number of identified instances. ***OPTIONAL: Although the access control logic was not visible to Lateral Security during testing, intended access control boundaries have been inferred based on the user interface presented.***\n\n***OPTIONAL: Given the significant number of access control issues identified during this review, the access control subsystem is considered broken.***\n\nSpecific instances of broken access control which were identified include:\n\n * ***FILL ME IN***\n\n***OPTIONAL: The breadth of application bypass issues suggests that secure development practices are not being adhered to in the development of the application codebase. Considerations for access control logic are a fundamental part of the design of a secure system, as they are complex and error prone to apply to an existing system.***\n\nReproduction Details\n--------------------\n* ***FILL ME IN***\n\nSystems Affected\n----------------\nThe following ***host is/hosts are*** affected by this issue:\n  * ***SITE***\n\nSeverity\n--------\nMedium/Critical – ***OPTIONAL: Given the systemic nature of this issue, it presents an unquantifiable threat due to the likelihood of further unknown vulnerabilities of unknown impact.***\n\nRecommendation\n--------------\n***OPTIONAL Client should liaise with their developers to....*** Conduct a thorough internal review of the application’s access control. Lateral Security recommends designing an authorisation matrix to document each piece of application functionality:\n\n * What the functionality is (***EXAMPLE***)\n * Details of any role-based access restrictions applied (***EXAMPLE***)\n * Details of any user-based access restrictions applied (can the resource being acted on be modified only by its owner? If not, which elements can be accessed by non-owners? Who can read/write?)\n * Details of which resource properties can be read/written to (should the user be able to modify resource metadata?)\n\nAfter working through this documentation, for each of these noted categories the review needs to consider:\n * What technical controls do we have in place to enforce this expectation?\n * How do we know they are working?\n\nThe access control system should be well structured, modular and centralised rather than implemented via ad-hoc checks on each piece of functionality.\nWhen there is confidence that the intended policy is being enforced by robust technical controls, the noted issues should be retested.\nThe documentation detailed above should be provided to testers to ensure thorough testing of the intended restrictions, as well as to ensure that the documented functionality covers all application routes and features.\n"},{"title":"WA-X Administrative Interface Accessible","category":"Web Application","contents":"WA-X Administrative Interface Accessible\r\n========================================\r\n\r\nDescription\r\n-----------\r\nAdministrative interfaces or login pages were found to be exposed to the Internet. To limit the attack surface of the system, it is good practice to ensure that only the functionality which is required during normal operation is accessible. Administrative content is typically only utilised by a small subset of users and as such should not be exposed publicly where avoidable.\r\n\r\nThe administrative content was available at the following URL:\r\n  * ***URL***\r\n\r\nReproduction Details\r\n--------------------\r\nTo reproduce this issue, browse to the URL noted in the description section.\r\n\r\nSystems Affected\r\n----------------\r\nThe following ***host is/hosts are*** affected by this issue:\r\n  * ***SITE***\r\n\r\nSeverity\r\n--------\r\nMedium – The exposure of administrative functionality provides a greater attack surface than strictly necessary for the functioning of the application. This could allow an attacker to attempt to identify vulnerabilities within systems governing authentication to the administrative content or within the administrative functionality itself. Without an authentication bypass vulnerability, it is pertinent to note that this typically requires an attacker to guess, intercept or otherwise obtain the credentials to gain administrative access to the site.\r\n\r\nRecommendation\r\n--------------\r\nLateral Security recommends that access to administrative content be limited using robust network controls such as IP whitelisting to a predefined whitelist of source IP addresses or TLS client authentication. Additionally, placing the administrative interface on a different subdomain from the main web site, with appropriately scoped session cookies, should be considered.\r\n\r\nTwo-factor authentication should be strongly considered as an additional control which would significantly limit the impact of credentials becoming compromised.\r\n"},{"title":"WA-X Arbitrary Textual Content Embedding","category":"Web Application","contents":"WA-X Arbitrary Textual Content Embedding\r\n========================================\r\n\r\nDescription\r\n-----------\r\nDuring testing it was identified that the web application allows embedding of arbitrary text into the web page. This could be done via a user-manipulated POST parameter when an error is shown. The following illustration demonstrates the phrase “Lateral Security” passed as an error text parameter which resulted in it being displayed:\r\n\r\n***SCREENSHOT***\r\n\r\nReproduction Details\r\n--------------------\r\nTo reproduce this issue, while browsing the application using an intercepting proxy such as Burp Suite:\r\n  * ***FILL ME IN***\r\n\r\nSystems Affected\r\n----------------\r\nThe following ***host is/hosts are*** affected by this issue:\r\n  * ***SITE***\r\n\r\nSeverity\r\n--------\r\nInfo – This issue does not directly lead to any security vulnerabilities. The most significant impact of the issue is reputational damage should an attacker embed questionable or obscene content into the web site via a specially crafted link and trick a victim into visiting it. Also, this issue might be used as an aid in sophisticated phishing attacks. \r\n\r\nRecommendation\r\n--------------\r\nEnsure that the web application does not allow users to manipulate the content of the web site via client-side parameters. One of the ways to mitigate this issue is to build an exhaustive list of pre-defined text messages and refer to them via an ID specified client-side.\r\n"},{"title":"WA-X Authentication and Password Management Issues","category":"Web Application","contents":"WA-X Authentication and Password Management Issues\n==================================================\n\nDescription\n-----------\nDuring testing Lateral Security identified a number of issues with the authentication and password management subsystems of the web application. These are as follows:\n  * Passwords for local users are stored in an insecure manner. It appears that passwords are stored in the form of ‘unsalted’ MD5 hashes. This means that hashes for weak passwords could be effectively reversed using rainbow tables. Additionally, MD5 itself is no longer considered a secure hash function. Therefore a determined attacker could try to leverage weaknesses in the hashing algorithm to find collisions. \n  * No password complexity policy is in place. The system allows users to select weak passwords, such as ‘1’. This increases the likelihood of user acount compromise. \n  * Changing email address does not require a password. The web application does not require any additional authentication when a user changes their email address. This could allow an attacker to completely hijack an account in case they have temporary access to the victim’s session (e.g., through a cross-site scripting vulnerability or using physical access to the victim’s session).  \n  * No brute-force protection on the login form. Lateral Security tried to log in repeatedly using wrong passwords and a subsequent login for the same user with correct credentials was still possible. This means that an attacker could effectively run brute-force attacks against the users of the web application. \n  * Email address enumeration on password reset. This issue is due to the fact that the web application responds differently when a user enters registered and unregistered email addresses in the password reset form. An attacker could use this information to determine valid users of the web application and try to run other attacks against them.\n  * The password reset functionality sends a user a new password rather than a password reset token and does not require the user to set a new password after the first logon. This extends the period during which an attacker could access the account if they managed to intercept the email.\n  * The password reset functionality is susceptible to user enumeration. When a user inputs a non-existent username or email, the following error message appears: Sorry, <username> is not recognized as a user name or an e-mail address.\n\nReproduction Details\n--------------------\nTo reproduce this issue, while browsing the application using an intercepting proxy such as Burp Suite:\n  * ***FILL ME IN***\n\nSystems Affected\n----------------\nThe following ***host is/hosts are*** affected by this issue:\n  * ***SITE***\n\nSeverity\n--------\nHigh – Each issue described above would normally have a medium severity rating (except for the insecure password storage), however, in conjunction, they represent a higher risk. An attacker could obtain valid users’ emails and further leverage the lack of brute force protection and absence of password complexity policy to obtain unauthorised access to user accounts. It is very likely that the same issues will be applicable to the staff interface, as described in the EX-4 Superfluous Functionality Available issue, however this has not been tested. The fact that the ‘LogonUsers’ table contains credentials that apparently cannot be used from an external perspective, somewhat alleviates the risk associated with the issue.\nSecurity implications of each individual weakness have been outlined in the description section.\nAn attacker could leverage the current weak state of authentication and password security controls implemented in the web application to obtain unauthorised access to it. As high privileged users use the same authentication mechanism, this increases the potential impact of the weaknesses.\n\nRecommendation\n--------------\nLateral Security recommends the following steps which will help improve the security of the authentication and password management subsystems of the web application:\n\nEnsure that passwords are stored securely in the database for all the users. Follow the recommendations outlined at the following link:\n  * https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html\n\nEnforce a strict password complexity policy. General recommendation is that a password should be at least 8 characters long, contain at least 3 different groups of characters. Checking whether a password contains an easily guessable dictionary word or looking the proposed password up in publicly available password lists would be beneficial. Stricter password complexity policy should be applied to staff and administrative users of the system. All administrative passwords should be changed upon going live. Refer to the following article for further details:\n  * https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html\n\nTo prevent brute-forcing attempts it is recommended that after a small number of incorrect password guesses (no more than 10) the account becomes locked out for a short period of time (for example, 30 seconds). This lockout time should then gradually increase for each subsequent incorrect logon attempt. Alternatively, using a strong CAPTCHA could be used in this situation. For more details see the following URL:\n  * https://owasp.org/www-community/controls/Blocking_Brute_Force_Attacks\n\nThe password reset should behave in an identical way regardless of whether the user performing the password reset has entered a valid or invalid email address. A throttling mechanism to slow repeated user attempts at using the password reset functionality could also limit the scope of an attack using this functionality, as described above.\n * https://cheatsheetseries.owasp.org/cheatsheets/Forgot_Password_Cheat_Sheet.html\n\nIn case users are able to change their email addresses in production, it is recommended to ensure that a user is required to enter their password as a second form of authentication when changing their email address.\n\nLateral Security recommends the following actions which will help to mitigate the issues identified:\n * Ensure that an appropriate password complexity policy is applied throughout the whole web application, thus restricting users from creating weak passwords in any possible scenario.\n * Apply additional authentication for sensitive actions, such as password or email change, by requesting the old password.\n * Implement protection against brute-force attacks through using a CAPTCHA mechanism or enforce a gradually increasing timeout after which a subsequent logon attempt could be made after each unsuccessful attempt.\n * Make sure new passwords are not created automatically during the password reset procedure. Special tokens should be used instead, which would allow for a one-time changing of a password within a limited timeframe. Note that these tokens should be long and random enough to prevent guessing or enumeration.\n * Ensure that the web application does not reveal any redundant information during authentication or password reset. Reset password functionality should have a generic message such as “An email has been sent if the username exists within the system”.\n\nFor more information, please see the following link:\n * https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html\n"},{"title":"WA-X Change User Details without Existing Password","category":"Web Application","contents":"WA-X Change User Details without Existing Password\n====================================\n\nDescription\n-----------\nThe change password functionality does not require the user to enter their existing password before being able to set a new value.\nThis allows an attacker who has compromised a user’s session to update their password, maintaining persistent access and preventing the user from authenticating to the system in the future.\n\nAdditionally, the change email address functionality does not require the user’s current password.\nThis allows an attacker to change the registered email address, then leverage the \"forgot password” workflow to reset the user’s password.\n\nReproduction Details\n--------------------\nLogin and attempt to change the user’s email address or password, noting that the change occurs without requiring the user’s password.\n\nSystems Affected\n----------------\nThe following ***host is/hosts are*** affected by this issue:\n  * ***SITE***\n\nSeverity\n--------\nLow – If an attacker has compromised an active session, then they can change the user’s password and deny the victim future access to their account.\nThis allows the attacker to gain future access to the victim’s account.\n\nRecommendation\n--------------\nLateral Security recommends requiring users to re-enter their password when making changes to sensitive information, such as email address, phone number or password.\n"},{"title":"WA-X Cross Domain Script Include","category":"Web Application","contents":"WA-X Cross Domain Script Include\r\n================================\r\n\r\nDescription\r\n-----------\r\nDuring testing, Lateral Security identified that the web applications dynamically include the following script from an external domain:\r\n * ***https://-.s3.amazonaws.com/se.js***\r\n\r\nWhen an application includes a script from an external domain, this script is executed by the browser within the security context of the invoking application. The script can therefore do anything that the application’s own scripts can do, such as accessing application data and performing actions within the context of the current user.\r\n\r\nReproduction Details\r\n--------------------\r\nTo reproduce this issue, while browsing the application using an intercepting proxy such as Burp Suite:\r\n  * ***FILL ME IN***\r\n\r\nSystems Affected\r\n----------------\r\nThe following ***host is/hosts are*** affected by this issue:\r\n  * ***SITE***\r\n\r\nSeverity\r\n--------\r\nLow – If you include a script from an external domain, then you are trusting that domain with the data and functionality of your application, and you are trusting the domain's own security to prevent an attacker from modifying the script to perform malicious actions within your application. \r\n\r\nRecommendation\r\n--------------\r\nScripts should not be included from untrusted domains. If you have a requirement which a third-party script appears to fulfil, consider copying the contents of that script onto your own domain and including it from there. If that is not possible (e.g. for licensing reasons) then you should consider re-implementing the script's functionality within your own code.\r\n"},{"title":"WA-X No Cross-Site Request Forgery Protection","category":"Web Application","contents":"WA-X No Cross-Site Request Forgery Protection\n=============================================\n\nDescription\n-----------\nCross-Site Request Forgery (CSRF) attacks are where a third party site can embed a resource which triggers an action on the site. For example, if a bank were vulnerable to CSRF, an attacker could embed a 1x1 image on a popular forum with the source set to the following:\n * https://www.lateralsecurity.com/internetbanking/transfer?from=1&to=00-12-345678-9012345-000.\n\nWhen the users of the forum browse to that page, their browsers will attempt to load the image from the bank’s servers, and if they happened to be logged in to Internet banking at the time, their cookies will be sent with the request and the transaction would be processed, transparently transferring money to the attacker.\n\nWhile this simple example uses a GET request, it is possible to craft more complicated CSRF attacks using JavaScript to POST all of the required parameters to the server.\n\nIn this case ***DESCRIBE***\n\nReproduction Details\n------------\nTo reproduce this issue:\n  * ***REPRODUCTION STEPS***\n\nSystems Affected\n----------------\nThe following ***host is/hosts are*** affected by this issue:\n  * ***SITE***\n\nSeverity\n--------\nMedium – ***DESCRIBE THE APPLICATION SPECIFIC IMPACT***\n\nRecommendation\n--------------\nLateral Security recommends implementing a cross-site request forgery defence mechanism. Ideally, this would be implemented by a framework or well-tested library. This involves a token being generated by the application, supplied to the user and checked with each state-changing request. Further detail on implementing this control is provided by OWASP:\n* https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html\n\n*** Update this based on the cookie behaviour *** Lateral Security recommends setting the SameSite cookie flag to \"Strict\" wherever possible, ensuring that modern browsers will only send the cookie when requests originate from the same domain. For more information on the SameSite flag and the options available, see:\n  * https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite\n"},{"title":"WA-X Denial of Service","category":"Web Application","contents":"WA-X Denial of Service\n=============\n\nDescription\n-----------\nDenial of service is a weakness where an attacker can perform actions which impact the availability or performance of the targeted system.\n\nCommon attack vectors include:\n* Repetitively performing tasks which consume significant amounts of memory or processing power.\n* Causing applications to crash or transition into undetermined states.\n* Triggering security controls (designed to prevent attackers from accessing the system) against legitimate users.\n\nIn this case, ***COMPLETE***\n\nReproduction Details\n--------------------\nTo reproduce this issue, ***COMPLETE***\n\nSystems Affected\n----------------\nThe following ***application(s) / host(s) is/are*** affected by this issue:\n  * ***SITE***\n\nSeverity\n--------\nLow – Denial of service vulnerabilities prevent legitimate users from interacting with the affected systems.\nThis may lead to reputational damage for the organisation. ***Any context specific impacts***\n\nRecommendation\n--------------\nLateral Security recommends *** Context specific advice, probably \"fix the bug\" or \"apply logging\" (for internal systems) ***\n\n"},{"title":"WA-X Direct Object Reference","category":"Web Application","contents":"WA-X Direct Object Reference\n============================\n\nDescription\n-----------\nDirect object reference is an access control issue which arises when applications do not implement authorisation checks when accessing resources by a unique identifier.\nThese identifiers are typically implemented as sequential numbers (unique per resource type) or psuedo-random character strings (GUID/ UUID).\n\nFor example, if a user makes a purchase and is redirected to:\n* https://www.lateralsecurity.com/webshop/order/188\n\nChanging the order id from \"188\" to \"187\" may result in access of a previous order. This would be the intended behaviour if the same user had conducted both purchases; however, the user should not be able to view purchases belonging to other accounts through this mechanism.\n\nIn this case, *** UPDATE, also include whether it is read or read/write access ***\n\nReproduction Details\n--------------------\nTo reproduce this issue, while browsing the application using an intercepting proxy such as Burp Suite:\n  * ***FILL ME IN***\n\nSystems Affected\n----------------\nThe following ***host is/hosts are*** affected by this issue:\n  * ***SITE***\n\nSeverity\n--------\nMedium – *** Describe consequences, including business/contextual impact, whether it is a single case or systemic, etc  ***\n\nRecommendation\n--------------\n***OPTIONAL Client should liaise with their developers to....*** Conduct a thorough internal review of the application’s access control. Lateral Security recommends designing an authorisation matrix to document each piece of application functionality:\n\n * What the functionality is (***EXAMPLE***)\n * Details of any role-based access restrictions applied (***EXAMPLE***)\n * Details of any user-based access restrictions applied (can the resource being acted on be modified only by its owner? If not, which elements can be accessed by non-owners? Who can read/write?)\n * Details of which resource properties can be read/written to (should the user be able to modify resource metadata?)\n\nAfter working through this documentation, for each of these noted categories the review needs to consider:\n * What technical controls do we have in place to enforce this expectation?\n * How do we know they are working?\n\nThe access control system should be well structured, modular and centralised rather than implemented via ad-hoc checks on each piece of functionality.\nWhen there is confidence that the intended policy is being enforced by robust technical controls, the noted issues should be retested.\nThe documentation detailed above should be provided to testers to ensure thorough testing of the intended restrictions, as well as to ensure that the documented functionality covers all application routes and features.\n\nIt is noted that continuing to reference resources by their identifier will have minimal security impact when intended access controls are being enforced.\n\nFor further information regarding this type of vulnerability please see the following links:\n  * https://cheatsheetseries.owasp.org/cheatsheets/Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet.html\n"},{"title":"WA-X Emails Set to Untrusted Domains","category":"Web Application","contents":"WA-X Emails Set to Untrusted Domains\n=============\n\nDescription\n-----------\nThe tested environment includes references to email addresses on domains outside of the organisation's control.\nThese included:\n* example.com\n* ***COMPLETE LIST***\n\n\nReproduction Details\n--------------------\nTo view email addresses, ***TBC***\n\nSystems Affected\n----------------\nThe following ***application(s) / host(s) is/are*** affected by this issue:\n  * ***SITE***\n\nSeverity\n--------\nLow – This issue may result in emails being sent to untrusted parties. \nIt could also lead to unauthorised access of accounts should password reset workflows be used to gain access from the referenced addresses.\n\n\nRecommendation\n--------------\nLateral Security recommends the use of dedicated placeholder domains controlled by the organisation.\nThis can be managed various ways, such as using a different TLD (.com vs .net), using a testing domain (e.g. lateralsecurity-test.com), or using a testing subdomain (test.lateralsecurity.com).\n\nThis prevents the potential exposure of site resources to systems not owned/controlled by the organisation.\n\n"},{"title":"WA-X Email Template Injection","category":"Web Application","contents":"WA-X Email Template Injection\n=============\n\nDescription\n-----------\nEmail template injection is a lateral extension of HTML injection, in which user defined content is rendered as HTML within an email context.\nA common example of this is when user-specific emails are unsafely constructed to address users by name, e.g.\n```\nmessage = \"Hi <b>\" +***user.name*** +\"</b>, welcome to the application<hr>\";\nsend_email(user.email, message);\n```\nWhere users could specify arbitrary HTML content within the \"user.name\" value which would be rendered in the recipient's email client.\n\nThis may also lead to cross-site scripting vulnerabilities in cases where emails are rendered directly in a browser.\nMost email clients defend against this; however, direct email previews within the application (where applicable) may not apply these controls.\n\n\nReproduction Details\n--------------------\n***Context specific reproduction***\n\n\nSystems Affected\n----------------\nThe following ***application(s) / host(s) is/are*** affected by this issue:\n  * ***SITE***\n\nSeverity\n--------\nLow – This weakness allows an attacker to send arbitrary emails from the application to targeted users.\nCrafted content can be used to visually hide the entire email body, except for the attacker select message.\nThis can be leveraged in social engineering attacks; however, does not directly impact the server itself.\n\nRecommendation\n--------------\nLateral Security recommends the use of HTML-aware templating libraries when operating with HTML data (both emails and web content).\nEither refactoring existing email generation to use HTML templating, or explicitly escaping user parameters if this is not feasible."},{"title":"WA-X File Path Injection","category":"Web Application","contents":"WA-X File Path Injection\r\n========================\r\n\r\nDescription\r\n-----------\r\nFile path injection allows an attacker or malicious user to provide arbitrary filenames for files that are being uploaded that are interpreted by the server or service as file paths. This then leads to the files that are uploaded to the server being saved to locations outside of the intended path.\r\n\r\n***During testing, multiple file upload points were identified where the user can supply a file path as part of the filename so that files are uploaded to arbitrary locations on the server, including outside of the webroot. This issue was successfully exploited to write files into the c:\\temp\\ and c:\\windows\\temp\\ folders.***\r\n\r\nReproduction Details\r\n--------------------\r\nTo reproduce this issue, while browsing the application using an intercepting proxy such as Burp Suite:\r\n  * ***FILL ME IN***\r\n\r\nSystems Affected\r\n----------------\r\nThe following ***host is/hosts are*** affected by this issue:\r\n  * ***SITE***\r\n\r\nSeverity\r\n--------\r\nHigh – An attacker or malicious user that can upload files to the server can exploit this vulnerability to place files on the server in locations that they should not be permitted to write to. This could be use by an attacker to stage malicious files onto the server as part of a broader attack or overwrite sensitive files or operating system components.\r\n\r\nRecommendation\r\n--------------\r\nEnsure that file upload mechanisms sanitise all user provided information to ensure that the malicious components of the file name are removed or escaped. Ensure that the web server user has a limited permission set to ensure that even if a successful file path escape is carried out, files cannot be written outside of their intended destination.\r\n\r\nAlternatively files can be assigned an ID along with the filename stored in the database and then all interaction with the file on disk via that reference ID rather than the filename itself.\r\n"},{"title":"WA-X File Upload Issues","category":"Web Application","contents":"WA-X File Upload Issues\r\n=======================\r\n\r\nDescription\r\n-----------\r\nThe web application supports uploading of files ***as attachments to Notices***. Lateral Security identified several security issues around this functionality. These are as follows:\r\n * The web application does not properly check for the file type of the uploaded file. More specifically, this type of checking is performed client-side, which means that it can be trivially bypassed. A malicious user could upload an arbitrary file to the web server, including executables, which could be further downloaded by other users: ***TEST***\r\n * Files are stored within the asset directory of the web server and could be accessed directly by any unauthenticated user. Dynamic content stored on the web server introduces a number of attack vectors towards these users, which may include but is not limited to running arbitrary JavaScript in the security context of the victim’s session. Consider the following HTML file to be uploaded as an attachment: <html><body><script>alert(\"Lateral Security XSS\");</script></body></html> If accessed directly by the victim, the JavaScript payload will be executed in their browser. For more detail on this type of attack refer to ***XSS ISSUE?*** Uploaded files are accessible without authentication. This may lead to sensitive data disclosure.\r\n\r\nReproduction Details\r\n--------------------\r\nTo reproduce this issue, while browsing the application using an intercepting proxy such as Burp Suite:\r\n  * ***FILL ME IN***\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SITE***\r\n\r\nSeverity\r\n--------\r\nMedium – An attacker could leverage the issues described above to attack other users, both authenticated and unauthenticated. Having no robust file type validation could lead to the web server being used in targeted attacks against specific users of the application or as a server for hosting custom malware or objectionable content in more widespread attacks. This could cause reputational damage to ***CLIENT*** if exploited.\r\n\r\nAdditionally, these issues create a risk of ***IMPACT IF XSS EXPLOITED***\r\n\r\n***It should be pointed out that attempts to upload and execute a PHP shell were not successful during the engagement, due to the protections afforded by the framework and the web server utilised, as well as protection against path traversal attacks implemented in the web application.***\r\n\r\nRecommendation\r\n--------------\r\nLateral Security recommends that ***CLIENT*** implement robust server-side file type validation throughout the whole web application, where file upload is possible. More specifically, the web application should accept only allowed file extensions and perform deeper file content validation for file types which can handle dynamic content, such as HTML.\r\n\r\nUploaded files should not be directly accessed via URLs. They should be served by the web application itself while being referenced using a pseudo-random GUID.\r\n\r\nLastly, robust authentication and authorisation checks for unpublished files should be implemented as described in ***ISSUE***.\r\n\r\nFor further information regarding this type of vulnerability please refer to the following link:\r\n * https://owasp.org/www-community/vulnerabilities/Unrestricted_File_Upload\r\n"},{"title":"WA-X Host Header Injection (Password Reset)","category":"Web Application","contents":"WA-X Host Header Injection (Password Reset)\n==========================\n\nDescription\n-----------\nHost header injection is a content reflection vulnerability where attacker supplied HTTP \"Host\" header values are processed by the server in an unsafe manner.\nThis behaviour is often the consequence of services using introspection to determine their hosted domain name, rather than explicitly defining the value within configuration.\n\nIn this case, the password reset workflow was found to generate links (containing secret tokens) directed to the supplied host header rather than the server's actual domain name. \nIf an attacker attempts to reset the password of another user (while supplying a host header directed to a malicious domain), the victim will receive a reset link to the attacker's domain containing the user's reset secret. This secret will be exposed when the link is clicked, allowing the attacker to compromise access to the targeted user's account.\n\n\nReproduction Details\n--------------------\n***Change these instructions if the payload is triggered from a different header (e.g. X-Forwarded-Host header)***\nTo reproduce this issue, browse the application using an intercepting proxy such as Burp Suite:\n  * Follow the password reset workflow (for an authorised testing account), intercepting the final request that performs the reset.\n  * Modify the \"Host\" header on the request to an attacker-controlled value (e.g. lateralsecurity.com)\n  * Review the received email, noting the reset link supplied is directed to \"lateralsecurity.com\" rather than the original website.\n  * Click the link, confirming that the secret is sent to lateralsecurity.com.\n\nSystems Affected\n----------------\nThe following ***host is/hosts are*** affected by this issue:\n  * ***SITE***\n\nSeverity\n--------\nMedium – An attacker can gain unauthorised access to targeted accounts, in cases where: \n * The attacker knows the victim's username / email address.\n * The victim clicks an unsolicited password reset link.\n\nRecommendation\n--------------\nLateral Security recommends the use of per-environment configuration files to strictly define the hostname to be used in generated emails.\nThis control also allows for multi-domain solutions (account.*, api.*, etc) to trigger cross-domain actions.\n"},{"title":"WA-X Host Header Injection (Cache Poisoning)","category":"Web Application","contents":"WA-X Host Header Injection (Cache Poisoning)\n==========================\n\nDescription\n-----------\nHost header injection is a content reflection vulnerability where attacker supplied HTTP \"Host\" header values are processed by the server in an unsafe manner.\nThis behaviour is often the consequence of services using introspection to determine their hosted domain name, rather than explicitly defining the value within configuration.\n\n*** This is quite specific, ensure it is valid in this case***\nIn this case, the host header is reflected directly into the page. \nThis appears to be used by the application to provides absolute paths for linked content (CSS, JavaScript, etc).\n\nAn attacker can send crafted requests to the server, resulting in JavaScript (and other) content being retrieved from untrusted domains.\nWhile this attack has a limited impact in isolation, it can result in arbitrary JavaScript execution (cross-site scripting) in instances where caching middleware stores the tampered values.\n\nReproduction Details\n--------------------\n***Change these instructions if the payload is triggered from a different header (e.g. X-Forwarded-Host header)***\nTo reproduce this issue, browse the application using an intercepting proxy such as Burp Suite:\n  * Intercept an original request to the portal (e.g. /{GUID}.html), modifying the host header to an attacker controlled domain in transit.\n  * Observe that the modified value is returned in the server's response.\n  * Attempt to retrieve the requested resource again, using the real hostname (untampered).\n  * Observe that the modified value is still returned (not the real hostname).\n\nSystems Affected\n----------------\nThe following ***host is/hosts are*** affected by this issue:\n  * ***SITE***\n\nSeverity\n--------\nMedium – An attacker can poison the application's content cache. This allows an attacker to preload cross-site scripting attacks which are later triggered by visiting the infected URL.\n\nRecommendation\n--------------\nLateral Security recommends the use relative URLs for fetching application content. \nIn cases where this is not possible, per-environment configuration files should be considered to explicitly define the domain that content should be retrieved from."},{"title":"WA-X Information Disclosure","category":"Web Application","contents":"WA-X Information Disclosure\r\n===========================\r\n\r\nDescription\r\n-----------\r\nLateral Security identified several information disclosure issues with the web servers. The information disclosed assists in understanding the application environment and software.\r\n\r\nInformation revealed includes the following:\r\n  * ***Server: Apache/1.2***\r\n  * ***Fill me in***\r\n\r\nReproduction Details\r\n--------------------\r\nTo reproduce this issue, while browsing the application using an intercepting proxy such as Burp Suite:\r\n  * ***FILL ME IN***\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SITE***\r\n\r\nSeverity\r\n--------\r\nInfo – The information revealed does not define the exact version of the technologies in use, so this data is of somewhat limited value to an attacker.\r\n\r\n***If the information does identify versions and this leads to identification of vulnerabilities, increase the severity.***\r\n\r\nAn attacker may use this information to further plan more sophisticated attacks or identify the potential exploitability of vulnerabilities which are known to the attacker.\r\n\r\nRecommendation\r\n--------------\r\nEnsure that the web server and its software components are configured to remove or restrict disclosing any system and version information as well as any verbose error information.\r\nAny unused functionality and resources should be completely removed from the web server. Ensure that strict access rules apply to the functionality or resources that must be in\r\nplace, in order to prevent unauthorised access to it. Manually review all contents of the published web root to ensure only necessary files exist and accessible.\r\n\r\n***More information about configuring this in IIS can be found at:***\r\n"},{"title":"WA-X Insecure CORS Settings","category":"Web Application","contents":"WA-X Insecure CORS Settings\r\n===========================\r\n\r\nDescription\r\n-----------\r\nCross Origin Resource Sharing (CORS) is a mechanism that allows a web application to accept and execute web requests that originated from another domain. Such \"cross-domain\" requests would otherwise be forbidden by web browsers, according to the same origin policy. CORS defines a way in which the browser and the server can interact to determine whether or not to allow the cross-origin request.\r\n\r\n***Lateral Security found that the web application allows for requests originating from any domain. Moreover, two-way interaction was also found to be enabled. This might lead to unauthorised access to sensitive data.***\r\n\r\nReproduction Details\r\n--------------------\r\nTo reproduce this issue, while browsing the application using an intercepting proxy such as Burp Suite:\r\n  * ***FILL ME IN***\r\n\r\nSystems Affected\r\n----------------\r\nThe following ***host is/hosts are*** affected by this issue:\r\n  * ***SITE***\r\n\r\nSeverity\r\n--------\r\nLow – An attacker may obtain valuable information or perform malicious actions in the application by triggering crafted HTTP requests from another domain.\r\n\r\n***As the web application currently does not use cookies to store and manage sensitive information on the client-side, this issue is raised with low severity rating. Authorisation tokens which are transmitted in the headers of HTTP requests to the API will not be automatically added in this scenario. In case further functionality that utilises cookies is added to the application in the future, this may lead to a serious data leakage. Note that Access-Control-Allow-Credentials is not supported when the Allow-Origin header is set to a wildcard. This prevents the browser from automatically attaching cookies to the request, partially mitigating the impact of this issue.***\r\n\r\nRecommendation\r\n--------------\r\n***Client*** should investigate where in the web application the cross-origin resource sharing policy is utilised. The cross-origin request policy should limit the web application to accept only requests originating from a restricted range of domain names. Moreover, ensure that access controls are in place throughout the web application in order to limit remote access only to the functionality that should accept such requests during normal operation. \r\n\r\nFor more information, see the following links:\r\n * https://cheatsheetseries.owasp.org/cheatsheets/HTML5_Security_Cheat_Sheet.html\r\n * https://owasp.org/www-community/attacks/CORS_OriginHeaderScrutiny\r\n"},{"title":"WA-X IP Whitelisting Bypass","category":"Web Application","contents":"WA-X IP Whitelisting Bypass\n=============\n\nDescription\n-----------\nIP Whitelisting is a security control used to restrict resource access based on the user's originating IP address.\nThis is typically used to prevent users from untrusted locations from accessing a site, or specific resources on a site.\n\nThis could be bypassed by ***XXX***\n\n\nReproduction Details\n--------------------\nNavigate to the site using an intercepting proxy, such as Burp, OWASP ZAP, or Fiddler. Intercept the outgoing requests and add a new HTTP header of:\n```\nX-FORWARDED-FOR: ***{IP}***\n```\nNote that the resources which were previously inaccessible are now returned by the server.\n\ne.g. ***EXAMPLE URL***.\n\nSystems Affected\n----------------\nThe following ***application(s) / host(s) is/are*** affected by this issue:\n  * ***SITE***\n\nSeverity\n--------\nLow – This issue highlights the bypass of an intended security control. Users from untrusted locations can access protected resources on the server.\n\n\nRecommendation\n--------------\nLateral Security recommends checking IPs against the originating IP, and not the IP presented within the headers.\nIt is noted that this may have functional impacts if the site is genuinely being accessed via a proxy.\n\nSome cloud providers may offer untampered headers containing the user's real IP; however, the presence of this could not be determined during testing.\n\nAn alternative mitigation would be to use mutual certificate authentication to identify trusted hosts rather than trusted locations.\n```\nInformation about this negotiation can be found at: https://en.wikipedia.org/wiki/Transport_Layer_Security#Client-authenticated_TLS_handshake.\n```\n"},{"title":"WA-X Local File Inclusion","category":"Web Application","contents":"WA-X Local File Inclusion\n=============\n\nDescription\n-----------\nLocal file inclusion (LFI) is a vulnerability in which an attacker can read arbitrary files from within the webserver.\nThis is often caused by absolute pathing or relative directory traversal weaknesses, where files outside of a trusted root folder can be accessed.\n\nIn this case, ***TBC***\n\n\nReproduction Details\n--------------------\nTo download a targeted file:\n* Log in to the web application\n* Visit the following URL to retrieve the ***TBC*** file\n``` EXAMPLE URL ```\n\n\nSystems Affected\n----------------\nThe following ***application(s) / host(s) is/are*** affected by this issue:\n  * ***SITE***\n\nSeverity\n--------\nHigh – Attackers can read arbitrary files from the web application's filesystem. \nThis typically includes application secrets, keys, and service credentials.\nOnce compromised, these values can often be leveraged gain greater access to the host or for targeting additional systems.\n\n\nRecommendation\n--------------\nLateral Security recommends ***CONTEXT SPECIFIC ADVICE; don't allow file read, allow-list expected files, or reject requests containing unexpected characters***\n\n"},{"title":"WA-X Mass Assignment Vulnerability","category":"Web Application","contents":"WA-X Mass Assignment Vulnerability\n=============\n\nDescription\n-----------\nMass Assignment (Autobinding) is an access control weakness where malicious users can provide additional fields on object create/update actions, setting attributes beyond that of the application's intended permission model.\n\nThis vulnerability is often introduced by application frameworks providing both automatic parameter-to-object mapping (deserialisation), and object-to-database mappings (ORM). \nWith these features combined, an attacker can supply malicious parameters which are loaded into templated objects and persisted to the database.\n\n\n*** In this particular case ***\n\n\nReproduction Details\n--------------------\nNavigate the site using an intercepting proxy; e.g. BurpSuite, OWASP ZAP, Fiddler.\n* Authenticate to the portal.\n* Attempt to *** Affected functionality ***, intercepting the request.\n* Modify the payload to add *** Affected parameter ***\n* Observe that *** Change/verification ***\n\n\nSystems Affected\n----------------\nThe following ***application(s) / host(s) is/are*** affected by this issue:\n  * ***SITE***\n\nSeverity\n--------\nHigh – An attacker can craft malicious requests to ***Impact***\nUndermining the expected security controls of the application.\n\n\nRecommendation\n--------------\nLateral Security recommends restricting user supplied data using an allow list of expected content.\nThis can be achieved through either input data restriction or validation.\n\nPlatform specific details can be found at:\n```\nhttps://cheatsheetseries.owasp.org/cheatsheets/Mass_Assignment_Cheat_Sheet.html\n```\n"},{"title":"WA-X Missing Data Validation","category":"Web Application","contents":"WA-X Missing Data Validation\n=============\n\nDescription\n-----------\nData validation is a verification and quality control which restricts user supplied content to only values which are applicable for the context-specific use case. \nFor example, it is unlikely that a person’s date-of-birth is in the future, or that their name contains punctuation characters.\n\n\nReproduction Details\n--------------------\nReview datatypes accepted by the application, testing against expected constraints. \n***No form of validation (other than “not empty”) was observed within the solution.***\n\n\nSystems Affected\n----------------\nThe following ***application(s) / host(s) is/are*** affected by this issue:\n  * ***SITE***\n\nSeverity\n--------\nInfo – Data validation help protect against user error, ensuring that supplied data is appropriate for its use case. \nInvalid data may lead to processing mistakes or reputational impacts.\n\n\nRecommendation\n--------------\nLateral Security recommends applying data validation across all input fields to prevent the entry of invalid records. \nExample content classes to consider include:\n*\tDates\n*\tNumbers\n*\tAlphanumeric data\n*\tPredefined format fields (external identifiers, etc)\n*\tArbitrary text\n"},{"title":"WA-X Missing Multifactor Authentication","category":"Web Application","contents":"WA-X Missing Multifactor Authentication\n=============\n\nDescription\n-----------\nMultifactor authentication (MFA) is security control which prevents the compromise of credentials directly \nresulting in the compromise of user accounts. \nThis is commonly achieved by requiring the user to supply static data (username, password) with dynamic data (HOTP/TOTP token) to prevent \nreplay attacks and provide additional verification of the user’s identity.\n\n\nReproduction Details\n--------------------\nLog in to the portal, noting that Multifactor controls are not enforced.\n\n\nSystems Affected\n----------------\nThe following ***application(s) / host(s) is/are*** affected by this issue:\n  * ***SITE***\n\nSeverity\n--------\nLow – Multifactor Authentication is an effective security control against the use of compromised accounts details to access protected resources. \n*** PROVIDE IMPACT EXAMPLES FOR THE SPECIFIC CONTEXT***\n\nRecommendation\n--------------\nLateral Security recommends ***enforcing/supporting***  Multifactor Authentication controls for ***all/administrative*** accounts.\n\n"},{"title":"WA-X Mixed Templating Frameworks","category":"Web Application","contents":"WA-X Mixed Templating Frameworks\n=============\n\nDescription\n-----------\nThe application is using multiple templating languages to generate dynamic HTML content. These included:\n* ***List observed templating mechanism ***\n\nThis pattern often leads to double processing vulnerabilities where user content is safely included in one context only to be reinterpreted and executed by the secondary processing. Common impacts include cross-site scripting (XSS) or content reflection weaknesses.\n\n\nReproduction Details\n--------------------\nAccess the application noting:\n* ***List rendering mechanisms and examples of where they are being used.***\n\n\nSystems Affected\n----------------\nThe following ***application(s) / host(s) is/are*** affected by this issue:\n  * ***SITE***\n\nSeverity\n--------\nMedium – ***Tweak depending on impact*** This design pattern often leads to cross-site scripting vulnerabilities.\nIn this case ***TBC***\n\n\nRecommendation\n--------------\nLateral Security recommends selecting one HTML templating mechanism, refactoring the solution to use only this rendering control.\n\n"},{"title":"WA-X .NET Padding Oracle","category":"Web Application","contents":"WA-X .NET Padding Oracle\n========================\n\nDescription\n-----------\nThe application demonstrates behaviour consistent with vulnerability to a padding oracle attack which could allow an attacker to read arbitrary files from the web server. This is a known vulnerability within old versions of .NET (MS10-070). When it appears in modern web applications it is commonly a result of a legacy encryption mode configuration or a false positive. This should be investigated internally to ensure that the vulnerable behaviour is not present.\n\nPadding Oracle attacks are created when a web application utilises the end-user as a courier for a sensitive message which is in encrypted form. The goal of encryption is generally to ensure that the message cannot be decrypted and that verification of the message is conducted to detect manipulation.\n\nWhere no validation is conducted prior to decryption of the encrypted parts, it is possible for an attacker to modify the ciphertexts and observe changes. Information may be inferred through a process of modifying the ciphertext, relaying it to the application and observing the result.\n\nThe Padding Oracle attack requires the ability to determine state, specifically:\n * Was the encrypted message successfully decrypted, but invalid?\n * Was the encrypted message unsuccessfully decrypted?\n\nWith the ability to determine these states, if CBC is in use with PKCS #7 padding, it is possible to decrypt and modify encrypted data.\n\nCommonly, error messages are used to determine the above state. Some general recommendations state that by sharing (identically and byte-for-byte) a common error message, then the attack would be prevented. However, the following should be considered:\n * Gaining visibility of parsing the message in any form, possibly via another channel, could provide a suitable oracle.\n * Timing attacks can potentially be used to determine state. This is particularly true when the encrypted blocks are repeated for effect.\n\nReproduction Details\n--------------------\nTo reproduce this issue, while browsing the application using an intercepting proxy such as Burp Suite:\n  * ***FILL ME IN***\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SITE***\n\nSeverity\n--------\nHigh – A successful padding oracle attack would allow an attacker to read encrypted message content and potentially modify the original plaintext. The ASP.NET interfaces “WebResource.axd” and “ScriptResource.axd” accept an encrypted filename and retrieve this file. Manipulation of this encrypted filename could allow an attacker unauthorised read access to the file server.\n\nOn average 128 requests would be required for a single byte of decrypted data. Tools such as “padbuster.pl” are simplistic and largely used for proof-of-concept purposes, but may be suitable for the identified potentially vulnerable functionality.\n\nRecommendation\n--------------\nA patch for MS10-070 is available from Microsoft. This patch resolves the vulnerability by adding an HMAC to the encrypted message to prevent tampering.\n\n***Consider adding the following if the app is not legacy: Given that the vulnerability is from 2010, it is likely that this behaviour is either caused by legacy encryption mode being enabled or is a false positive.***\n"},{"title":"WA-X No Account Lockout","category":"Web Application","contents":"WA-X No Account Lockout\r\n=======================\r\n\r\nDescription\r\n-----------\r\nAfter attempting to log into the application with an incorrect password a large number of times, it was identified there is no account lockout implemented on the login screen. This means if a valid user name is obtained (which are not considered secret) a malicious user can attempt to brute force a password. In the current state, hundreds of passwords can be attempted per minute.\r\n\r\nFor perspective, based on unrelated password databases leaked to the Internet the top 10,000 passwords represent 99.8% of user passwords. This means an account’s password can likely be brute forced in little time, even if variations of the passwords are tried (inserting capital letters, substituting letters for numbers, etc).\r\n\r\nReproduction Details\r\n--------------------\r\nTo reproduce this issue attempt to log in to the application with an invalid password over twenty times. Observe the account is not locked out.\r\n\r\nSystems Affected\r\n----------------\r\nThe following ***host is/hosts are** affected by this issue:\r\n  * ***SITE***\r\n\r\nSeverity\r\n--------\r\nMedium – ***DESCRIBE THE BUSINESS IMPACT OF ACCOUNTS BEING COMPROMISED***\r\n\r\nRecommendation\r\n--------------\r\nLateral Security recommends an account lockout is implemented on the login screen. In order to prevent denial of service attacks, the account should automatically unlock after a fixed period of time and as further incorrect password attempts are made, the account lockout time should increase.\r\n"},{"title":"WA-X No Malware Scanning","category":"Web Application","contents":"WA-X No Malware Scanning\n========================\n\nDescription\n-----------\nUp-to-date Antivirus software is listed within the ASD Top Mitigations strategies for malware delivery and execution prevention.\nThere appears to be no virus checking on files uploaded through the site, as Lateral Security was able to upload a document containing the Eicar test virus which was then accepted by the system.\n\nReproduction Details\n--------------------\nTo reproduce this issue:\n  * Create an EICAR test file, following the instructions at: https://www.eicar.org/?page_id=3950\n  * Upload the file to the server using the ***WORKFLOW***\n  * Observe that the file was not detected or removed as malware\n  * ***ETC***\n\nSystems Affected\n----------------\nThe following ***host is/hosts are*** affected by this issue:\n\nSeverity\n--------\nMedium – A lack of antivirus scanning allows attackers to upload known malware files to the server, encouraging other users to download and run the malicious code on their own computer. This may lead to technical impact for users of the system and reputational damage to the organisation.\nIf the file is targeted at internal staff, then the attacker may be able to gain access to internal resources using this weakness.\nAttackers may also upload malicious files to the server to link to from other sites, using the organisation's server as a malware delivery platform against third parties.\n\nRecommendation\n--------------\nEnsure some form of virus scanning is performed as part of the file upload process. Anti-virus software must be up-to-date and running current virus definitions. If the vendor is not able to invoke anti-virus software as part of the file upload process and the files are not stored in the database, then the server itself should run host based Anti-Virus to remove the malicious files.\n"},{"title":"WA-X Open Redirection","category":"Web Application","contents":"WA-X Open Redirection\r\n==================\r\n\r\nDescription\r\n-----------\r\nA common design pattern in web applications, particularly during login and logout, is to record as a URL parameter the location the user will be redirected to once the requested action is complete. \r\n\r\nThis can be particularly useful if a user requests a protected resource while unauthenticated to ensure a smooth transition to this resource after login.\r\n\r\nThis typically takes a form similar to the following:\r\n```\r\nhttps://www.example.com/login?RedirectURL=/authenticated-component\r\n```\r\nThis design pattern is often implemented in a way which introduces vulnerabilities into the application.\r\n\r\nOne issue which can occur is that redirection URL is not properly validated. If this is the case, an attacker can craft a URL which appears to specify a resource on a trusted site, but actually redirects the user to a phishing site or other malicious content.\r\n\r\nFor example, consider a user navigating to the following URL:\r\n```\r\nhttps://www.example.com/login?RedirectURL=https://www.lateralsecurity.com\r\n```\r\n\r\nThis subversion of user expectations can allow attackers to target even those users who have some sense of how to check whether a URL they are supplied with is legitimate.\r\n\r\nReproduction Details\r\n--------------------\r\nTo reproduce this issue, visit the following URL:\r\n  * ***URL***\r\n\r\nSystems Affected\r\n----------------\r\nThe following ***host is/hosts are*** affected by this issue:\r\n  * ***SITE***\r\n\r\nSeverity\r\n--------\r\nLow – This attack can be leveraged for social engineering attacks, or potentially be combined with other vulnerabilities to increase their total impact. Redirection to offensive content may result in a reputational impact for the organisation.\r\n\r\nRecommendation\r\n--------------\r\nLateral Security recommends minimising the use of user defined redirects. Any user defined content which influences the path should:\r\n* Be validated against a whitelist of expected paths.\r\n* Be appended to the site's own base path (e.g. https://lateralsecurity.com/) - including the trailing slash.\r\n* Be normalised. Removing redundant slashes and directory traversal attacks (using an appropriate library).\r\n"},{"title":"WA-X Outdated Software Components","category":"Web Application","contents":"WA-X Outdated Software Components\n=================================\n\nDescription\n-----------\nDuring external testing of the components of the web application, it was identified that the systems incorporate outdated technology components which have known vulnerabilities associated with them.\n\n***If unsupported systems are in use, change the issue to \"Outdated and Unsupported Software Components\" and add:***  Some of the technology in use is no longer supported by the vendor. If a vendor does not support the technology anymore, vulnerabilities which are applicable to this technology may no longer be formally tracked, resulting in the threat presented by the use of the software being difficult to quantify.\n\nThe following vulnerable systems were identified by this review:\n\n***TABLE GOES HERE - ensure you include the relevant CVEs***\n\nIt should be noted that a thorough internal analysis of the environment might reveal other outdated technologies that have vulnerabilities associated with them.\n\nReproduction Details\n--------------------\nTo reproduce this issue, while browsing the application using an intercepting proxy such as Burp Suite:\n  * ***FILL ME IN WITH DETAILS ON HOW TO DEMONSTRATE THE OUTDATED SOFTWARE. Make it flow naturally from \"while browsing using Burp Suite...\"***\n\nSystems Affected\n----------------\nThe following ***host is/hosts are*** affected by this issue:\n  * ***SITE***\n\nSeverity\n--------\nMedium – Application patching is the number one recommendation in CERT NZ's Critical Controls as unpatched applications are a major cause of security incidents. The majority of the security advisories released by CERT NZ relate to vulnerabilities which could be mitigated if systems were patched in a timely manner.\n\nIf the observed outdated software is indicative of a general lack of patching in the environment, this is likely to result in publicly known vulnerabilities being exploitable against the system in future. Further outdated software may be present in the technology stack in such a way that it was not detected by this review.\n\n***If there are no known vulnerabilities present due to this, change the content of the description and consider including the following and reducing the severity:***\nAs at the time of the testing, the technologies outlined above did not appear to have any public vulnerabilities associated with them, this issue was raised with a low severity rating.\n\n***If the issue is primarily around JavaScript libraries, again take into account the context to assess the severity and what we should say, and consider the following:***\nGenerally exploitation of frontend vulnerabilities relies on the application utilising specific features of the libraries. These are often not exploitable in practice, and as such, this issue was raised with a low severity rating.\n\n\nRecommendation\n--------------\n\nLateral Security recommends updating the outdated technologies raised in this issue to the latest releases available and be sure that an appropriate application patching strategy is applied to any component of the technology stack on the web server. If there is no way to patch a certain component, consider migrating to an alternative solution that provides similar functionality. If this is not feasible then isolating, disabling or removing the affected component should be considered as a mitigation.\n\nReview CERT NZ's guidance on patching for more information on the importance of this control, as well as suggestions for implementing patch management processes:\n* https://www.cert.govt.nz/it-specialists/critical-controls/patching/\n"},{"title":"WA-X Production Data in Test Environment","category":"Web Application","contents":"WA-X Production Data in Test Environment\r\n===============================\r\n\r\nDescription\r\n-----------\r\nIt was noted that the test environment contains data that appears to be sourced from the production environment. Cloning production systems for testing purposes is a common method of ensuring that test results are representative of production behaviour; however it is pertinent to note that test systems are often not configured with the same level of protection as a production system. Test environments are also often exposed to third parties whose access to production data should be minimised. Exposure of production data through test systems is a common cause of data breaches, as noted by the Office of the Privacy Commissioner: https://www.privacy.org.nz/blog/breach-case-4-testing-with-real-data/\r\n\r\nIn addition to increasing the exposure of this data, some uses of production data may be in violation of the Privacy Act which requires that:\r\n* Personal information obtained for one purpose not be used for any other purpose.\r\n* Personal information be protected by reasonable security safeguards.\r\n\r\n***More detail on what the data is and whether it's being protected appropriately, whether it's relevant to the functionality being tested or has been included for no reason***\r\n\r\nReproduction Details\r\n--------------------\r\n * ***FILL ME IN***\r\n\r\nSystems Affected\r\n----------------\r\nThe following ***host is/hosts are*** affected by this issue:\r\n  * ***SITE***\r\n\r\nSeverity\r\n--------\r\nInfo – ***Highly variable***\r\n\r\nRecommendation\r\n--------------\r\n\r\nWhere possible, do not use production data in test environments but instead generate similar looking data that does not correspond to actual users. \r\n\r\nIf production data must be used, it is recommended that it be sanitised by removing personally identifying information. If there are concerns regarding compliance with the Privacy Act, seek independent legal advice regarding compliance.\r\n\r\n\r\n"},{"title":"WA-X Remote Code Execution","category":"Web Application","contents":"WA-X Remote Code Execution\n==========================\n\nDescription\n-----------\nA remote code execution (RCE) vulnerability allows an attacker or malicious user to execute operating system commands or code in the context of the operating system user that the service is running as.\n\n*** KEEP RELEVANT PARAGRAPH FROM BETWEEN HERE AND REPRODUCTION DETAILS ***\n\nThe identified instance of code execution is the result of XML External Entitity (XXE) Injection.\nAn endpoint which consumes XML content was found to allow the user to specify processing actions, including reading sensitive files and executing code via the PHP expect module.\n\n\nThe identified instance of code execution is the result of content injection into shell command operations.\nThe site includes user supplied values as part of calls to the underlying operating system,\nallowing attackers to include arbitrary content into these system calls.\n\n\nThe identified instance of code execution is the result of the user being able to upload arbitrary files into an executable directory on the server.\nIf an attacker uploads a *** PHP *** file to this directory, then the content will be run by the web server upon retrieval.\nThis is a common vector for web-shell deployment, where an attacker uploads a malicious file which dynamically takes user input and executes it on the host.\n\n\nThe identified instance of code execution relates to a publicly disclosed vulnerability within the underlying framework used.\nThe application was found to be using *** FRAMEWORK *** which is vulnerable to CVE *** CVE-REF ***.\n\n\n\nReproduction Details\n--------------------\nTo reproduce this issue, while browsing the application using an intercepting proxy such as Burp Suite:\n  * ***FILL ME IN***\n\nSystems Affected\n----------------\nThe following ***host is/hosts are*** affected by this issue:\n  * ***SITE***\n\nSeverity\n--------\nCritical – An attacker who can execute arbitrary code in the context of the web server user can perform any action that the web-server user can perform.  This can lead to loss of administrative control of the server, data corruption, and denial of service or degradations in user accountability for the server.\n\nRecommendation\n--------------\nLateral Security recommends \n\n*** KEEP RELEVANT PARAGRAPH FROM BETWEEN HERE AND END OF ISSUE ***\ndisabling DOCTYPE Declaration (DTD) processing within the XML processor. The process for this depends on which libraries are being used and how they are configured (globally, or per call). If the library supports global configurations then it is suggested to disable DTD for the entire system, otherwise every calling instance (present and future) will need to ensure appropriate configurations are applied.\n\n\nreviewing the usage of system shell calls. Ideally these would be removed (using appropriate libraries to replace the functionality). Some methods of calling system functions provide safe options for including user supplied content; however, these can often be bypassed dependent on the calling context. Ensuring user supplied content is an exact match to items within a whitelist of trusted values may mitigate the issue when no other remediations can be applied.\n\n\nensuring that users cannot upload arbitrary files. If file upload functionality is required, then strict filetype (both extension and content) checking should be applied. Users directly accessing uploaded files on the server is often indicative of missing access controls. Access to uploaded files should be restricted to only those users who require access to the resources. Ensure that the file upload directory does not permit execution of file content.\n\n\nupdating the identified instance of *** FRAMEWORK *** to the latest compatible version.\n"},{"title":"WA-X Security Configuration Issues","category":"Web Application","contents":"WA-X Security Configuration Issues\n==================================\n\nDescription\n-----------\nA number of recommended security settings are not configured in line with good practice.\n\nThe application omits the following security-related headers:\n\n * The Content-Security-Policy header defines restrictions on content access and execution within the site to mitigate attacks against end-users.\n * The X-Frame-Options header can be used to prevent the page from being rendered inside a frame. This can prevent clickjacking attacks. Note that this header is obsolete in modern browsers that support Content-Security-Policy.\n * The ‘frame-ancestors’ Content Security Policy directive is a modern replacement for the X-Frame-Options header. To protect all browsers, both this directive and X-Frame-Options should be set.\n * The Strict-Transport-Security header instructs the browser to record that the website MUST be visited via a secure connection and prevents insecure connections in future. Any requests, whether via the browser’s address bar, through a redirect, or by referenced content, will always access the site via HTTPS. This helps to protect against attacks such as SSL Stripping.\n * Specifying an X-Content-Type-Options header will prevent the user’s browser from guessing the MIME type of provided files. This can help to protect against cross-site scripting attacks.\n * The header “Cache-Control: no-store” directs browsers, and any intermediate caching proxies, not to cache the response. When this header is used for responses containing sensitive data, it prevents that data from being inadvertently cached and served to other users. It also prevents sensitive data from being cached locally, where it could potentially be accessed later by unauthorised local users.\n\nThe application should set the “Secure”, “HttpOnly” and “SameSite” flags on cookies unless this interferes with required application behaviour. This is particularly important for cookies which are used to store session tokens or other sensitive information.\n\n * The “Secure” cookie flag instructs the browser not to send the cookie over an insecure HTTP connection. If this flag is not present, the browser will send the cookie even if HTTPS is not in use, which means it is transmitted in clear text and can be intercepted and stolen by an attacker who is listening on the network.\n * The “HttpOnly” flag lets the browser know whether or not a cookie should be accessible by client-side JavaScript code. It is best practice to set this flag unless the application is known to use JavaScript to access these cookies, as this prevents an attacker who achieves cross-site scripting from accessing these cookies.\n * The “SameSite” flag defines when a browser will send a cookie automatically with a request. This can be used as an additional protection against cross-site request forgery attacks.\n\nThe following specific misconfigurations were observed:\n\n * ***list the cookies/headers which need specific attention drawn to them***\n * ***The ASP.NET_SessionId Cookie is missing the ‘Secure’ flag***\n * ***The Strict-Transport-Security header was missing on the login page, but was present on all other pages***\n\nReproduction Details\n--------------------\nObserve that the above headers are not sent by the server in HTTP server responses. This may be viewed through an intercepting proxy such as Burp Suite or by using the Network tab of the browser’s built-in developer tools.\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n\n  * ***SITE***\n\nSeverity\n--------\nInfo – The lack of mitigations noted above does not create a security vulnerability in itself. The class of attacks introduced by omitting the controls detailed above results primarily in threats to end-users rather than the web application infrastructure itself. However, if the end-user can be targeted in such a way that an attacker hijacks their access to the application, this could result in the attacker gaining a higher level of privilege through these issues.\n\n***OPTIONAL: If a combination of missing headers and cookie flags can result in the disclosure of session tokens over HTTP, raise this issue as Medium***\n\nRecommendation\n--------------\nImplement the Strict-Transport-Security, X-Frame-Options and Cache-Control headers to harden the application against attack. X-Content-Type-Options should also be implemented where possible, but may cause issues in web applications that provide content without appropriate MIME types.\n\nThe Content-Security-Policy header is a highly powerful security control that should be implemented where possible, but requires significant consideration of the web assets used by the application. A policy should be developed which is appropriately restrictive whilst retaining web application functionality.\n\nTo prevent pages from breaking while implementing a Content Security Policy, the Content-Security-Policy-Report-Only header can be used. This header is identical to the Content-Security-Policy header, except it only reports policy violations instead of blocking them. This can be used to test the effects of a policy without enforcing it. After resolving any policy violations, the Content-Security-Policy-Report-Only header can then be changed to Content-Security-Policy to start enforcing the policy.\n\nCookie flags should be set where appropriate. Any sensitive cookies (such as session tokens) should use the most restrictive configuration possible without causing issues.\n\nBelow are useful references which describe the functionality of each header:\n\nMDN – Content Security Policy\n\n  * https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP\n\nMDN – Content-Security-Policy-Report-Only\n\n  * https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy-Report-Only\n\nMDN – X-Frame-Options\n\n  * https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options\n\nOWASP – Clickjacking Defense Cheat Sheet\n\n  * https://cheatsheetseries.owasp.org/cheatsheets/Clickjacking_Defense_Cheat_Sheet.html\n\nMDN – Strict-Transport-Security\n\n  * https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security\n\nMDN – X-Content-Type-Options\n\n  * https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options\n\nMDN – Cache-Control\n\n  * https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control\n\nMDN – Using HTTP cookies\n\n  * https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies\n\nThese resources describe the types of attacks the above headers protect against:\n\nMDN – Types of attacks\n\n  * https://developer.mozilla.org/en-US/docs/Web/Security/Types_of_attacks\n\nCloudflare – Performing & Preventing SSL Stripping: A Plain-English Primer\n\n  * https://blog.cloudflare.com/performing-preventing-ssl-stripping-a-plain-english-primer/\n\nPortSwigger – Web cache poisoning\n\n  * https://portswigger.net/web-security/web-cache-poisoning\n"},{"title":"WA-X Sensitive Data in Source Control","category":"Web Application","contents":"WA-X Sensitive Data in Source Control\r\n===============================\r\n\r\nDescription\r\n-----------\r\nLateral Security identified sensitive data which had been committed to version control. While source control is a recommended tool for managing code, it is not recommended that application secrets be checked into repositories. Configuration files should not be put into version control unless they describe a ‘factory default’ state of the application and do not contain any sensitive data.\r\n\r\nIncluding application secrets in source code is similar to hardcoding passwords. It is good practice to avoid tightly coupling secrets with your application source as this is a violation of the principle of least privilege. Secret tokens and keys do not need to be accessible to everyone who has access to application source and should only be handled when an application is being deployed.\r\n\r\nReproduction Details\r\n--------------------\r\n* ***FILL ME IN***\r\n\r\nSystems Affected\r\n----------------\r\nThe following ***file is/files are*** affected by this issue:\r\n  * ***SITE***\r\n\r\nSeverity\r\n--------\r\nLow/Medium – \r\n\r\nRecommendation\r\n--------------\r\nA number of options are available for the distribution of application secrets during application deployment, each having its own strengths and weaknesses.\r\nIdeally, application secrets would be introduced to the environment from a platform-dependent secret store at the orchestration layer or as part of an automated deployment process. If a secure secret store is not available, alternative options include:\r\n* Using a pre-existing secure channel to share configuration files for deployment without tying these to the application source.\r\n* Storing configuration details as environment variables, although it is pertinent to note that environment variables are commonly leaked by misconfigured debug functionality or developer aides.\r\n"},{"title":"WA-X Sensitive Information Transmitted Over Insecure Protocol","category":"Web Application","contents":"WA-X Sensitive Information Transmitted Over Insecure Protocol\r\n=============================================================\r\n\r\nDescription\r\n-----------\r\nSensitive traffic is transmitted over the clear-text protocol HTTP. When a user is trying to log into the web site to manage their account, no transport level security (such as HTTPS) is implemented. In the event that traffic is intercepted by an attacker they would be privy to the entire contents of messages transmitted to or from the server.\r\n\r\nReproduction Details\r\n--------------------\r\nTo reproduce this issue, browse the application using an intercepting proxy such as Burp Suite:\r\n  * Identify the login request containing the user's credentials\r\n  * Observe that this is sent via the unencrypted HTTP protocol\r\n\r\nSystems Affected\r\n----------------\r\nThe following ***host is/hosts are*** affected by this issue:\r\n  * ***SITE***\r\n\r\nSeverity\r\n--------\r\n***Info/Medium*** – An attacker who is positioned between the client and the server can view the full contents of the HTTP stream, including user credentials. ***OPTIONALLY: It is understood, that ***client*** is aware of this issue and has asserted that the production web application will be available only over HTTPS. This issue was raised for completeness.***\r\n\r\nRecommendation\r\n--------------\r\nEnsure that sensitive information is transmitted to or from the server over a secure transport mechanism, such as a suitably configured SSL/TLS stream. Ensure that SSL/TLS best practices are observed:\r\n * https://www.ssllabs.com/projects/best-practices/index.html\r\n"},{"title":"WA-X Server-Side Request Forgery","category":"Web Application","contents":"WA-X Server-Side Request Forgery\r\n===============================\r\n\r\nDescription\r\n-----------\r\nServer-side request forgery (SSRF) is a vulnerability where an end user can cause the server to perform outbound requests to additional resources. This allows attackers to request resources from the perspective of the server, leveraging any IP whitelisting that the server has been granted, internal network addresses the server can reach, and often includes local filesystem access as well. Depending on the implementation it may also allow an attacker to read or update sensitive resources.\r\n\r\nReproduction Details\r\n--------------------\r\n***SITE SPECIFIC***\r\n\r\nSystems Affected\r\n----------------\r\nThe following ***host is/hosts are*** affected by this issue:\r\n  * ***SITE***\r\n\r\nSeverity\r\n--------\r\nHigh/Medium – An attacker could exploit this vulnerability to obtain access to sensitive data, leveraging the connections and trust relationships available to the server. This could allow the attacker to use the target host to pivot to other associated hosts.\r\n\r\nRecommendation\r\n--------------\r\nLateral Security recommends either disabling this functionality or limiting the accepted URIs to a strict whitelist of intended hosts.\r\n***The specific recommendation depends on the details of the vulnerability***\r\n"},{"title":"WA-X Session Management Issue","category":"Web Application","contents":"WA-X Session Management Issue\r\n=============================\r\n\r\nDescription\r\n-----------\r\nDuring testing it was identified that the session management system of the web application is susceptible to a weakness. When an authenticated user logs out, the associated session is not properly unset at the server side. So the user can use their old session cookies (***ASP.NET_SessionId*** and ***.ASPXAUTH***) to get access to the web application until the session expires. \r\n\r\nReproduction Details\r\n--------------------\r\nTo reproduce this issue, using an intercepting proxy such as Burp Suite:\r\n  * Sign into the web application\r\n  * Request a page that requires authentication\r\n  * Save the request in the proxy\r\n  * Sign out of the application\r\n  * Replay the request in the proxy and observe that it works\r\n\r\nSystems Affected\r\n----------------\r\nThe following ***host is/hosts are*** affected by this issue:\r\n  * ***SITE***\r\n\r\nSeverity\r\n--------\r\nLow – In order to benefit from this issue, an attacker first needs to obtain valid session cookies of the victim, which means that the victim’s account has already been compromised. The issue then increases the time frame during which an attacker could use the obtained session tokens for unauthorised access to the web application.\r\n\r\nRecommendation\r\n--------------\r\nEnsure that a session management schema is implemented that performs proper server-side session invalidation upon user logout. When a user logs in again, a different session token should be assigned to their session and no information should be left accessible with a previously invalidated session token.\r\n\r\nPlease refer to the following link for further details about secure session management:\r\n  * https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html\r\n"},{"title":"WA-X SQL Injection","category":"Web Application","contents":"WA-X SQL Injection\n==================\n\nDescription\n-----------\nSQL injection vulnerabilities allow an attacker to manipulate the query provided from the web application to the database. Through injection of their own content into the query, it provides the attacker the means to access the database, similar to accessing the database directly.\n\nFor example, consider the following:\nhttps://www.lateralsecurity.com/account?name=***a' OR 'x'='x***\n\nSupporting code:\n```\n$sql_query = \"SELECT * FROM accounts WHERE account = '***$name***'\";\n```\n\nThe SQL query that is issued to the database is:\n```\nSELECT * FROM accounts WHERE account = '***a' OR 'x'='x***'\n```\n\nIn the above example, the attack is a relatively trivial modification of the resulting query to include a condition which will return all available accounts. More sophisticated SQL injection attacks will heavily manipulate the query to read, modify or delete arbitrary data within any table. Depending on the database user's permissions and enabled features, it may also allow a degree of file system or operating system access.\n\nIn this case, the ***PARAM*** parameter of the ***URL*** URL was found to be vulnerable to SQL injection. The request in particular was:\n```\n***CODE***\n```\n\nIt is likely this is being converted into an SQL query similar to the following:\n```\n***SQL***\n```\n\nSeverity\n--------\nCritical – Access to database contents, and potentially a degree of access to the underlying operating system, is dependent on the permissions granted to the database user account used by the web application. These access rights are commonly poor, with the database user having both read and write access to all database contents.\n\n***The vulnerability was easily identified, as a large amount of data was returned when the parameter was set to ' OR 'x'='x. This value is commonly used when testing for SQL injection and such a large amount of data stands out. Therefore, it is highly likely that somebody explicitly looking for SQL injection could find this easily.***\n\n***This request was able to be made from a customer account.***\n\nReproduction Details\n--------------------\nTo reproduce this issue:\n  * ***Reproduction Details***\n\nSystems Affected\n----------------\nThe following ***host is/hosts are*** affected by this issue:\n  * ***SITE***\n\nRecommendation\n--------------\nTwo key countermeasures are available which should be implemented by the solution. Primarily, SQL queries should always be generated through parameterisation. String concatenation of user data should never be used anywhere within the application.\nAdditionally, ensure strict whitelist validation is implemented. This approach should be conducted against all data supplied by the user.\n\nIf SQL injection protection is implemented in an ad-hoc manner (by calling an escaping function before each call to the database) then restructuring the application so all requests go through an ORM should be strongly considered to further prevent SQL injection vulnerabilities.\n\n***Check whether this is applicable: Using a semi-blind technique, it will likely be possible to extract all data from the database. No errors will be generated, however there would be a significant number of requests. It should be ensured that appropriate auditing, logging and alerting is in place, as such attacks are distinctive. This will allow a prompt response to any attacks using this technique.***\n\nAn additional mitigation which should be used as part of defence in depth is to limit the permissions granted to the database user to those necessary for the application to function, in line with the principle of least privilege. \n"},{"title":"WA-X Excessive Functionality Available","category":"Web Application","contents":"WA-X Excessive Functionality Available\r\n======================================\r\n\r\nDescription\r\n-----------\r\nLateral Security identified functionality which needlessly increases the attack surface of the application. Redundant functionality can be accumulated by an application through a number of means, such as:\r\n* Endpoints added as test or development aides.\r\n* Deprecated functionality which has been superseded but can still be interacted with.\r\n* Functionality or sample applications added by libraries, frameworks or exposed through the default configuration of the underlying software platform.\r\n\r\nIn this instance, the functionality identified was:\r\n* ***FILL ME IN***\r\n\r\nReproduction Details\r\n--------------------\r\nTo reproduce this issue, while browsing the application using an intercepting proxy such as Burp Suite:\r\n  * ***FILL ME IN***\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SITE***\r\n\r\nSeverity\r\n--------\r\nMedium – The exposure of unnecessary functionality provides a great attacker surface than strictly necessary for the functioning of the application. This could allow an attacker to attempt to identify vulnerabilities within the extraneous functionality. Deprecated or development-related functionality is typically tracked less effectively than core application functionality and as such may not receive as much attention in terms of security vulnerability assessment and hardening.\r\n\r\nRecommendation\r\n--------------\r\nIt is recommended that the application only expose the functionality required to achieve its objectives and that further content and functional endpoints are removed from the solution. Wherever possible, this should be achieved via deletion rather than a software toggle to reduce the threat of future misconfiguration exposing the content in future.\r\n"},{"title":"WA-X Weak SSL/TLS Configuration","category":"Web Application","contents":"WA-X Weak SSL/TLS Configuration\n===============================\n\nDescription\n-----------\nThe TLS configuration for the application is not in line with good practice.\n  * The RC4 cipher is in use and is considered weak, regardless of the fact that it can use a key length of 128 bits. A security vulnerability known as “BEAST” prompted wide adoption of this algorithm as it was impervious to that specific attack. However, it has resulted in a trade-off whereby potentially protecting a generally isolated group of users has resulted in degraded cryptography for all users.\n  * The server supports SSLv3. SSLv3 is insecure when used with HTTP and weak when used with other protocols. It has a known CBC padding oracle attack which allows plaintext to be recovered. This could be used to recover session IDs or credentials. It is good practice to disable SSLv3. NIST no longer considers Secure Socket Layers (SSL) v3.0 protocol as acceptable for protecting data.\n  * The server supports the TLSv1.0 protocol. This protocol version is considered to be deprecated, and standards such as PCI have moved towards disallowing it.\n  * The server supports only the legacy protocol TLS 1.0 and explicitly does not support other versions of this protocol (TLS 1.1 and 1.2). This leaves the web server without the enhanced security features provided by the newer versions.\n  * The environment is susceptible to an attack called the “DROWN” attack. This is an attack method described in March 2016 and is related to SSLv2. In essence, if an environment which utilises wildcard certificates incorporates at least one server that allows SSLv2, then it can be used to attack all the other servers that share the same private key, even if they do not expose SSLv2 themselves. For more information please see the following link: https://blog.qualys.com/securitylabs/2016/03/04/ssl-labs-drown-test-implementation-details\n  * SHA1 is used as a hashing algorithm in one of the certificates in the certificate chain. This hashing algorithm is currently claimed insecure and it was announced that certificates that use this algorithm may not be accepted as valid by modern browsers.\n  * The certificate used on the web server is not trusted.\n  * Forward Secrecy was not found to be utilised with some of the browsers. This increases an attacker’s chances of decrypting sensitive traffic if the web server’s private key becomes compromised.\n  * An issue related to the Diffie-Hellman key exchange algorithm implementation has been published. It consists in the fact that default installations of OpenSSL share the same 1024-bit Diffie-Hellman group, which is further utilised in the algorithm. If it is broken, then all the web servers which share this group are affected and an adversary could decrypt traffic through passive eavesdropping. This is known as the FREAK attack.\n\nReproduction Details\n--------------------\nView the site results using SSLLabs:\n  * https://www.ssllabs.com/ssltest/\n\nSystems Affected\n----------------\nThe following ***host is/hosts are*** affected by this issue:\n  * ***SITE***\n\nSeverity\n--------\nLow – The issue is considerably mitigated by the complexity of exploitation compared to the value of the traffic to an attacker. It is pertinent to note, however, that attacks against weak ciphers are becoming increasingly practical. As such, the impact is primarily reputational as these configuration options are identifiable by unskilled parties using the noted testing tools and SSL configuration is commonly, accurately or not, interpreted as an indicator of overall security posture.\n\nRecommendation\n--------------\nLateral Security recommend that ***CLIENT*** remove support for the RC4 cipher and disable SSLv3 as a matter of good practice. ***COMPLETE THIS AS REQUIRED***\n\nThe SSL configuration can be checked at the following site to ensure it is appropriate:\n  * https://www.ssllabs.com/ssltest/\n\nA best practice guide can be found at:\n  * https://www.ssllabs.com/projects/best-practices/\n"},{"title":"WA-X TLS 1.0/1.1 Support Enabled","category":"Web Application","contents":"WA-X TLS 1.0/1.1 Support Enabled\n===============================\n\nDescription\n-----------\nThe system uses HTTPS (HTTP over TLS) to provide an encrypted communications channel for transmitting web content.\nThis encryption layer is negotiated between the client and server to use one of many protocol and cipher combinations.\n\nLateral Security identified that the server accepts the deprecated TLS protocol versions 1.0 and 1.1, which do not support recommended modern ciphers.\n\n\nReproduction Details\n--------------------\nScan the affected IPs using the “sslscan” tool (available at https://github.com/rbsec/sslscan).\n\nAlternatively, SSLLabs provides an online tool (available at https://www.ssllabs.com/ssltest).\n\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***SITE***\n\nSeverity\n--------\nLow – The issue is considerably mitigated by the complexity of exploitation compared to the value of the traffic to an attacker. As such, the impact is primarily reputational as these configuration options are identifiable by unskilled parties using the noted testing tools and SSL configuration is commonly, accurately or not, interpreted as an indicator of overall security posture.\n\n\nRecommendation\n--------------\nLateral Security recommends disabling support for TLS 1.0 and 1.1.\nA best practice guide can be found at:\n*\thttps://www.ssllabs.com/projects/best-practices/\nIt is noted that disabling TLS 1.0 and 1.1 may result in compatibility issues for extremely outdated browsers, therefore care must be taken to ensure that all targeted clients have one (or more) supported protocol/cipher combinations.\n"},{"title":"WA-X Unvalidated Redirect","category":"Web Application","contents":"WA-X Unvalidated Redirect\r\n=========================\r\n\r\nDescription\r\n-----------\r\nA common design pattern in web applications, particularly during login and logout, is to record as a URL parameter the location the user will be redirected to once the requested action is complete. This can be particularly useful if a user requests a protected resource while unauthenticated to ensure a smooth transition back to this resource after login.\r\nThis often takes a form similar to the following:\r\n\r\n- https://www.lateralsecurity.com/login?RedirectURL=/authenticated-component\r\n\r\nThis design pattern is often implemented in a way which introduces vulnerabilities into the application. One issue which can occur is that the URL to which the redirection will occur is not properly validated. If this is the case, an attacker can craft a URL which appears to specify a resource on a trusted site, but which in reality redirects an attacker to a phishing site or other malicious content.\r\n\r\nFor example, consider a user navigating to the following URL:\r\n\r\n- https://www.lateralsecurity.com/login?RedirectURL=https://www.lateralsecurity.info\r\n\r\nThe user might expect to arrive at lateralsecurity.com based on the URL. In reality they will be redirected to lateralsecurity.info. This subversion of user expectations can allow attackers to target even those users who check whether the hostname in a URL they are supplied with is legitimate.\r\n\r\nReproduction Details\r\n--------------------\r\nTo reproduce this issue, browse the application using an intercepting proxy such as Burp Suite:\r\n  * ***FILL ME IN***\r\n\r\nSystems Affected\r\n----------------\r\nThe following ***host is/hosts are*** affected by this issue:\r\n  * ***SITE***\r\n\r\nSeverity\r\n--------\r\nMedium – This issue does not directly lead to a compromise of the web application. However, this allows an attacker to coerce a user into visiting a malicious link by leveraging their trust in the domain, which could cause reputational damages in the event of a compromise. If utilised in a successful phishing attack, this could lead to a compromise of a privileged user account, with corresponding impact on the application’s security.\r\n\r\nRecommendation\r\n--------------\r\nLateral Security recommends ***CLIENT*** restrict the web application to redirecting users to a pre-defined set of URLs. Refer to the following link for further information about this type of attack and options for mitigation:\r\n  * https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html\r\n"},{"title":"WA-X Weak Password Policy","category":"Web Application","contents":"WA-X Weak Password Policy\n=========================\n\nDescription\n-----------\nUsername and password policies are a key security control to protect against user introduced weaknesses. The login system poses the following requirements / restrictions on the user’s password:\n\n***Must be 5-10 characters long, and must contain two categories from: \n* Uppercase\n* Lowercase\n* Number\n* Special Character***\n\n***These requirements encourage users to take the simplest available option, selecting weak passwords due to maximum length restrictions.\nMaximum password length restrictions are frequently used where applications do not hash the provided passwords before storage.\nIf this is the case for the platform, then it is strongly recommended that a password hashing algorithm which is designed to withstand offline brute force attacks, such as BCrypt or SCrypt is used.***\n\nReproduction Details\n--------------------\nReview the password policy presented when creating registering a password. Attempt to set a weak password and observe that it is allowed. \n\nSystems Affected\n----------------\nThe following ***host is/hosts are*** affected by this issue:\n  * ***SITE***\n\nSeverity\n--------\nLow – Restricting the maximum length for a user’s password enforces a limit for the strongest possible password strength, which given typical user password selection methods, results in greater predictability of values. This weakness is also applicable should the credential database be compromised, providing attackers a smaller brute-force candidate space.\n\n\nRecommendation\n--------------\nNZISM recommends a password policy enforcing either:\nA minimum password length of 16 characters with no complexity requirement; or\na minimum password length of ten characters, consisting of at least three of the following character sets:\n* lowercase characters (a-z);\n* uppercase characters (A-Z);\n* digits (0-9); and\n* punctuation and special characters.\n\nIf the minimum password length is 16 characters or greater, no periodic expiry is required.\nHowever, if the minimum password length is shorter than 16 characters:\n* Passwords should be set to expire after 90 days\n* The system should prevent users from changing their password more than once per day\n* The system should disallow password reuse within eight password changes\n"},{"title":"WA-X Web Server Hardening","category":"Web Application","contents":"WA-X Web Server Hardening\n=========================\n\nDescription\n-----------\nThe web server displayed behaviour that leads Lateral Security to believe that it has not undergone security hardening. Many of the default features present can be disabled to improve security. If left enabled, these features could cause security issues in the future and aid attackers by providing additional information and methods of attack. \n\nThe following are general recommendations around web server hardening:\n* Review and remove unnecessarily hosted files.\n* Disable unused features such as SSI, CGI, and web server modules.\n* Ensure that the web server is run by a user with limited access.\n* Disable headers that identify the software in-use and version (e.g.: Web Server, Operating System etc.)\n* Disable directory listing.\n* Disable unused HTTP request methods such as TRACE, TRACK and CONNECT.\n* Disable support for the HTTP 1.0 protocol.\n* Ensure the ETag header does not include Inodes.\n* Check Session Timeout, Request Limits, and Request Body Size are configured appropriately.\n* Consider adding appropriate web server security modules.\n* Ensure appropriate logging is enabled and configured securely.\n\nReproduction Details\n--------------------\nThe behaviours observed that lead to this recommendation were:\n* Directory Listing was enabled for the application at the following URLs:\n* https://example.com/file-share/\n* Web server and Operating system versions were found both in headers and in error pages:\n* https://example.com/error.aspx\n\nSystems Affected\n----------------\nThe following systems are affected by these issues:\n* ***SITE***\nAdditionally, this may affect other out-of-scope applications that are hosted on the same machine.\n\nSeverity\n--------\nLow – A lack of web server hardening does not constitute a vulnerability, but it does increase both the attack surface and provide useful information to an attacker. For example, directory listings give attackers more information about the system and can leak sensitive information. While version numbers allow attackers and automated tools to more precisely exploit applications when vulnerabilities are found. \n\nRecommendation\n--------------\nLateral Security recommends that an appropriate hardening guide for the web server be followed such as those provided by Center for Internet Security here:\n* https://www.cisecurity.org/cis-benchmarks/\n***In this case Lateral Security recommends that directory listing be disabled, and any version information removed.*** A review and web server hardening exercise should be carried out to ensure that the server has been configured securely according to a reputable benchmark.\n"},{"title":"WA-X WordPress Hardening","category":"Web Application","contents":"WA-X WordPress Hardening\n=========================\n\nDescription\n-----------\nWordPress is a popular framework and due to its flexibility and widespread deployment it attracts a lot of attention from attackers. WordPress provides official recommendations on security hardening.\n\nA number of issues were identified that are not recommended practice for WordPress instances. Specifically:\n  * A number of directories have public listing pages. Private data can unintentionally be shared on these pages as well as giving potential attackers more information about the configuration of the server.\n  * The XML-RPC API  was enabled. This allows attackers to bypass the brute-force login protection.\n\nReproduction Details\n--------------------\nFor an example of a directory listing that may contain private files, navigate to:\n  * ***URL HERE***\n\nTo see that XML-RPC is enabled, navigate to:\n  * ***host/xmlrpc.php***\n\nSystems Affected\n----------------\nThe following ***system is/systems are*** affected by these issues:\n  * ***Fill me in***\n\nSeverity\n--------\nMedium/Low - By exposing the XML-RPC endpoint it allows attackers to bypass any brute-force login protection.\nDirectory listings give attackers more information about the system and can leak private documents and information.\n\nRecommendation\n--------------\nLateral Security recommends that an appropriate WordPress Hardening guide be followed. Wordpress.org provides a guide that lists security considerations which may be useful:\n  * https://wordpress.org/support/article/hardening-wordpress/\nIn this case Lateral Security recommends that ***directory listing and XML-RPC API*** be disabled.\n\nThe XML-RPC API has the following known issues:\n  * https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner\n  * https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login\n  * https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos\n  * https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access\n"},{"title":"WA-X XML External Entity Injection","category":"Web Application","contents":"WA-X XML External Entity Injection\n==================================\n\nDescription\n-----------\nXML External Entity Injection is a vulnerability where a poorly configured XML parser can be manipulated into accessing otherwise inaccessible information. It can also lead to denial of service, server side request forgery, and allow the attacker to make requests as if they had the privileges of the server.\n\nThe XML standard allows entities to be defined which include other files or remote content in a document. This functionality is enabled by default in many XML parsers, but can safely be disabled when not in use. Attackers take advantage of this functionality by including references in user-provided data to content they intend the server to download for them.\n\nNote that the application does not need to explicitly return a response to be vulnerable. An attacker may make the server access domains they control to extract information about the server.\n\nReproduction Details\n--------------------\nTo reproduce this issue, while browsing the application using an intercepting proxy such as Burp Suite:\n  * ***Fill me in***\n\nSystems Affected\n----------------\nThe following systems are affected by this issue:\n  * ***Fill me in***\n\nSeverity\n--------\nMedium - This issue could allow unauthorised users to download arbitrary files from the server hosting the application and other servers it has access to. In some cases the attacker can make state-changing requests to other devices on the network.\n\nRecommendation\n--------------\nLateral Security recommends that the functionality of the XML parser be restricted and any functionality that could result in a document including external data or making server-side requests on behalf of an attacker be disabled. eg: XML External entities and XInclude functionality.\n\nFor application specific guidance, please refer to the following OWASP guide:\n*  https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html\n"},{"title":"WA-X Cross-Site Scripting","category":"Web Application","contents":"WA-X Cross-Site Scripting\r\n=========================\r\n\r\nDescription\r\n-----------\r\nCross-Site Scripting (XSS) is a technique used to execute malicious JavaScript within a user’s browser. This can be achieved through a number of methods but is primarily achieved by providing content to an application which causes the malicious script to be embedded in the web page.\r\n\r\nIt is pertinent to note that this class of attack targets end-users rather than the web application itself. When this attack is considered “persistent” the malicious content is stored by the web application. It is retrieved and included when accessing specific pages. When the attack is considered “reflected” the content is derived from the user request and as such is only returned if a user can be coerced into accessing the application in a way which delivers the malicious content, such as by following an attacker-crafted link.\r\n\r\nFor example, if a request is made to:\r\n\r\n * https://www.lateralsecurity.com/addcomment.php?name=jim&comment=test%20<script>alert('arbitrary script');</script>\r\n\r\nIf the web application blindly stores the content of the “comment” parameter, the script will be included whenever a user views the comments. The resulting HTML will be:\r\n\r\n```\r\n<html><body>[…]\r\n<b>Author:</b> jim<br/>\r\n<b>Comment:</b> test ***<script>alert('arbitrary script');</script>***\r\n[…]</body></html>\r\n```\r\n\r\nThe included JavaScript is executed in the user’s browser where, in this example, a benign pop-up message occurs.\r\n\r\n***IN THIS PARTICULAR CASE***\r\n\r\nReproduction Details\r\n--------------------\r\nTo reproduce this issue:\r\n  * ***Step 1***\r\n\r\nSystems Affected\r\n----------------\r\nThe following ***host is/hosts are*** affected by this issue:\r\n  * ***SITE***\r\n\r\nSeverity\r\n--------\r\nMedium – The likelihood of this attack is gauged to be reasonable, as a potential victim would likely access the embedded malicious content. The potential impact varies and is determined by what an attacker may be able to achieve. Instead of the benign JavaScript used within the description section above, this could include:\r\n  * Using scripting to read session tokens from cookies provided by the website which are not protected by the “HttpOnly” security flag and relay it to an attacker. This requires the user to be currently authenticated to the web application. Alternatively, if the session token is not refreshed after a successful login, an attacker may store it and wait for the user to authenticate.\r\n  * Including advanced XSS frameworks in order to utilise the victim’s browser session as a proxy to conduct further malicious actions including attacking other systems.\r\n  * Exploiting browser plugins to expand the capabilities of the attack or attempt. This could also be used to attack the victim’s browser stack to gain access to other open websites, the data contained on other websites or the user's operating system.\r\n  * Rewriting content within the resulting page to spread misleading information, or to deliberately include objectionable content to directly affect the organisation’s reputation.\r\n\r\n***Leave in ONLY if the XSS is persistent and authed, users can't self-register, and CSRF was found. As the application was also found to be vulnerable to cross-site request forgery (see WA-1 TODO Insert Cross Reference), an attacker would be able to post the malicious content without needing an account themselves. This increases the likelihood of exploitation.***\r\n\r\nRecommendation\r\n--------------\r\nInitially, investigate the root cause to determine why user-provided input is being ***stored|included in the page*** without validation. Conduct an internal review to identify any other potential instances of this issue.\r\n\r\nTo prevent this style of attack, context specific encoding should be performed on content before rendering it to the page. The appropriate steps to take depend on the rendering context. For example, if user input is being included in an HTML block, HTML entity encoding should be implemented. However, if user input may be rendered into JavaScript content or into CSS styling rules, different sanitisation processes are required.\r\n\r\nThese protections should be implemented by a framework or security-focused library rather than manually encoding/validating user input each place it is stored or displayed back to the user. OWASP provides examples of some rendering contexts which your rendering library should be capable of encoding for:\r\n\r\n  * https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html\r\n"},{"title":"WHR-X Antivirus Definitions Out of Date","category":"Windows Host Review","contents":"WHR-X Antivirus Definitions Out of Date\r\n=======================================\r\n\r\nDescription\r\n-----------\r\nAt the time of the review in ***Month***, the Virus and Spyware Protections definitions on the Symantec Endpoint protection software were from ***Date***, ***two*** months prior to the review. As a result, the server will not be protected against new malware or variants of malware introduced during that period.\r\n\r\nReproduction Details\r\n--------------------\r\nOpen the ***Symantec Endpoint Protection*** console and view the date on the last definition update.\r\n\r\nSystems Affected\r\n----------------\r\nThe following systems are affected by this issue:\r\n  * ***SITE***\r\n\r\nSeverity\r\n--------\r\nMedium – A new or recently altered piece of malware could infect the server without being detected or quarantined by the ***Symantec Endpoint Protection*** software on the server.\r\n\r\nThis finding indicates a lack of adherence to NZISM 14.1.7.\r\n\r\nRecommendation\r\n--------------\r\nEnsure that the Antivirus receives definition updates on a daily basis, and that alerts are logged centrally and actioned appropriately. Any failures to update definitions or failure of the antivirus software should generate an alert and be investigated. In addition, Lateral Security recommends the use of host IDS software to monitor critical system and application files on the server, and report any unauthorised changes to these files.\r\n"},{"title":"WHR-X Excess Services Enabled","category":"Windows Host Review","contents":"WHR-X Excess Services Enabled\n=============================\n\nDescription\n-----------\n\nServices are set to run automatically on start-up. These are unlikely to be necessary for the implementation, and may reduce system security.\n\nThe services are as follows:\n\n* IP Helper\n* Print Spooler\n* IKE and Authsec Keying Modules\n\nReproduction Details\n--------------------\n\nTo see the running services, issue the following command.\n\n```\nget-service\n```\n\nSystems Affected\n----------------\n\n  * ***SYSTEM***\n\nSeverity\n--------\n\nMedium – Any running application or service increases the attack surface of the implementation. Good security practice requires that a system run only the services and processes which are required for its correct operation.\n\nThis finding indicates a lack of adherence to:\n\n* NZISM 14.1. Standard Operating Environments\n\nRecommendation\n--------------\n\nReview the list of services which will run when the server starts up, and change the startup type of those which are not necessary to \"Manual\".\n"},{"title":"WHR-X Excessive Software Installed on Servers","category":"Windows Host Review","contents":"WHR-X Excessive Software Installed on Servers\r\n=============================================\r\n\r\nDescription\r\n-----------\r\nThe ***SERVER*** has Microsoft SharePoint 2010, Adobe PDF iFilter, and Microsoft SQL Server 2008 R2 installed in addition to the core software components installed for Microsoft BizTalk.\r\n\r\nSystems Affected\r\n----------------\r\n  * ***SYSTEM***\r\n\r\nReproduction Details\r\n--------------------\r\nReview the installed software.\r\n\r\nSeverity\r\n--------\r\nLow – The more software running on a server, the greater attack surface that server has, as it is required to run more services and consequently can carry more vulnerabilities.\r\n\r\nRunning multiple products on the same server also introduces a risk to performance and availability. BizTalk, SQL and SharePoint may at times compete for resources on the system. Should this happen it could result in reduced response times and performance or could lead to availability issues.\r\n\r\nRecommendation\r\n--------------\r\nConsideration should be given to separating the BizTalk and SharePoint servers to run on their own dedicated servers. As reliance on the solution increases, the additional load on these servers will increase the likelihood of a conflict and the impact to ***CLIENT*** of performance issues will increase. Given the resource and management requirements of SQL Servers, these should also be separated from the BizTalk and SharePoint servers where possible.\r\n\r\nIn addition, if the Adobe PDF iFilter software is not required for the operation of the BizTalk server, this should be removed.\r\n"},{"title":"WHR-X IIS Insecure Communication","category":"Windows Host Review","contents":"WHR-X IIS Insecure Communication\n================================\n\nDescription\n-----------\nThe web server configuration does not secure communication for all websites:\n\n* Some websites do not require transport layer security, which would affect any Basic authentication.\n* Form submitted information will not require transport layer security.\n\nReproduction Details\n--------------------\nTo see that some websites to not require Transport Layer Security, issue the following command in PowerShell:\n```\nGet-Website\n```\nTo see that form submitted information will not require transport layer security, issue the following command in PowerShell.\n```\nGet-WebConfiguration -filter /system.web/authentication/forms\n```\n\nSystems Affected\n----------------\n  * ***SYSTEM***\n\nSeverity\n--------\nMedium – If data is sent unencrypted to the web server, then an attacker might capture and exfiltrate or alter the data. The organisation could suffer reputational damage from malicious use or leaks of the data.\n\nRecommendation\n--------------\nAll websites which submit information via forms should require transport layer security. Websites which authenticate with basic authentication should also.\n"},{"title":"WHR-X IIS Insecure Cookies","category":"Windows Host Review","contents":"WHR-X IIS Insecure Cookies\n==========================\n\nDescription\n-----------\nThe web server has cookie settings which do not meet good security practice:\n\n* The session state does not require cookies instead of storing session in the URI.\n* The server will not issue the HttpOnly on cookies.\n* Form authentication has not been restricted to cookies only.\n\nReproduction Details\n--------------------\nTo see that the session state does not require cookies, issue the following command:\n```\nGet-WebConfiguration -filter /system.web/sessionState/@cookieless\n```\nTo see that the server will not issue HttpOnly on cookies, issue the following command in PowerShell:\n```\nGet-WebConfiguration -filter /system.web/httpCookies/@httpOnlyCookies\n```\nTo see that forms authentication does not require cookies, issue the following command in PowerShell:\n```\nGet-WebConfiguration -filter /system.web/authentication/forms\n```\n\nSystems Affected\n----------------\n  * ***SYSTEM***\n\nSeverity\n--------\nMedium – If cookies are not required for authentication, then the URI will be used. This method of authentication exposes sensitive information to being captured by proxies, scripts through the browser API. If the HttpOnly flag is not set, then cookies storing sensitive information, such as the session, might be maliciously manipulated by a client-side script, allowing an attacker to steal the session.\n\nRecommendation\n--------------\nEnsure that the server will require cookies for authentication and will issue the HttpOnly flag on all cookies. When cookies are required, the default is to enable cookie protection mode, which should not be disabled.\n"},{"title":"WHR-X Infrequent Operating System Patching","category":"Windows Host Review","contents":"WHR-X Infrequent Operating System Patching\r\n==========================================\r\n\r\nDescription\r\n-----------\r\nVendor patches are infrequently applied to the operating system. Patching is one of the critical controls published by CERT NZ and part of the Essential Eight mitigations published by the Australian Cyber Security Centre to help prevent compromise.\r\n\r\nBelow is the patching history.\r\n\r\n[include information from get-hotfix]\r\n\r\nReproduction Details\r\n--------------------\r\nTo see that patches are infrequently applied, issue the following command.\r\n    get-hotfix\r\n\r\nSystems Affected\r\n--------------\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nMedium – Were an attacker to successfully exploit an unpatched system, the system could be compromised. The system could then be used as a platform to launch other attacks within the environment.\r\n\r\nThis finding indicates a lack of adherence to:\r\n\r\n* 12.4. Product Patching and Updating\r\n\r\nRecommendation\r\n--------------\r\nEnsure that vendor patches are frequently applied and that a patching policy clearly delegates patch release monitoring and patch application responsibility. All critical vulnerabilities should be patched within 48 hours of their publication. Perform regular audits of these processes.\r\n"},{"title":"WHR-X No AppLocker","category":"Windows Host Review","contents":"WHR-X No AppLocker\n==================\n\nDescription\n-----------\n\nA version of SNMP prior to version 3 has been enabled. These older versions of the protocol are not secure. SNMPv1 and SNMPv2 lack cryptographic security which helps to protect the sensitive diagnostic information and management access that SNMP provides. SNMPv1 and SNMPv2 use a community string for access control, and this string traverses the network in the clear. The default community strings have been configured with read access.\n\nReproduction Details\n--------------------\n\nTo reproduce this finding, issue the following command.\n\n```\nget-itemproperty hklm:\\system\\currentcontrolset\\services\\snmp\\parameters\\validcommunities\n```\n\nWindows versions prior to 2012 did not support SNMPv3.\n\n* https://docs.microsoft.com/en-us/windows/win32/snmp/supported-versions?redirectedfrom=MSDN\n\nSNMP was deprecated in 2012.\n\n* https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/hh831568(v=ws.11)?redirectedfrom=MSDN\n\nSystems Affected\n----------------\n\n  * ***SYSTEM***\n\nSeverity\n--------\n\nMedium – By using insecure network management, the implementation remains vulnerable to traffic sniffing for any attacker who might gain access to the network. The type of information typically provided over SNMP includes that which might help an attacker enumerate hosts, devices, and possibly even acquire passwords.\n\nThis issue indicates a lack of adherence to:\n\n* NZISM 18.1. Network Management\n\nRecommendation\n--------------\n\nOlder version of SNMP should be replaced with SNMPv3 or a more secure solution, and segregated to a dedicated management network, or it should be disabled.\n"},{"title":"WHR-X Insecure User Rights","category":"Windows Host Review","contents":"WHR-X Insecure User Rights\n==========================\n\nDescription\n-----------\n\nSome user rights settings which might provide more functionality than necessary.\n\n* All users (Everyone), including Pre-Windows 2000 access, on the network can connect to services, such as shares and printers, and can log on locally.\n* Non-administrative users may log on locally and through remote desktop.\n* Local accounts have not been explicitly denied access from the network.\n* Print operators have not been denied the ability to load device drivers.\n* Non-administrative users may shut down the system.\n\nReproduction Details\n--------------------\n\nIssue the following command from PowerShell.\n\n```\nsecedit /export /cfg C:\\temp\\secedit.inf /log C:\\temp\\secedit.log\n```\n\nReview the section [Privilege Rights] in secedit.inf. See the following link to aide translation of SID to description.\n\n* https://msdn.microsoft.com/en-us/library/cc980032.aspx\n\nSystems Affected\n----------------\n\n  * ***SYSTEM***\n\nSeverity\n--------\n\nMedium – These configuration settings do not meet the recommended good business practice. Changing these settings to be in-line with a security benchmark will further harden the system by reducing possible attack vectors.\n\nThis finding indicates a lack of adherence to:\n\n* NZISM 14.1. Standard Operating Environments\n* NZISM 16.1. Identification and Authentication\n\nRecommendation\n--------------\n\nChange the following settings via group policy. Verify that these settings do not break intended functionality.\n\n* Set \"Access this computer from the network\" to \"Administrators\"\n* Set \"Allow log on through Remote Desktop Services\" to \"Administrators\" and \"Remote Desktop Users\"\n* Set \"Deny access to this computer from the network\" to \"Guests, Local account\"\n* Set \"Load and unload device drivers\" to \"Administrators\"\n* Set \"Shut down the system\" to \"Administrators\"\n"},{"title":"WHR-X Insufficient Auditing","category":"Windows Host Review","contents":"WHR-X Insufficient Auditing\n===========================\n\nDescription\n-----------\nSeveral auditing settings do not meet the recommendations of the Center for Internet Security (CIS).\n\n* https://www.cisecurity.org/cis-benchmarks/\n\nThe following settings disagree.\n\n[The settings in disagreement with CIS]\n\nReproduction Details\n--------------------\nTo see the audit policy settings, issue the following command from PowerShell.\n\n```\nauditpol /get /category:*\n```\n\nCompare these results with the operating system benchmark issued by CIS.\n\nSystems Affected\n----------------\n  * ***SYSTEM***\n\nSeverity\n--------\nLow – Without proper auditing, the chances of suspicious events going unnoticed is higher.\n\nThis finding indicates a lack of adherence to:\n\n* NZISM 16.6. Event Logging and Auditing\n\nRecommendation\n--------------\nEnsure that proper auditing occurs by selecting the settings recommended by the CIS benchmark.\n"},{"title":"WHR-X Insufficient HID and Anti-malware","category":"Windows Host Review","contents":"WHR-X Insufficient HID and Anti-malware\n=======================================\n\nDescription\n-----------\nThe malware definitions of the native windows anti-malware software are outdated. The server will not be protected against newer malware or newer variants of malware.\n\nA full scan has never been performed.\n\nThere was no additional host-based intrusion detection software (IDS) installed. Host-based IDS monitors the integrity of system objects such as critical system or application files, identifies changes to those objects and generates an alert or report for investigation.\n\n```\nAntispywareSignatureAge         : 200\nAntivirusSignatureAge           : 200\nFullScanAge                     : 4294967295\nNISSignatureAge                 : 200\nQuickScanAge                    : 0\n```\n\nReproduction Details\n--------------------\nTo see the anti-malware status, issue the following command.\n\n```\nget-mpcomputerstatus\n```\n\nSystems Affected\n----------------\n  * ***SYSTEM***\n\nSeverity\n--------\nMedium – Insufficient protection from malware has been configured, so infections might go undetected and unquarantined. There is no mechanism for identifying changes to critical system files or other system objects. As a result, a malicious user or attacker could make changes to the system without detection.\n\nThis finding indicates a lack of adherence to:\n\n* NZISM 14.1. Standard Operating Environments\n\nRecommendation\n--------------\nThe standard antivirus product of the organisation should be configured to run on-access scans and regular full scans of the file system. Ensure that the Antivirus solution receives definition updates daily, and that alerts are logged centrally and actioned appropriately. A failure to update definitions or other anti-malware failure should trigger an alert and be investigated. In addition, Lateral Security recommends the use of host IDS software to monitor critical system and application files and report any unauthorised changes to these files.\n\n"},{"title":"WHR-X Local Administrator Not Renamed","category":"Windows Host Review","contents":"WHR-X Local Administrator Not Renamed\r\n=====================================\r\n\r\nDescription\r\n-----------\r\nThe built-in, local, administrator account has neither been renamed from \"Administrator\" to a unique value, nor has it been disabled. The local Administrator account is a common target for attackers. Account lockout policies do not apply to this account, so an attacker who has knowledge of the username could repeatedly attempt to brute force the password.\r\n\r\nReproduction Details\r\n--------------------\r\nIssue the following command from PowerShell and look for \"New AdministratorName\" in the \"secedit.inf\" file.\r\n```\r\nsecedit /export /cfg C:\\temp\\secedit.inf /log C:\\temp\\secedit.log\r\n```\r\nThis will say \"Administrator\", which indicates that the account has not been renamed. To see that Administrator is enabled, issue the following command from PowerShell and look in the \"Status\" column for Administrator. This will say \"OK\", which indicates that the account is enabled.\r\n```\r\nget-wmiobject -class win32_useraccount -filter \"LocalAccount='True'\" | export-csv C:\\temp\\win32_useraccount.csv\r\n```\r\n\r\nSystems Affected\r\n----------------\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nLow – The Administrator account provides full access to the operating system, including removing or changing any of the security controls. Leaving the account enabled may provide an opportunity for an attacker to gain access to this account. This account does not lock-out. It could be vulnerable to a brute force attack. This is not a vulnerability, but it does not follow good practice.\r\n\r\nRecommendation\r\n--------------\r\nRename the local administrator account and disable it. All administration should be performed using individual domain accounts for administrative users. In addition, any use or attempted use of the local administrator account should be monitored and investigated.\r\n"},{"title":"WHR-X Logon Accounts","category":"Windows Host Review","contents":"WHR-X Logon Accounts\r\n====================\r\n\r\nDescription\r\n-----------\r\n\r\n[Include account information]\r\n\r\nReproduction Details\r\n--------------------\r\nTo see the local users on the system, issue the following command from PowerShell.\r\n\r\n    get-wmiobject -class win32_useraccount -filter \"LocalAccount='True'\"\r\n\r\nTo see the administrators on the system, issue the following command from PowerShell.\r\n\r\n    net localgroup administrators\r\n\r\nSystems Affected\r\n----------------\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nInfo – This issue is being raised to give better visibility over whom has access.\r\n\r\nRecommendation\r\n--------------\r\nReview this information. If too much access has been given, then remove the accounts which should not have access.\r\n\r\n"},{"title":"WHR-X Missing Security Updates","category":"Windows Host Review","contents":"WHR-X Missing Security Updates\n==============================\n\nDescription\n-----------\nThe hosts are missing patches from the vendor. The vendor has deemed one of the patches critical. Patching is one of the critical controls published by CERT NZ and part of the Essential Eight mitigations published by the Australian Signals Directorate to help prevent compromise.\n\n[include Microsoft security bulletins and ratings]\n\nReproduction Details\n--------------------\nTo see that the system is missing security patches from the vendor, use the Microsoft Baseline Security Analyzer.\n* https://www.microsoft.com/en-nz/download/details.aspx?id=7558\n\nTo see the frequency of patching, issue the following command.\n```\nget-hotfix\n```\n\nSystems Affected\n----------------\n  * ***SYSTEM***\n\nSeverity\n--------\nHigh – The missing patches include fixes for vulnerabilities, remote code execution and privilege escalation. Were an attacker to successfully exploit the vulnerabilities, the host would be compromised. The host could then be used as a platform to launch other attacks within the environment.\n\nThis finding indicates a lack of adherence to:\n\n*  NZISM 12.4.4.\n\nRecommendation\t\n--------------\nEnsure that the host is patched and that a patching policy clearly delegates patch release monitoring and patch application responsibility. All critical vulnerabilities should be patched within 48 hours of their publication. Perform regular audits of these processes.\n"},{"title":"WHR-X No Application Whitelisting","category":"Windows Host Review","contents":"WHR-X No Application Whitelisting\n=================================\n\nDescription\n-----------\n\nApplication whitelisting is not enabled. Application Whitelisting helps prevent the execution of files which have not been explicitly allowed. Application whitelisting is one of the critical controls published by CERT NZ and part of the Essential Eight mitigations published by the Australian Cyber Security Centre to help prevent compromise.\n\n* https://www.cert.govt.nz/it-specialists/critical-controls/application-whitelisting/\n* https://www.cyber.gov.au/publications/essential-eight-explained\n\nThere are multiple tools available for implementing Application Whitelisting depending on the environment. Windows Defender Application Control is the current method recommended by Microsoft for Windows 10 build 1903+ and Windows Server 2016 and above. AppLocker is an older technology which may be suitable if the environment is mixed and there is a need/requirement to have the same policies applied. AppLocker may also be more suitable if different policies need to be applied to different users on shared PCs.\n\nReproduction Details\n--------------------\n\nTo see that Windows Defender Application Control is not enabled, view the following record within Group Policy:\n\n  * Computer Configuration > Administrative Templates > System > Device Guard\n\n\nTo see that AppLocker is not enabled, issue the following command.\n\n```\nget-applockerpolicy -effective\n```\n\nSystems Affected\n----------------\n\n  * ***SYSTEM***\n\nSeverity\n--------\n\nMedium – A standard system installation contains many executables which might not be required for the intended purpose of the system. Without application whitelisting, an attacker could take advantage of a vulnerability in one of these system executables, or could execute an arbitrary file from a location which the attacker may write to. Application whitelisting decreases the attack surface of a system.\n\nThis finding indicates a lack of adherence to:\n\n* NZISM 14.1. Standard Operating Environments\n* NZISM 14.2. Application Whitelisting\n\nRecommendation\n--------------\n\nEnable Application Whitelisting to harden systems. The configuration should explicitly allow only approved applications. For recommendations on the overall approach, see:\n\n  * https://www.cert.govt.nz/it-specialists/critical-controls/application-allowlisting/implementing-application-whitelisting/\n\nA baseline of recommendations can be found at the link below under the subsection, \"6.4 AppLocker configuration\".\n\n  * https://www.gov.uk/government/publications/end-user-devices-security-guidance-windows-10/end-user-devices-security-guidance-windows-10#recommended-policies-and-settings\n"},{"title":"WHR-X No BitLocker Encryption","category":"Windows Host Review","contents":"WHR-X No BitLocker Encryption\n=============================\n\nDescription\n-----------\nFull disk encryption is not enabled. Some data on the systems remains unsecured at rest. Data at rest is that which remains stored on a medium, usually a hard drive or another block device. Microsoft provides a solution, known as BitLocker, for encrypting data at rest.\n\nReproduction Details\n--------------------\nTo see that BitLocker is not enabled, issue the following command in PowerShell.\n```\nget-bitlockervolume\n```\n\nSystems Affected\n----------------\n  * ***SYSTEM***\n\nSeverity\n--------\nLow – Securing data at rest helps prevent the loss of sensitive data after the physical hardware has been disposed of due to end of life or failure. Encrypting storage also helps mitigate the negative consequences of hardware theft. If hardware, which contains sensitive data is released to the public, the data could be used to harm the reputation of the organisation.\n\nRecommendation\n--------------\nEnsure that BitLocker drive encryption has been enabled on the host. See the link below for more information on enabling BitLocker.\n  * https://docs.microsoft.com/en-nz/windows/security/information-protection/bitlocker/bitlocker-how-to-deploy-on-windows-server\n"},{"title":"WHR-X No Centralised Logging","category":"Windows Host Review","contents":"WHR-X No Centralised Logging\r\n============================\r\n\r\nDescription\r\n-----------\r\nLateral Security did not identify a central logging configuration. Centralised Logging on Windows servers is commonly performed using event log forwarding to send event logs to a central log host, using a syslog agent, or by using a remote collector to pull logs to a central log host. Centralised logging provides a more comprehensive view of an environment.\r\n\r\nReproduction Details\r\n--------------------\r\nIssue the command below from PowerShell. Note that no computers are a member of this group.\r\n```\r\nnet localgroup \"event log readers\"\r\n```\r\nIssue the command below from PowerShell. Note that no third-party, centralised logging software has been installed.\r\n```\r\nget-wmiobject win32_product\r\n```\r\n\r\nSystems Affected\r\n----------------\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nMedium – Were a compromise to occur, the attacker might erase or manipulate local logs, hindering incident response. This finding indicates that systems might not be actively monitored, since systems would have to be monitored individually, which is unlikely. Without centralised logging, the synthesis of events from multiple systems and devices within the environment into a timeline becomes more difficult.\r\n\r\nThis finding indicates a lack of adherence to:\r\n\r\n* NZISM 14.1. Standard Operating Environments\r\n\r\nRecommendation\r\n--------------\r\nLateral Security recommends sending all critical log files to a dedicated, central log server. Critical logs include event logs, IIS logs, and other application logs. The mechanism for this is dependent on the hosting infrastructure, storage, and logging infrastructure available. Syslog is a suitable remote logging mechanism for a mixed environment, as it is supported by a variety of platforms including network devices and Linux/Unix hosts.\r\n"},{"title":"WHR-X No Host IDS software on Servers","category":"Windows Host Review","contents":"WHR-X No Host IDS software on Servers\r\n=====================================\r\n\r\nDescription\r\n-----------\r\nWhile the servers were found to have Symantec Endpoint Protection (SEP) antivirus installed and active and performing regular scans, the Host based IDS component of SEP is not installed for the servers. There was no additional host-based intrusion detection software installed. Host-based IDS monitors the integrity of system objects such as critical system or application files, identifies any changes to those objects and generates an alert or report for investigation. \r\n \r\nSystems Affected\r\n----------------\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nLow – While the servers have current antivirus software installed to protect against known malware, there is no mechanism for identifying changes to critical system files or other system objects. As a result, a malicious user or attacker could make changes to the system without detection.\r\n\r\nRecommendation\r\n--------------\r\nLateral Security recommends that the servers are configured with the organisation's standard antivirus product, configured to run on-access scans and regular full scans of the file system. Ensure that the Antivirus solution receives definition updates on a daily basis, and that alerts are logged centrally and actioned appropriately. In addition, Lateral Security recommends the use of host IDS software to monitor critical system and application files on the server, and report any unauthorised changes to these files.\r\n"},{"title":"WHR-X No Host Based Firewall","category":"Windows Host Review","contents":"WHR-X No Host Based Firewall\r\n============================\r\n\r\nDescription\r\n-----------\r\nA host based firewall has not been enabled. Host based firewalls are an important part of defence in depth, working in tandem with a network firewall to ensure that communication, unrequired by an implementation, is blocked. Host based firewalls also help prevent the spread of a successful attack if network penetration has been achieved.\r\n\r\nReproduction Details\r\n--------------------\r\nReview the \"Windows Firewall with Advanced Security\" application.\r\n\r\nSystems Affected\r\n----------------\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\nMedium – If an attacker can compromise a system within the same security zone, network, or some other domain that has access to this reviewed system, compromise of the latter system might be possible.\r\n\r\nThis finding indicates a lack of adherence to:\r\n\r\n* NZISM 14.1. Standard Operating Environments\r\n\r\nRecommendation\r\n--------------\r\nEnsure that systems are configured with a host-based firewall, which permits only required traffic, both inbound and outbound. Restricting network access on network firewalls as well as on host systems adheres to the defence in depth security doctrine.\r\n"},{"title":"WHR-X Request Filtering Not Configured","category":"Windows Host Review","contents":"WHR-X Request Filtering Not Configured\n======================================\n\nDescription\n-----------\nLateral Security identified that inbuilt Request Filtering in IIS has not been fully configured on the servers. Request filtering allows an administrator to filter file extensions, HTTP verbs, high bit characters, double encoded requests, and other content. In the present configuration, all file extensions are allowed and high bit characters are allowed. In addition, the servers do not have the OPTIONS or TRACE HTTP verbs in their block list, and all valid HTTP verbs are allowed.\n\nSystems Affected\n----------------\n  * ***SYSTEM***\n\nSeverity\n--------\nLow – An attacker could bypass security measures in the application by encoding content, using special characters or utilising file extensions and HTTP verbs that are not actively in use.\n\nRecommendation\n--------------\nConfigure Request Filtering in line with the Centre for Internet Security guidelines for securing IIS 8. This includes disallowing unlisted file extensions, disabling the HTTP TRACE verb, disallowing high bit characters (non-ASCII characters) and disallowing double encoded requests. Request filtering is considered a defence-in-depth measure that reduces the risk of a misconfiguration or vulnerability being exploited.\n"},{"title":"WHR-X Security Configuration and Hardening","category":"Windows Host Review","contents":"WHR-X Security Configuration and Hardening\n==========================================\n\nDescription\n-----------\n\nThere are several security configuration settings and changes on the server that would improve the security of the operating system build.\n\n***OBVIOUSLY CHANGE THESE***\n\nThese settings are as follows:\n\n* Rename the 'Guest' Account\n* Set 'User Account Control: Admin Approval Mode for the Built-in Administrator account' to 'Enabled'.\n* Set 'Interactive logon: Number of previous logons to cache (in case domain controller is not available)' to '0'\n* Set 'Interactive logon: Do not display last user name' to 'Enabled'\n* Set 'Microsoft network client: Digitally sign communications (always)' to 'Enabled'\n* Set 'Microsoft network server: Digitally sign communications (always)' to 'Enabled'\n* Set 'Network security: Allow Local System to use computer identity for NTLM' to 'Enabled'\n* Set the User right 'Access this Computer from the Network' to 'Administrators, Authenticated Users'\n* Set the User right 'Bypass Traverse Checking' to 'Administrators, Users, Backup Operators, Local Service, Network Service'\n* Set the User right 'Allow log on locally' to 'Administrators'\n* Set 'Turn off Autoplay on:' to 'Enabled:All drives'\n* TCP/IP Stack Hardening in line with the MSS Settings in the CIS Security Guide for Windows Server 2012 section 1.1.3.10\n\nReproduction Details\n--------------------\n\nTo see the services running on the system, issue the following command. Note that the services enumerated in the description are running.\n\n```\nauditpol /get /category:*\n```\n\nSystems Affected\n----------------\n\n  * ***SYSTEM***\n\nSeverity\n--------\n\nLow – While none of these will lead to an immediate compromise of the system or network, without hardening, the chances of an attack being successful are higher.\n\nRecommendation\n--------------\n\nAudit and harden the Operating Systems of the server in line with the CIS Windows Server 2012 Benchmark or the Microsoft Security Configuration guide for Windows Server 2012. Ensure that the required settings are documented, and that any deviations from the standards are noted and have a proper business justification.\n"},{"title":"WHR-X Unhardened Webserver Configuration","category":"Windows Host Review","contents":"WHR-X Unhardened Webserver Configuration\n========================================\n\nDescription\n-----------\n\nThe IIS webserver has not been configured to meet good security recommendations. Some of the settings which might weaken the service include:\n\n* Numerous application pools have not been set to use ApplicationPoolIdentity instead of NetworkService. ApplicationPoolIdentity assigns a separate identity for each application pool instead of running all application pools under the same shared account. All sites except ***HOST*** run as “NetworkService” identity.\n* The default application pool identity is not set to ApplicationPoolIdentity.\n* Some secure communication is not enabled.\n    - Some websites do not require transport layer security, which would affect any Basic authentication. (See Appendix B for an enumeration.)\n    - Form submitted information will not require transport layer security.\n* Some cookie settings are not secure.\n    - The session state does not require cookies. Instead it stores session in the URI.\n    - The server will not issue the HttpOnly on cookies.\n    - Form authentication has not been restricted to cookies only.\n* The global .NET trust level has not been set to “Medium” or something more restrictive.\n* Non-ASCII characters are allowed in URLs.\n* The debugging method, HTTP Trace, is enabled.\n* All file extensions are allowed.\n* The content for some sites is located on the system drive. (See Appendix B.)\n* The default IIS log directory has not been moved off the system drive.\n* Deployment has not been set to “retail”.\n\nReproduction Details\n--------------------\n\nThese settings were observed in the XML of the applicationHost.config file. A lack of some settings indicates that an insecure default is configured.\n\nSystems Affected\n----------------\n\n* ***SYSTEM***\n\nSeverity\n--------\n\nMedium – If data is sent unencrypted to the web server, then an attacker might capture and exfiltrate or alter the data. The organisation could suffer reputational damage from malicious use or leaks of the data.\n\nIf cookies are not required for authentication, then the URI will be used. This method of authentication exposes sensitive information to being captured by proxies, scripts through the browser API. If the HttpOnly flag is not set, then cookies storing sensitive information, such as the session, might be maliciously manipulated by a client-side script, allowing an attacker to steal the session.\n\nThese and other enumerated settings indicate a lack of hardening of the web server. An attacker could use this configuration to gain information about the server, deny service, or exploit the server host in some other way.\n\nThis finding indicates a lack of adherence to:\n\n* NZISM 14.1. Standard Operating Environments\n\nRecommendation\n--------------\n\nEnsure that the webserver has been hardened according to a well-known security benchmark, such as one provided by the Center for Internet Security or according to a Security Technical Implementation Guide (STIG).\n\n"},{"title":"WHR-X Weak Account Policy","category":"Windows Host Review","contents":"WHR-X Weak Account Policy\r\n=========================\r\n\r\nDescription\r\n-----------\r\n\r\nSeveral account policies on the host are not in line with good practice. These settings can be inherited from Group Policy for the domain, but are sometimes set locally on the host.\r\n\r\nThe current settings, which are weaker than recommended, are:\r\n\r\n* Maximum Password Age - 120\r\n* Minimum Password Age - 0 days\r\n* Minimum Password Length - 8 Characters\r\n* Enforce Password History - 5\r\n* Account lockout threshold - 15\r\n* Network security: Force Logoff when hours expire - not enabled\r\n\r\nReproduction Details\r\n--------------------\r\n\r\nIssue the following command from PowerShell.\r\n\r\n```\r\nsecedit /export /cfg C:\\temp\\\"$env:computername\"\\secedit.inf /log C:\\temp\\\"$env:computername\"\\secedit.log\r\n```\r\n\r\nReview the \"System Access\" section of the output.\r\n\r\nSystems Affected\r\n----------------\r\n  * ***SYSTEM***\r\n\r\nSeverity\r\n--------\r\n\r\nMedium – The current password policies would allow a user to set a password that is relatively short and would allow the user to change passwords in rapid succession, bypassing the password history enforcement. In addition, users will not be forced to log off after business hours. These settings to not follow good practice.\r\n\r\nIn 2012, a demonstration showed that 8-character passwords composed randomly from the characters which can be typed from a standard keyboard could be cracked in about 6 hours with the right equipment. Hardware performance has improved since then.\r\n\r\nLeaving accounts logged in when not necessary provides attack paths for privilege escalation within a domain.\r\n\r\nThis finding indicates a lack of adherence to:\r\n\r\n* 16.1. Identification and Authentication\r\n\r\nRecommendation\r\n--------------\r\n\r\nTo improve defence in depth, Lateral Security recommends the following account policy settings:\r\n\r\n* Maximum Password Age - 60 days\r\n* Minimum Password Age - 1 Day\r\n* Minimum Password Length - 16 Characters\r\n* Password History - 24 Passwords Remembered\r\n* Account lockout threshold - 1-10 attempts\r\n* Network security: Force Logoff when hours expire - enabled\r\n"},{"title":"WHR-X Weak File Permissions","category":"Windows Host Review","contents":"WHR-X Weak File Permissions\r\n===========================\r\n\r\nDescription\r\n-----------\r\n***Explain the directories and permissions identified***\r\n\r\nReproduction Details\r\n--------------------\r\nReview the permissions applied to ***LOCATION***.\r\n\r\nSystems Affected\r\n----------------\r\n  * ***SERVER***\r\n\r\nSeverity\r\n--------\r\nHigh – An attacker that gained access as an unprivileged user could overwrite the ***APPLICATION*** binaries and effectively gain the ability to execute arbitrary code with the privileges of any user who logged in to the system afterwards.\r\n\r\nRecommendation\r\n--------------\r\nLateral Security recommends ensuring that all folder are assigned the minimum required permissions for the operation of the server. In this case, removing the ***GROUP*** group from having write access to the folders and instead granting the appropriate application user or groups access is recommended.\r\n"},{"title":"WHR-X Web Logs Stored on System Drive","category":"Windows Host Review","contents":"WHR-X Web Logs Stored on System Drive\n=====================================\n\nDescription\n-----------\nLateral Security discovered that the web servers reviewed had IIS log settings configured to log to the system drive (C :). Web data and logs should be kept on a separate partition from the system drive to ensure that a denial-of-Service condition is not created if a web application fills the disk.\n\nSystems Affected\n----------------\n  * ***SYSTEM***\n\nSeverity\n--------\nLow – A Denial-of-Service condition could be created if a web application creates enough data to fill the system drive. Additionally, if hosted web applications are found to be vulnerable to a directory traversal attack, the logs may be retrieved by a remote attacker.\n\nRecommendation\n--------------\nEnsure all web content and web logs are stored on a separate partition from the system partition, so that if the disk is filled it does not cause a Denial of Service condition. In addition, log files should be copied to a separate log server for analysis and reporting.\n"},{"title":"WHR-X Weak File Permissions","category":"Windows Host Review","contents":"WHR-X Weak File Permissions\r\n===========================\r\n\r\nDescription\r\n-----------\r\nMultiple directories were identified with weak permissions. The antivirus software contained logs which were world-writable by all users on the systems. \r\nThese were found in numerous locations under:\r\n  * location...\r\n\r\nReproduction Details\r\n--------------------\r\nReview the permissions applied to ***LOCATION***.\r\n\r\nSystems Affected\r\n----------------\r\n  * ***SERVER***\r\n\r\nSeverity\r\n--------\r\nLow – If an attacker were to gain low-level privileges on the servers using an exploit which the antivirus software alerted on, then they could erase evidence of that.\r\n\r\nRecommendation\r\n--------------\r\nLateral Security recommends ensuring that all folders are assigned the minimum required permissions for the operation of the server. In this case removing write access to the log folders and instead granting only the necessary application users or groups access is recommended."},{"title":"WR-X TEMPLATE","category":"Wireless Review","contents":"WR-X TEMPLATE\n===============================\n\nDescription\n-----------\n\n\nReproduction Details\n--------------------\n\n\nSystems Affected\n----------------\nThe following networks are affected by this issue: \n  * ***SITE***\n\n\n  Severity\n--------\nInfo – \n\n\nRecommendation\n--------------\n\n\n"},{"title":"WR-X Common Wireless Attacks","category":"Wireless Review","contents":"WR-X Common Wireless Attacks\n===============================\n\nDescription\n-----------\nThe following is a summary of the inherent weaknesses is various WiFi technologies:\n\n*\tOPEN – Clients can connect without any credentials. Communications are sent in the clear and can be passively observed over the air. In cases where captive portals are used, access can usually be trivially gained via MAC address spoofing, password sniffing (unencrypted portals), or evil twin attacks (pretending to be the access point and hosting a fake captive portal to capture credentials).\n*\tWEP – Clients authenticate using a hex-string based password. An attacker can trivially defeat this via online bruteforce attacks. It has largely been phased out of use and is typically only seen on older (pre-2005) devices, or where compatibility with legacy clients is a requirement.\n*\tWPA(2) PSK (Pre-shared Key) – Client authenticate using a password specific to the access point. An attacker can passively observe the authentication flow of a legitimate client and use this information to perform offline bruteforce attacks against the password. \n*\tWPA/WPA2 WPS (Wi-Fi Protected Setup) – A client typically pushes a  physical button on the client or access point. This is typically found on domestic routers and while it can be secure in theory, many early implementations contained flaws which permitted trivial online brute-forcing of the key without physical access to the router.\n*\tWPA Enterprise (Radius) – Clients authenticate using their Active Directory credentials. An attacker can impersonate the access point (Evil Twin), capture an authentication request, then leverage this in offline bruteforce attacks. This would give the attacker full, valid, Active Directory credentials.\n*\tWPA Enterprise (Certificate) – Clients authenticate using an issued certificate, preferably unique to the device or user. This is similar to the Radius variant, except the password is guaranteed to be complex as it is based on certificates rather than user selection.\n\nWi-Fi connections (independent of authentication mechanism) are commonly vulnerable to denial-of-service attacks from attackers sending targeted disconnect (deauthentication, or ‘deauth’) requests, unless the Protected Management Frames feature (802.11w) is enabled on the access point and supported by connected devices. Deauth messages exist in a protocol layer higher than the encrypted communications.\nAn attack titled “KRACK” was identified in 2017, which potentially allows attackers to decrypt and inject traffic in wireless connections. This is a complex attack which relies on vulnerabilities within wireless clients rather than the access points. It has been noted to raise awareness of the weakness; however, it is expected that it would only be leveraged by skilled targeted attackers.\n\n\nReproduction Details\n--------------------\n\nMost operating systems provide indications of what authentication mechanism an access point uses. The following tools can also display this textually:\n```\niw {interface} scan\nairodump-ng {interface}\n```\n\nSystems Affected\n----------------\nThe following networks are affected by this issue: \n***INSERT TABLE OF [ SSID | Authentication Type | Qualitative Strength Description | Notes / Comments ]***\n\n  Severity\n--------\nMedium – \n*** Qualitative comments on consistency with client expectations and specific impact example of worst case network ***\n\nIf any of the pre-shared keys are considered compromised; for example: authenticated devices are lost, or IT staff leave the organisation - then changing the password across all registered devices would be labour-intensive.\n\nRecommendation\n--------------\n\n*** Tweak this as required ***\nLateral Security recommends:\n* Developing a policy to update PSK passwords when devices are compromised, or IT staff leave the organisation\n* Considering the use of per device certificates on mobile devices\n* Consider unifying access points which provide identical functionality\n\n"},{"title":"WR-X Guest Access to Internal DNS","category":"Wireless Review","contents":"WR-X Guest Access to Internal DNS\n===============================\n\nDescription\n-----------\nDomain Name System (DNS) is a concept which maps human-readable names to machine interpretable IPs. \nThese names typically relate to the purpose of the host, providing hints towards which servers contain information of use to an attacker.\nLateral Security noted that the internal DNS server (which knows about hosts on private subnets) was directly accessible from untrusted networks. \nThis provides attackers information regarding the internal structure of the network, without providing any form of trust.\n\n\nReproduction Details\n--------------------\nConnect to the affected network and perform reverse DNS lookups:\n```\nReverse DNS:\nnmap -Pn -sn -R *{IP_RANGE}*\n**or**\ndig -x *{IP}*\n```\n\n\nSystems Affected\n----------------\nThe following untrusted networks are affected by this issue: \n  * ***SITE***\n\n\n  Severity\n--------\nLow – This information may be leveraged to identify potential targets of value, specifically hosts with interesting reverse DNS names. \nAny information gained gives an attacker a slight advantage over going in without any guidance.\n\n\nRecommendation\n--------------\n\nLateral Security recommends reviewing the accessibility of internal DNS servers on untrusted networks, opting to use only public DNS server where possible. \nNetworks which allow access to internal hosts (intranet) should continue to use the internal DNS.\n"},{"title":"WR-X Missing Active Monitoring","category":"Wireless Review","contents":"WR-X Missing Active Monitoring\n===============================\n\nDescription\n-----------\nActive monitoring is a mechanism which reviews network activity, flagging suspicious behaviour to IT staff. \nThis control provides early warning for active attacks, giving staff the ability to quickly investigate malicious activity before it escalates to compromised access.\n\n\nReproduction Details\n--------------------\nPerform suspicious activities (running rogue access points, port scanning, etc) and observe that this is not automatically alerted to IT staff.\n\n\nSystems Affected\n----------------\nThe following networks are affected by this issue: \n  * ***SITE***\n\n\n  Severity\n--------\nInfo – This issue has been included to raise awareness of further protections which could be established. \nA lack of active monitoring does not represent a directly exploitable vulnerability.\n\n\nRecommendation\n--------------\nLateral Security recommends reviewing options for active monitoring, implementing solutions if deemed appropriate by the organisation.\n"},{"title":"WR-X Missing Client Isolation","category":"Wireless Review","contents":"WR-X Missing Client Isolation\n===============================\n\nDescription\n-----------\n\nClient Isolation is a security control which prevents communication between wireless peers. This control limits the impact that users can have on other users of the system.\nLateral Security identified networks which permit communication between users (of the same access point); subsequently, active man-in-the-middle attacks would be possible.\nIn addition to active man in the middle attacks, if a device were to be compromised with malware, this could spread to other devices.\n\n\nReproduction Details\n--------------------\n*** TWEAK AS REQUIRED ***\nConnect two devices to the a given network, identifying that clients can access servers across devices.\n```\nSERVER:\nnc -lvvp 1234\n\nCLIENT:\nnc -vv {server_ip} 1234\n```\n\nThis can also be observed within configuration exports: \nno  wireless-to-wireless-isolation\n\n\nSystems Affected\n----------------\nThe following networks are affected by this issue: \n  * ***SITE***\n\n\n  Severity\n--------\nLow – Wireless clients can communicate directly with each other. Attackers would be able to access services (like public file shares) on other devices connected to the same network.\n\n\nRecommendation\n--------------\nLateral Security recommends reviewing whether peer to peer communication is a business requirement for the affected network ***(s)***, disabling this functionality where it is not required."},{"title":"WR-X Shared External IP","category":"Wireless Review","contents":"WR-X Shared External IP\n===============================\n\nDescription\n-----------\n*** Delete sentences which are not applicable ***\nLateral Security identified that the public facing IP of all access points resolved to a single IP.  \nWhile it is not unusual to route all traffic out through a single IP, \nit is noted that users on the guest WiFi would be able to access any third-party resources which had been explicitly whitelisted to the organisation’s IP.\n\n\nReproduction Details\n--------------------\n\nTo enumerate publicly facing IPs, use an IP reflection service, such as:\n```\nhttps://ident.me/ \n```\n\nSystems Affected\n----------------\nThe following networks are affected by this issue: \n  * ***SITE***\n  \nUsing an external IP Address of\n```\n*** EXTERNAL IP ADDRESS ***\n```\n\n  Severity\n--------\n*** Tweak as required ***\nLow – Users on the wireless network (which may be less trusted than users on the wired network) \ncould access any external resources which have been IP-whitelisted to the organisation’s public IP address. \nThe impact of this would depend on what services have been provided.\n\nThe organisations mail server (*** SERVER ***) has an MX record which also resolves to this address.\nThis allows users on the guest network to easily send emails to third parties, appearing to originate from the legitimate server.\n\n\nRecommendation\n--------------\n\nLateral Security recommends reviewing the shared use of outbound traffic. \nConsider using a dedicated outbound gateway for less-trusted users. \nIt is noted that this solution would introduce significant complexity into the network design.\n"}]
