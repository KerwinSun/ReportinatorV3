INP-X Offline Password Bruteforce Through Kerberoasting
=======================================================

Description
-----------
Lateral Security performed an attack using a provided low privileged user account which takes advantage of the Kerberos authentication mechanism and how service accounts work (known as Kerberoasting). Any domain user can request service tickets (TGTs) for service accounts that have the Service Principle Name (SPN) value set. By design, Active Directory returns an encrypted ticket that uses the NTLM hash of the account that is associated to the specified SPN as an encrytion key.



Systems Affected
----------------
The following service principles are affected by this issue:
  * ***List the principles and names***

Severity
--------
Medium – If an attacker were to compromise a user account then perform a Kerberoasting attack, they will be able to obtain an encrypted NTLM hash which can then be subjected to a brute force dictionary cracking attempt. Because the brute force attack is carried out locally by the user without further interaction with network resources, attempting to crack the encrypted ticket cannot be detected and will not cause a user’s account to become locked out.

Recommendation
--------------
Although this attack allowed access to the tickets, Lateral Security was unsuccessful in cracking these captured tickets during the course of the engagement. An adversary may not be limited to time or technical constraints. Therefore, it is recommended to ensure service accounts that use Kerberos authentication with SPN values are configured with complex and long passwords.

Group managed service accounts can leverage random, complex passwords that are automatically rotated centrally in Active Directory.

For more information, see:
  * https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and2012/hh831782(v=ws.11)?redirectedfrom=MSDN
