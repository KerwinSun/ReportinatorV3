INP-X Insecure RDS
==================

Description
-----------
The remote desktop service (RDS) does not require that administrators use network level authentication (NLA) during login. NLA forces a client computer to present credentials for authentication before the server will create a session for the user. Because a full session is not created until this authentication occurs, the chance of denial of service is reduced.

The RDS configuration enables the weak cryptographic algorithms, RC4 and MD5.

RC4 has small biases in its generated ciphertext. After the encryption of a given plaintext many times, the probability to decrypt the ciphertext approaches near certainty.
  * http://blog.cryptographyengineering.com/2013/03/attack-of-week-rc4-is-kind-of-broken-in.html

MD5 is an algorithm which is known not to be collision resistant. As a result, exploits of MD5 have made it possible to fake SSL certificate validity.
  * http://www.kb.cert.org/vuls/id/836068

Reproduction Details
--------------------
Use a tool, such as Nessus, to scan the internal network for vulnerabilities. The report will indicate these weaknesses.

Systems Affected
----------------
The following systems are affected by this issue:
  * ***SYSTEM***

Severity
--------
Medium â€“ The current RDS configuration is vulnerable to a man-in-the-middle attack. An attacker could hijack an administrative session to steal the credentials of an administrator.

Exploitation of the cryptographic weaknesses is possible. Disclosure of sensitive information, including login credentials, might be obtained. However, the difficulty and time required for the exploitation make other attacks more attractive.

This issue indicates a lack of adherence to NZISM:
  * 17.8.14. HMAC algorithms

Recommendation
--------------
Force all RDS use to use NLA. Disable RDS on all hosts which will not require it.

Ensure that clients connect with secure cryptographic algorithms. Microsoft have a page for Server 2008 R2 RDS security settings.
  * https://technet.microsoft.com/en-us/library/cc753488.aspx
