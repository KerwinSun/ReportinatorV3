INP-X Layer 2 Information Disclosure
====================================

Description
-----------
Devices broadcast layer 2 network packets which might provide useful information to an attacker. The CDP packets being broadcast indicate the version of Cisco IOS running on a switch. The STP packets indicate that it might be possible to influence network topology.

Reproduction Details
--------------------
Use a tool, such as Wireshark, to passively listen to all packets on the link for about a minute. To ease reading, you can filter the capture so that only CDP and STP packets are shown.
Click on a CDP packet. Expand the tree until all of "Software Version" can be read.
The CDP packets indicate that version 10.0(0)A1 is running on the switch. That version has at least one published vulnerability at the time of reporting.
  * CVE-1993-0900

Systems Affected
----------------
The following systems are affected by this issue:
  * ***SYSTEM***

Severity
--------
Medium â€“ The information provided by these packets could help an attacker learn which exploits the broadcasting device is vulnerable to. In this case, the version of IOS on the switch has at least one vulnerability. The CDP packets also indicate the native VLAN of the switch.

This issue indicates a lack of adherence to NZISM:
  * 18.1.13. Management Traffic

Recommendation
--------------
Disable CDP packet broadcasts. STP packets should not be disabled, but, instead, ensure that Cisco's BDPU guard is enabled, if not already, on all ports which connect to client hosts and devices to prevent those from affecting the network topology. Cisco provide documentation on this feature:
  * http://www.cisco.com/c/en/us/support/docs/lan-switching/spanning-tree-protocol/10586-65.html

Other hardening should be configured on the device, if it has not already been done. Cisco provide a guide to hardening Cisco devices.
  * http://www.cisco.com/c/en/us/support/docs/ip/access-lists/13608-21.html
