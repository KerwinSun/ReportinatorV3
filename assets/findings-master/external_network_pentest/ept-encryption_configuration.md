EPT-X Weak Encryption Supported
=============

Description
-----------
Encryption is a cryptographic process to mitigate against untrusted parties reading data in transit.
It relies on two key principles: verifying the server's identity and obfuscating communications.

Servers typically verify their identity by presenting named certificates; either already known to the user or signed by a trusted party (Certificate Authority).
Clients then use this certificate to negotiate a common shared secret to encrypt traffic going forward.
Decryption of historical data may be possible if server secrets are compromised, dependent on the algorithm used to negotiate the shared secret (Perfect Forward Secrecy).

Recommended encryption practices have evolved over time as existing algorithm flaws/biases are discovered and new methods are developed to address them.
As malicious network users may be able to influence which algorithms are selected, support for protocols/ciphers containing known flaws should be explicitly disabled within server configuration.

The following mechanisms are considered weak:
* Self-signed Certificates - Does not verify the server.
* Certificates using MD5 hashes - Hash collisions are feasible.
* Certificates using SHA1 hashes - Hash collisions are feasible by state actors.
* Wildcard Certificates - Increases the impact should a certificate be compromised.
* RSA key exchange - Significantly weaker than alternatives.
* Anonymous key exchange (ADH) - Does not verify the server.
* TLSv1.1 - Has been formally deprecated, as it does not support modern ciphers.
* TLSv1.0 - Has been formally deprecated, as it has known weaknesses and does not support modern ciphers.
* SSLv2.0 / SSLv3.0 - Numerous published flaws.
* 64 bit block ciphers (3DES / DES / RC2 / IDEA) - Published weaknesses.
* RC4 - Published flaws.
* Export Grade encryption - Intentionally weak.
* Null cipher encryption - Does not encrypt.
* Not supporting "Fallback Signaling" - TLS_FALLBACK_SCSV mitigates against protocol downgrade attacks.
* Not supporting the “Extended Master Secret” TLS extension - This extension mitigates against the triple handshake attacks (3SHAKE).

In this case, ***Brief description of how bad it is...***


Reproduction Details
--------------------
Scan hosts using an SSL/TLS enumeration tool, such as sslscan (https://github.com/rbsec/sslscan) or nmap (https://nmap.org/).
Online tools are also available for externally facing systems (https://www.ssllabs.com/ssltest/).
```
sslscan {HOST}
nmap --script ssl-enum-ciphers,ssl-cert {HOST} -p {PORT}
```

Systems Affected
----------------
The following ***host(s) is/are*** affected by this issue:
  * ***SITE***

  *** You don't have to itemise everything, unless some are practically bad. ***

Severity
--------
Low – Practical exploitation of cryptographic encapsulation is typically complex; However, identification of supported ciphers is trivial.
The severity of this issue primarily relates to the ease of identification, with insecure configurations often being used by the media and general public as indicators of overall security posture. 

If left unresolved, this issue may lead to reputational impacts for the organisation.

*** Consider increasing severity if practical attacks are feasible (untrusted certificate, anonymous exchange, or null cipher) ***


Recommendation
--------------
Lateral Security recommends explicitly disabling support for insecure ciphers and protocols, with manual verification (according to reproduction details) to confirm settings have been correctly applied.
Internal documentation should be established for the commissioning of future systems to ensure appropriate settings are applied from conception.

A guide to recommended encryption practices can be found at: 
```
https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices
```

Consider applying Certificate Authority Authorization (DNS CAA) as a defense-in-depth security measure against ad-hoc certificate generation (dependent on the organisation's existing certificate deployment and management solution).
