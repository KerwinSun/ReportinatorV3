EPT-X Remote Desktop Enabled
============================

Description
-----------

The Remote Desktop Web Service (RD Web) was exposed to the Internet and using NTLM authentication. Remote Desktop commonly authenticates against Active Directory. By having this exposed, an attacker may be able to brute force domain passwords. This poses two key threats:
 * An attacker could use common dictionary words (and variations of them) across a large number of user accounts and attempt to gain access to remote desktop. This could result in remote access to machines within the network.
 * An attacker could attempt to lock out a large number of accounts by intentionally entering invalid passwords, resulting in disruptions to users and increased helpdesk calls.
 
Lateral Security did not attempt to gain access to accounts using this technique, however exploitability would depend on a number of factors, including:
 * The password policies in place
 * The account lockout policies
 * The number of users in the groups which have access
 * Whether 2FA is in use which is activated after login
 
Usernames and potentially passwords can be obtained using password leaks or open source intelligence (OSINT) databases.

Systems Affected
----------------
The following systems are affected by this issue:
  * ***HOST***
  
Severity
--------
Medium â€“ An attacker could gain access to remote desktop and gain access to the network. They could also potentially lock out user accounts.
The degree of access obtained after a successful login would depend heavily on the network architecture, the hardening of the remote desktop services/applications and the permissions provided to the compromised account.

Recommendation
--------------
This is an issue inherent in exposing Remote Desktop Web Services to the Internet, however a number of settings can be configured to mitigate the potential threats associated with it:
 * As the administrator account does not lock out, ensure the administrator account has been renamed.
 * Configure a separate Remote Access lockout policy with a lockout threshold which is less than for the on-premise domain.
 * Enable multi-factor authentication to ensure a password compromise alone would not result in remote access to systems on the network.
 * If practical, ensure the remote desktop systems are on a network zone with access to as few resources as can be achieved.
 * Ensure as few users as required have permission to log in using remote desktop. Processes should be in place for on-boarding and off-boarding, and the users in this group should be audited regularly.
 * Ensure the accounts which have remote access have only the access on the network which is required to perform their roles/functions.
 * Restrict access using IP Whitelisting, if practical.
 * Carry out hardening on any applications/servers which are exposed over remote desktop. Hardening should be in line with an industry benchmark such as those provided by the Center for Internet Security.
 * Ensure a strong password policy is in place. Lateral Security recommends it is based on the recommendations in the New Zealand Information Security Manual (NZISM).
 * Ensure logs are retained on a centralised logging server, and that these are monitored, and alerts are generated for anomalous activity.
