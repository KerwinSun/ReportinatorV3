ENP-X IKE Aggressive Mode Enabled
=================================

Description
-----------
When negotiating an IPSec VPN tunnel IKE is used, and it can operate in one of two modes either ‘Main mode’ or ‘Aggressive mode’. The Virtual Private Network (VPN) configuration ***within the firewall files provided*** was found to be running in aggressive mode, in which the number of requests is minimized and a hash of the preshared key is sent to the VPN service. The preshared key hash can be brute forced with sufficient time. The VPN’s group name also needs to be known for a successful attack.

Reproduction Details
--------------------
To reproduce this issue, run:
  * ike-scan -A ***ip***

Systems Affected
----------------
The following systems are affected by this issue:
  * ***SYSTEM***

Severity
--------
Low – An attacker can brute force the group name and encryption keys of the VPN session and gain complete access to the network. Depending on the strength of the VPN group name and pre-shared key, this may require some time, however once the group name has been established, cracking the key can be performed offline. ***In the case of trying to crack the 3DES encryption, an attacker would need to perform a man in the middle attack to intercept the traffic first.***

Recommendation
--------------
Lateral Security recommends the VPN is configured to use main mode rather than aggressive mode for the initial session establishment. This will prevent the preshared key from being disclosed. Irrespective of whether aggressive mode or main mode is used, if a preshared key is used, it should be strong (over ten characters, a mix of upper and lower case letters and numbers).
If it is not in place already, centralised logging should be considered so if attempts are made to brute force the group name, these can be observed and responded to in a prompt manner.
Finally, if the VPN is used to connect the several known locations or specific systems, IP address whitelisting should be used to prevent third parties from connecting to the VPN endpoints and attempting to crack the credentials.

