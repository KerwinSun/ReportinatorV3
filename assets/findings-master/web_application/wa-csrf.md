WA-X No Cross-Site Request Forgery Protection
=============================================

Description
-----------
Cross-Site Request Forgery (CSRF) attacks are where a third party site can embed a resource which triggers an action on the site. For example, if a bank were vulnerable to CSRF, an attacker could embed a 1x1 image on a popular forum with the source set to the following:
 * https://www.lateralsecurity.com/internetbanking/transfer?from=1&to=00-12-345678-9012345-000.

When the users of the forum browse to that page, their browsers will attempt to load the image from the bank’s servers, and if they happened to be logged in to Internet banking at the time, their cookies will be sent with the request and the transaction would be processed, transparently transferring money to the attacker.

While this simple example uses a GET request, it is possible to craft more complicated CSRF attacks using JavaScript to POST all of the required parameters to the server.

In this case ***DESCRIBE***

Reproduction Details
------------
To reproduce this issue:
  * ***REPRODUCTION STEPS***

Systems Affected
----------------
The following ***host is/hosts are*** affected by this issue:
  * ***SITE***

Severity
--------
Medium – ***DESCRIBE THE APPLICATION SPECIFIC IMPACT***

Recommendation
--------------
Lateral Security recommends implementing a cross-site request forgery defence mechanism. Ideally, this would be implemented by a framework or well-tested library. This involves a token being generated by the application, supplied to the user and checked with each state-changing request. Further detail on implementing this control is provided by OWASP:
* https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html

*** Update this based on the cookie behaviour *** Lateral Security recommends setting the SameSite cookie flag to "Strict" wherever possible, ensuring that modern browsers will only send the cookie when requests originate from the same domain. For more information on the SameSite flag and the options available, see:
  * https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite
