/*! For license information please see taskpane.js.LICENSE.txt */
(function(){var __webpack_modules__={2183:function(t,e){"use strict";function n(t,e,n,r,i,s,a){try{var o=t[s](a),c=o.value}catch(t){return void n(t)}o.done?e(c):Promise.resolve(c).then(r,i)}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,i,s,a;return e=t,i=[{key:"templateIssue",value:(s=regeneratorRuntime.mark((function t(e){var n,r,i,s,a,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=JSON.parse(localStorage.getItem("customFileData"))||[],r=e.document.getSelection(),t.next=4,r.paragraphs.getFirst().load();case 4:i=t.sent,s="",a={title:"",category:"custom_issues",contents:""};case 7:if(!i){t.next=22;break}return t.prev=8,t.next=11,e.sync();case 11:"Heading 3"===(o=i.style||i.styleBuiltIn)&&(s+=i.text+"\r\n===========================\r\n\r\n",a.title=i.text),"Heading 2"===o?s+=i.text+"\r\n-----------\r\n":"Body Text for Report"===o?s+=i.text+"\r\n":o.includes("Bullet")&&(s+="*"+i.text+"\r\n"),i=i.getNext().load(),t.next=20;break;case 17:return t.prev=17,t.t0=t.catch(8),t.abrupt("break",22);case 20:t.next=7;break;case 22:return a.contents=s,n.push(a),localStorage.setItem("customFileData",JSON.stringify(n)),t.next=27,e.sync();case 27:case"end":return t.stop()}}),t,null,[[8,17]])})),a=function(){var t=this,e=arguments;return new Promise((function(r,i){var a=s.apply(t,e);function o(t){n(a,r,i,o,c,"next",t)}function c(t){n(a,r,i,o,c,"throw",t)}o(void 0)}))},function(t){return a.apply(this,arguments)})}],i&&r(e.prototype,i),t}();e.Z=i},1621:function(t,e){"use strict";function n(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,s=function(){};return{s:s,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,c=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){c=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw a}}}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function i(t,e,n,r,i,s,a){try{var o=t[s](a),c=o.value}catch(t){return void n(t)}o.done?e(c):Promise.resolve(c).then(r,i)}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,a,o;return e=t,r=[{key:"writeIssue",value:(a=regeneratorRuntime.mark((function t(e,r,i){var s,a,o,c,u,l,h,f,p,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s=null!=i&&i.contents.includes("\r\n")?null==i?void 0:i.contents.split("\r\n").filter((function(t){return""!==t})):null==i?void 0:i.contents.split("\n").filter((function(t){return""!==t})),a=this.transformIssuesArray(s),o=e.document.getSelection(),c=n(a),t.prev=4,c.s();case 6:if((u=c.n()).done){t.next=14;break}return l=u.value,t.next=10,o.insertParagraph(l.text,r.InsertLocation.before);case 10:t.sent[l.style.type]=l.style.name;case 12:t.next=6;break;case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(4),c.e(t.t0);case 19:return t.prev=19,c.f(),t.finish(19);case 22:return t.next=24,e.document.body.search("\\*\\*\\*(*{1,})\\*\\*\\*",{matchWildcards:!0});case 24:return h=t.sent,t.next=27,h.load();case 27:return t.next=29,e.sync();case 29:f=n(h.items);try{for(f.s();!(p=f.n()).done;)(d=p.value).insertHtml(d.text.replaceAll("***",""),"Replace"),console.log(d),d.font.color="Red"}catch(t){f.e(t)}finally{f.f()}return e.document.load(),t.next=34,e.sync();case 34:case"end":return t.stop()}}),t,this,[[4,16,19,22]])})),o=function(){var t=this,e=arguments;return new Promise((function(n,r){var s=a.apply(t,e);function o(t){i(s,n,r,o,c,"next",t)}function c(t){i(s,n,r,o,c,"throw",t)}o(void 0)}))},function(t,e,n){return o.apply(this,arguments)})},{key:"getTitleIndexes",value:function(t){return t.map((function(t,e){if("---"===t.substring(0,3))return e-1})).filter((function(t){return t>=0}))}},{key:"transformIssuesArray",value:function(t){var e=[],n=!1;return t.map((function(t,r){t=t.trimStart().replace("â","-"),n?"```"===t.substring(0,3)?n=!1:e.push({text:t,style:{type:"style",name:"Code"}}):"==="===t.substring(0,3)?e[e.length-1].style={type:"styleBuiltIn",name:"Heading3"}:"---"===t.substring(0,3)?e[e.length-1].style={type:"styleBuiltIn",name:"Heading2"}:"```"===t.substring(0,3)?n=!0:"*"===t.substring(0,1)&&"**"!=t.substring(1,3)?(t=t.substring(1),e.push({text:t,style:{type:"style",name:"Bullet"}})):e.push({text:t,style:{type:"style",name:"Body Text for Report"}})})),e}}],r&&s(e.prototype,r),t}();e.Z=a},9164:function(t,e){"use strict";function n(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=i(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,s=function(){};return{s:s,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,c=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){c=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw a}}}}function r(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||i(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function a(t,e,n,r,i,s,a){try{var o=t[s](a),c=o.value}catch(t){return void n(t)}o.done?e(c):Promise.resolve(c).then(r,i)}function o(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var s=t.apply(e,n);function o(t){a(s,r,i,o,c,"next",t)}function c(t){a(s,r,i,o,c,"throw",t)}o(void 0)}))}}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.host="https://gitlab.lateralsecurity.net/api/v4/",this.token="glpat-TyaY-aaAQ8afMwTz54Cm",this.fileData=[]}var e,i,s,a,u,l,h;return e=t,i=[{key:"makeApiRequest",value:(h=o(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(this.host+e,{method:"GET",headers:{Authorization:"bearer ".concat(this.token)}});case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return h.apply(this,arguments)})},{key:"getLateastCommit",value:(l=o(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.makeApiRequest("projects/7/repository/commits");case 3:return t.next=5,t.sent.json();case 5:return e=t.sent,n=e[1].id,t.abrupt("return",n);case 10:return t.prev=10,t.t0=t.catch(0),t.abrupt("return","offline");case 13:case"end":return t.stop()}}),t,this,[[0,10]])}))),function(){return l.apply(this,arguments)})},{key:"getAllRepositoryFiles",value:(u=o(regeneratorRuntime.mark((function t(){var e,n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=1,t.next=3,this.makeApiRequest("projects/7/repository/tree?recursive=true&per_page=500");case 3:return t.next=5,t.sent.json();case 5:n=t.sent;case 6:return e++,t.next=10,this.makeApiRequest("projects/7/repository/tree?recursive=true&per_page=500&page=".concat(e));case 10:return t.next=12,t.sent.json();case 12:if(0!=(r=t.sent).length){t.next=15;break}return t.abrupt("break",18);case 15:n=n.concat(r),t.next=6;break;case 18:return t.abrupt("return",n);case 19:case"end":return t.stop()}}),t,this)}))),function(){return u.apply(this,arguments)})},{key:"getFile",value:(a=o(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.makeApiRequest("projects/7/repository/files/".concat(encodeURIComponent(e),"?ref=master"));case 2:return t.next=4,t.sent.json();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"getAllFileData",value:(s=o(regeneratorRuntime.mark((function t(e){var i,s,a,o,c,u,l,h,f,p,d,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getLateastCommit();case 2:if(i=t.sent,s=[],"offline"!==i&&i!==localStorage.getItem("commitHash")){t.next=9;break}console.log("loading from local"),s.push.apply(s,r(JSON.parse(localStorage.getItem("fileData")))),t.next=41;break;case 9:return t.next=11,this.getAllRepositoryFiles();case 11:a=t.sent,o=0,c=n(a),t.prev=14,c.s();case 16:if((u=c.n()).done){t.next=30;break}if(p=u.value,t.t0="blob"==p.type,!t.t0){t.next=23;break}return t.next=22,this.getFile(p.path);case 22:t.t0=t.sent;case 23:d=t.t0,o++,e.getElementById("resultlist").innerHTML="Loading"+".".repeat(o%4),m=d.content&&atob(d.content),d&&this.fileData.push({title:null===(l=m.split("\r"))||void 0===l||null===(h=l[0].split("\n"))||void 0===h?void 0:h[0],category:null===(f=p.path.split("/"))||void 0===f?void 0:f[0],contents:atob(d.content)});case 28:t.next=16;break;case 30:t.next=35;break;case 32:t.prev=32,t.t1=t.catch(14),c.e(t.t1);case 35:return t.prev=35,c.f(),t.finish(35);case 38:localStorage.setItem("fileData",JSON.stringify(this.fileData)),localStorage.setItem("commitHash",i),s.push.apply(s,r(this.fileData));case 41:return localStorage.getItem("customFileData")&&(console.log(JSON.parse(localStorage.getItem("customFileData"))),s.push.apply(s,r(JSON.parse(localStorage.getItem("customFileData"))))),t.abrupt("return",s);case 43:case"end":return t.stop()}}),t,this,[[14,32,35,38]])}))),function(t){return s.apply(this,arguments)})}],i&&c(e.prototype,i),t}();e.Z=u},6304:function(module,__unused_webpack_exports,__webpack_require__){module=__webpack_require__.nmd(module),function _f(self){"use strict";try{module&&(self=module)}catch(t){}var t;function u(t){return void 0===t||t}function aa(t){const e=Array(t);for(let n=0;n<t;n++)e[n]=v();return e}function v(){return Object.create(null)}function ba(t,e){return e.length-t.length}function x(t){return"string"==typeof t}function C(t){return"object"==typeof t}function D(t){return"function"==typeof t}function ca(t,e){var n=da;if(t&&(e&&(t=E(t,e)),this.H&&(t=E(t,this.H)),this.J&&1<t.length&&(t=E(t,this.J)),n||""===n)){if(t=t.split(n),this.filter){e=this.filter,n=t.length;const r=[];for(let i=0,s=0;i<n;i++){const n=t[i];n&&!e[n]&&(r[s++]=n)}t=r}return t}return t}self._factory=_f;const da=/[\p{Z}\p{S}\p{P}\p{C}]+/u,ea=/[\u0300-\u036f]/g;function fa(t,e){const n=Object.keys(t),r=n.length,i=[];let s="",a=0;for(let o,c,u=0;u<r;u++)o=n[u],(c=t[o])?(i[a++]=F(e?"(?!\\b)"+o+"(\\b|_)":o),i[a++]=c):s+=(s?"|":"")+o;return s&&(i[a++]=F(e?"(?!\\b)("+s+")(\\b|_)":"("+s+")"),i[a]=""),i}function E(t,e){for(let n=0,r=e.length;n<r&&(t=t.replace(e[n],e[n+1]));n+=2);return t}function F(t){return new RegExp(t,"g")}function ha(t){let e="",n="";for(let r,i=0,s=t.length;i<s;i++)(r=t[i])!==n&&(e+=n=r);return e}var ja={encode:ia,F:!1,G:""};function ia(t){return ca.call(this,(""+t).toLowerCase(),!1)}const ka={},G={};function la(t){I(t,"add"),I(t,"append"),I(t,"search"),I(t,"update"),I(t,"remove")}function I(t,e){t[e+"Async"]=function(){const t=this,n=arguments;var r=n[n.length-1];let i;return D(r)&&(i=r,delete n[n.length-1]),r=new Promise((function(r){setTimeout((function(){t.async=!0;const i=t[e].apply(t,n);t.async=!1,r(i)}))})),i?(r.then(i),this):r}}function ma(t,e,n,r){const i=t.length;let s,a,o=[],c=0;r&&(r=[]);for(let u=i-1;0<=u;u--){const l=t[u],h=l.length,f=v();let p=!s;for(let t=0;t<h;t++){const h=l[t],d=h.length;if(d)for(let t,l,m=0;m<d;m++)if(l=h[m],s){if(s[l]){if(!u)if(n)n--;else if(o[c++]=l,c===e)return o;(u||r)&&(f[l]=1),p=!0}if(r&&(a[l]=(t=a[l])?++t:t=1,t<i)){const e=r[t-2]||(r[t-2]=[]);e[e.length]=l}}else f[l]=1}if(r)s||(a=f);else if(!p)return[];s=f}if(r)for(let t,i,a=r.length-1;0<=a;a--){t=r[a],i=t.length;for(let r,a=0;a<i;a++)if(r=t[a],!s[r]){if(n)n--;else if(o[c++]=r,c===e)return o;s[r]=1}}return o}function na(t,e){const n=v(),r=v(),i=[];for(let e=0;e<t.length;e++)n[t[e]]=1;for(let t,s=0;s<e.length;s++){t=e[s];for(let e,s=0;s<t.length;s++)e=t[s],n[e]&&!r[e]&&(r[e]=1,i[i.length]=e)}return i}function J(t){this.l=!0!==t&&t,this.cache=v(),this.h=[]}function oa(t,e,n){C(t)&&(t=t.query);let r=this.cache.get(t);return r||(r=this.search(t,e,n),this.cache.set(t,r)),r}J.prototype.set=function(t,e){if(!this.cache[t]){var n=this.h.length;for(n===this.l?delete this.cache[this.h[n-1]]:n++,--n;0<n;n--)this.h[n]=this.h[n-1];this.h[0]=t}this.cache[t]=e},J.prototype.get=function(t){const e=this.cache[t];if(this.l&&e&&(t=this.h.indexOf(t))){const e=this.h[t-1];this.h[t-1]=this.h[t],this.h[t]=e}return e};const qa={memory:{charset:"latin:extra",D:3,B:4,m:!1},performance:{D:3,B:3,s:!1,context:{depth:2,D:1}},match:{charset:"latin:extra",G:"reverse"},score:{charset:"latin:advanced",D:20,B:3,context:{depth:3,D:9}},default:{}};function ra(t,e,n,r,i,s){setTimeout((function(){const a=t(n,JSON.stringify(s));a&&a.then?a.then((function(){e.export(t,e,n,r,i+1)})):e.export(t,e,n,r,i+1)}))}function K(t,e){if(!(this instanceof K))return new K(t);var n;if(t){x(t)?t=qa[t]:(n=t.preset)&&(t=Object.assign({},n[n],t)),n=t.charset;var r=t.lang;x(n)&&(-1===n.indexOf(":")&&(n+=":default"),n=G[n]),x(r)&&(r=ka[r])}else t={};let i,s,a=t.context||{};if(this.encode=t.encode||n&&n.encode||ia,this.register=e||v(),this.D=i=t.resolution||9,this.G=e=n&&n.G||t.tokenize||"strict",this.depth="strict"===e&&a.depth,this.l=u(a.bidirectional),this.s=s=u(t.optimize),this.m=u(t.fastupdate),this.B=t.minlength||1,this.C=t.boost,this.map=s?aa(i):v(),this.A=i=a.resolution||1,this.h=s?aa(i):v(),this.F=n&&n.F||t.rtl,this.H=(e=t.matcher||r&&r.H)&&fa(e,!1),this.J=(e=t.stemmer||r&&r.J)&&fa(e,!0),n=e=t.filter||r&&r.filter){n=e,r=v();for(let t=0,e=n.length;t<e;t++)r[n[t]]=1;n=r}this.filter=n,this.cache=(e=t.cache)&&new J(e)}function L(t,e,n,r,i){return n&&1<t?e+(r||0)<=t?n+(i||0):(t-1)/(e+(r||0))*(n+(i||0))+1|0:0}function M(t,e,n,r,i,s,a){let o=a?t.h:t.map;(!e[n]||a&&!e[n][a])&&(t.s&&(o=o[r]),a?((e=e[n]||(e[n]=v()))[a]=1,o=o[a]||(o[a]=v())):e[n]=1,o=o[n]||(o[n]=[]),t.s||(o=o[r]||(o[r]=[])),s&&-1!==o.indexOf(i)||(o[o.length]=i,t.m&&((t=t.register[i]||(t.register[i]=[]))[t.length]=o)))}function sa(t,e,n,r,i,s,a,o){let c=[],u=o?t.h:t.map;if(t.s||(u=ua(u,a,o,t.l)),u){let n=0;const l=Math.min(u.length,o?t.A:t.D);for(let e,h,f=0,p=0;f<l&&!((e=u[f])&&(t.s&&(e=ua(e,a,o,t.l)),i&&e&&s&&(h=e.length,h<=i?(i-=h,e=null):(e=e.slice(i),i=0)),e&&(c[n++]=e,s&&(p+=e.length,p>=r))));f++);if(n)return s?ta(c,r,0):void(e[e.length]=c)}return!n&&c}function ta(t,e,n){return t=1===t.length?t[0]:[].concat.apply([],t),n||t.length>e?t.slice(n,n+e):t}function ua(t,e,n,r){return t=n?(t=t[(r=r&&e>n)?e:n])&&t[r?n:e]:t[e]}function N(t,e,n,r,i){let s=0;if(t.constructor===Array)if(i)-1!==(e=t.indexOf(e))?1<t.length&&(t.splice(e,1),s++):s++;else{i=Math.min(t.length,n);for(let a,o=0;o<i;o++)(a=t[o])&&(s=N(a,e,n,r,i),r||s||delete t[o])}else for(let a in t)(s=N(t[a],e,n,r,i))||delete t[a];return s}function va(t){t=t.data;var e=self._index;const n=t.args;var r=t.task;"init"===r?(r=t.options||{},t=t.factory,e=r.encode,r.cache=!1,e&&0===e.indexOf("function")&&(r.encode=Function("return "+e)()),t?(Function("return "+t)()(self),self._index=new self.FlexSearch.Index(r),delete self.FlexSearch):self._index=new K(r)):(t=t.id,e=e[r].apply(e,n),postMessage("search"===r?{id:t,msg:e}:{id:t}))}t=K.prototype,t.append=function(t,e){return this.add(t,e,!0)},t.add=function(t,e,n,r){if(e&&(t||0===t)){if(!r&&!n&&this.register[t])return this.update(t,e);if(r=(e=this.encode(e)).length){const u=v(),l=v(),h=this.depth,f=this.D;for(let p=0;p<r;p++){let d=e[this.F?r-1-p:p];var i=d.length;if(d&&i>=this.B&&(h||!l[d])){var s=L(f,r,p),a="";switch(this.G){case"full":if(3<i){for(s=0;s<i;s++)for(var o=i;o>s;o--)if(o-s>=this.B){var c=L(f,r,p,i,s);M(this,l,a=d.substring(s,o),c,t,n)}break}case"reverse":if(2<i){for(o=i-1;0<o;o--)(a=d[o]+a).length>=this.B&&M(this,l,a,L(f,r,p,i,o),t,n);a=""}case"forward":if(1<i){for(o=0;o<i;o++)(a+=d[o]).length>=this.B&&M(this,l,a,s,t,n);break}default:if(this.C&&(s=Math.min(s/this.C(e,d,p)|0,f-1)),M(this,l,d,s,t,n),h&&1<r&&p<r-1)for(i=v(),a=this.A,s=d,o=Math.min(h+1,r-p),i[s]=1,c=1;c<o;c++)if((d=e[this.F?r-1-p-c:p+c])&&d.length>=this.B&&!i[d]){i[d]=1;const e=this.l&&d>s;M(this,u,e?s:d,L(a+(r/2>a?0:1),r,p,o-1,c-1),t,n,e?d:s)}}}}this.m||(this.register[t]=1)}}return this},t.search=function(t,e,n){n||(!e&&C(t)?t=(n=t).query:C(e)&&(n=e));let r,i,s,a,o,c=[],u=0;if(n){e=n.limit,u=n.offset||0;var l=n.context;i=n.suggest}if(t&&(r=(t=this.encode(t)).length,1<r)){n=v();var h=[];for(let e,s=0,a=0;s<r;s++)if((e=t[s])&&e.length>=this.B&&!n[e]){if(!(this.s||i||this.map[e]))return c;h[a++]=e,n[e]=1}r=(t=h).length}if(!r)return c;for(e||(e=100),n=0,(l=this.depth&&1<r&&!1!==l)?(s=t[0],n=1):1<r&&t.sort(ba);n<r;n++){if(o=t[n],l?(a=sa(this,c,i,e,u,2===r,o,s),i&&!1===a&&c.length||(s=o)):a=sa(this,c,i,e,u,1===r,o),a)return a;if(i&&n===r-1){if(!(h=c.length)){if(l){l=0,n=-1;continue}return c}if(1===h)return ta(c[0],e,u)}}return ma(c,e,u,i)},t.contain=function(t){return!!this.register[t]},t.update=function(t,e){return this.remove(t).add(t,e)},t.remove=function(t,e){const n=this.register[t];if(n){if(this.m)for(let e,r=0;r<n.length;r++)e=n[r],e.splice(e.indexOf(t),1);else N(this.map,t,this.D,this.s),this.depth&&N(this.h,t,this.A,this.s);if(e||delete this.register[t],this.cache){e=this.cache;for(let n,r,i=0;i<e.h.length;i++)r=e.h[i],n=e.cache[r],-1!==n.indexOf(t)&&(e.h.splice(i--,1),delete e.cache[r])}}return this},t.searchCache=oa,t.export=function(t,e,n,r,i){let s,a;switch(i||(i=0)){case 0:if(s="reg",this.m){a=v();for(let t in this.register)a[t]=1}else a=this.register;break;case 1:s="cfg",a={doc:0,opt:this.s?1:0};break;case 2:s="map",a=this.map;break;case 3:s="ctx",a=this.h;break;default:return}return ra(t,e||this,n?n+"."+s:s,r,i,a),!0},t.import=function(t,e){if(e)switch(x(e)&&(e=JSON.parse(e)),t){case"cfg":this.s=!!e.opt;break;case"reg":this.m=!1,this.register=e;break;case"map":this.map=e;break;case"ctx":this.h=e}},la(K.prototype);let wa=0;function O(t){if(!(this instanceof O))return new O(t);var e;t?D(e=t.encode)&&(t.encode=e.toString()):t={},(e=(self||window)._factory)&&(e=e.toString());const n=self.exports,r=this;this.o=xa(e,n,t.worker),this.h=v(),this.o&&(n?this.o.on("message",(function(t){r.h[t.id](t.msg),delete r.h[t.id]})):this.o.onmessage=function(t){t=t.data,r.h[t.id](t.msg),delete r.h[t.id]},this.o.postMessage({task:"init",factory:e,options:t}))}function P(t){O.prototype[t]=O.prototype[t+"Async"]=function(){const e=this,n=[].slice.call(arguments);var r=n[n.length-1];let i;return D(r)&&(i=r,n.splice(n.length-1,1)),r=new Promise((function(r){setTimeout((function(){e.h[++wa]=r,e.o.postMessage({task:t,id:wa,args:n})}))})),i?(r.then(i),this):r}}function xa(a,b,c){let d;try{d=b?eval('new (require("worker_threads")["Worker"])("../dist/node/node.js")'):a?new Worker(URL.createObjectURL(new Blob(["onmessage="+va.toString()],{type:"text/javascript"}))):new Worker(x(c)?c:"worker/worker.js",{type:"module"})}catch(t){}return d}function Q(t){if(!(this instanceof Q))return new Q(t);var e,n=t.document||t.doc||t;this.K=[],this.h=[],this.A=[],this.register=v(),this.key=(e=n.key||n.id)&&S(e,this.A)||"id",this.m=u(t.fastupdate),this.C=(e=n.store)&&!0!==e&&[],this.store=e&&v(),this.I=(e=n.tag)&&S(e,this.A),this.l=e&&v(),this.cache=(e=t.cache)&&new J(e),t.cache=!1,this.o=t.worker,this.async=!1,e=v();let r=n.index||n.field||n;x(r)&&(r=[r]);for(let n,i,s=0;s<r.length;s++)n=r[s],x(n)||(i=n,n=n.field),i=C(i)?Object.assign({},t,i):t,this.o&&(e[n]=new O(i),e[n].o||(this.o=!1)),this.o||(e[n]=new K(i,this.register)),this.K[s]=S(n,this.A),this.h[s]=n;if(this.C)for(x(t=n.store)&&(t=[t]),n=0;n<t.length;n++)this.C[n]=S(t[n],this.A);this.index=e}function S(t,e){const n=t.split(":");let r=0;for(let i=0;i<n.length;i++)0<=(t=n[i]).indexOf("[]")&&(t=t.substring(0,t.length-2))&&(e[r]=!0),t&&(n[r++]=t);return r<n.length&&(n.length=r),1<r?n:n[0]}function T(t,e){if(x(e))t=t[e];else for(let n=0;t&&n<e.length;n++)t=t[e[n]];return t}function U(t,e,n,r,i){if(t=t[i],r===n.length-1)e[i]=t;else if(t)if(t.constructor===Array)for(e=e[i]=Array(t.length),i=0;i<t.length;i++)U(t,e,n,r,i);else e=e[i]||(e[i]=v()),i=n[++r],U(t,e,n,r,i)}function V(t,e,n,r,i,s,a,o){if(t=t[a])if(r===e.length-1){if(t.constructor===Array){if(n[r]){for(e=0;e<t.length;e++)i.add(s,t[e],!0,!0);return}t=t.join(" ")}i.add(s,t,o,!0)}else if(t.constructor===Array)for(a=0;a<t.length;a++)V(t,e,n,r,i,s,a,o);else a=e[++r],V(t,e,n,r,i,s,a,o)}function ya(t,e,n,r){let i=this.l[t],s=i&&i.length-n;if(s&&0<s)return(s>e||n)&&(i=i.slice(n,n+e)),r&&(i=za.call(this,i)),{tag:t,result:i}}function za(t){const e=Array(t.length);for(let n,r=0;r<t.length;r++)n=t[r],e[r]={id:n,doc:this.store[n]};return e}P("add"),P("append"),P("search"),P("update"),P("remove"),t=Q.prototype,t.add=function(t,e,n){if(C(t)&&(t=T(e=t,this.key)),e&&(t||0===t)){if(!n&&this.register[t])return this.update(t,e);for(let r,i,s=0;s<this.h.length;s++)i=this.h[s],r=this.K[s],x(r)&&(r=[r]),V(e,r,this.A,0,this.index[i],t,r[0],n);if(this.I){let r=T(e,this.I),i=v();x(r)&&(r=[r]);for(let e,s,a=0;a<r.length;a++)if(e=r[a],!i[e]&&(i[e]=1,s=this.l[e]||(this.l[e]=[]),!n||-1===s.indexOf(t))&&(s[s.length]=t,this.m)){const e=this.register[t]||(this.register[t]=[]);e[e.length]=s}}if(this.store&&(!n||!this.store[t])){let n;if(this.C){n=v();for(let t,r=0;r<this.C.length;r++)t=this.C[r],x(t)?n[t]=e[t]:U(e,n,t,0,t[0])}this.store[t]=n||e}}return this},t.append=function(t,e){return this.add(t,e,!0)},t.update=function(t,e){return this.remove(t).add(t,e)},t.remove=function(t){if(C(t)&&(t=T(t,this.key)),this.register[t]){for(var e=0;e<this.h.length&&(this.index[this.h[e]].remove(t,!this.o),!this.m);e++);if(this.I&&!this.m)for(let n in this.l){const r=(e=this.l[n]).indexOf(t);-1!==r&&(1<e.length?e.splice(r,1):delete this.l[n])}this.store&&delete this.store[t],delete this.register[t]}return this},t.search=function(t,e,n,r){n||(!e&&C(t)?t=(n=t).query:C(e)&&(n=e,e=0));let i,s,a,o,c,u,l=[],h=[],f=0;if(n)if(n.constructor===Array)a=n,n=null;else{if(a=(i=n.pluck)||n.index||n.field,o=n.tag,s=this.store&&n.enrich,c="and"===n.bool,e=n.limit||100,u=n.offset||0,o&&(x(o)&&(o=[o]),!t)){for(let t,n=0;n<o.length;n++)(t=ya.call(this,o[n],e,u,s))&&(l[l.length]=t,f++);return f?l:[]}x(a)&&(a=[a])}a||(a=this.h),c=c&&(1<a.length||o&&1<o.length);const p=!r&&(this.o||this.async)&&[];for(let i,s,d,m=0;m<a.length;m++){let g;if(s=a[m],x(s)||(g=s,s=s.field),p)p[m]=this.index[s].searchAsync(t,e,g||n);else{if(i=r?r[m]:this.index[s].search(t,e,g||n),d=i&&i.length,o&&d){const t=[];let n=0;c&&(t[0]=[i]);for(let e,r,i=0;i<o.length;i++)e=o[i],(d=(r=this.l[e])&&r.length)&&(n++,t[t.length]=c?[r]:r);n&&(i=c?ma(t,e||100,u||0):na(i,t),d=i.length)}if(d)h[f]=s,l[f++]=i;else if(c)return[]}}if(p){const r=this;return new Promise((function(i){Promise.all(p).then((function(s){i(r.search(t,e,n,s))}))}))}if(!f)return[];if(i&&(!s||!this.store))return l[0];for(let t,e=0;e<h.length;e++){if(t=l[e],t.length&&s&&(t=za.call(this,t)),i)return t;l[e]={field:h[e],result:t}}return l},t.contain=function(t){return!!this.register[t]},t.get=function(t){return this.store[t]},t.set=function(t,e){return this.store[t]=e,this},t.searchCache=oa,t.export=function(t,e,n,r,i){if(i||(i=0),r||(r=0),r<this.h.length){const n=this.h[r],s=this.index[n];e=this,setTimeout((function(){s.export(t,e,i?n.replace(":","-"):"",r,i++)||(r++,i=1,e.export(t,e,n,r,i))}))}else{let e;switch(i){case 1:n="tag",e=this.l;break;case 2:n="store",e=this.store;break;default:return}ra(t,this,n,r,i,e)}},t.import=function(t,e){if(e)switch(x(e)&&(e=JSON.parse(e)),t){case"tag":this.l=e;break;case"reg":this.m=!1,this.register=e;for(let t,n=0;n<this.h.length;n++)t=this.index[this.h[n]],t.register=e,t.m=!1;break;case"store":this.store=e;break;default:const n=(t=t.split("."))[0];t=t[1],n&&t&&this.index[n].import(t,e)}},la(Q.prototype);var Ba={encode:Aa,F:!1,G:""};const Ca=[F("[àáâãäå]"),"a",F("[èéêë]"),"e",F("[ìíîï]"),"i",F("[òóôõöő]"),"o",F("[ùúûüű]"),"u",F("[ýŷÿ]"),"y",F("ñ"),"n",F("[çc]"),"k",F("ß"),"s",F(" & ")," and "];function Aa(t){var e=t;return e.normalize&&(e=e.normalize("NFD").replace(ea,"")),ca.call(this,e.toLowerCase(),!t.normalize&&Ca)}var Ea={encode:Da,F:!1,G:"strict"};const Fa=/[^a-z0-9]+/,Ga={b:"p",v:"f",w:"f",z:"s",x:"s","ß":"s",d:"t",n:"m",c:"k",g:"k",j:"k",q:"k",i:"e",y:"e",u:"o"};function Da(t){const e=[];if(t=Aa.call(this,t).join(" ")){const n=t.split(Fa),r=n.length;for(let i,s=0,a=0;s<r;s++)if((t=n[s])&&(!this.filter||!this.filter[t])){i=t[0];let n=Ga[i]||i,r=n;for(let e=1;e<t.length;e++){i=t[e];const s=Ga[i]||i;s&&s!==r&&(n+=s,r=s)}e[a++]=n}}return e}var Ia={encode:Ha,F:!1,G:""};const Ja=[F("ae"),"a",F("oe"),"o",F("sh"),"s",F("th"),"t",F("ph"),"f",F("pf"),"f",F("(?![aeo])h(?![aeo])"),"",F("(?!^[aeo])h(?!^[aeo])"),""];function Ha(t,e){return t&&(2<(t=Da.call(this,t).join(" ")).length&&(t=E(t,Ja)),e||(1<t.length&&(t=ha(t)),t&&(t=t.split(" ")))),t}var La={encode:Ka,F:!1,G:""};const Ma=F("(?!\\b)[aeo]");function Ka(t){return t&&(1<(t=Ha.call(this,t,!0)).length&&(t=t.replace(Ma,"")),1<t.length&&(t=ha(t)),t&&(t=t.split(" "))),t}G["latin:default"]=ja,G["latin:simple"]=Ba,G["latin:balance"]=Ea,G["latin:advanced"]=Ia,G["latin:extra"]=La;const W=self;let Y;const Z={Index:K,Document:Q,Worker:O,registerCharset:function(t,e){G[t]=e},registerLanguage:function(t,e){ka[t]=e}};(Y=W.define)&&Y.amd?Y([],(function(){return Z})):W.exports?W.exports=Z:W.FlexSearch=Z}(this)}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var n=__webpack_module_cache__[t]={id:t,loaded:!1,exports:{}};return __webpack_modules__[t].call(n.exports,n,n.exports,__webpack_require__),n.loaded=!0,n.exports}__webpack_require__.d=function(t,e){for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},__webpack_require__.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},__webpack_require__.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t};var __webpack_exports__={};!function(){"use strict";function t(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=r(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,s=function(){};return{s:s,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,c=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){c=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw a}}}}function e(t,e,n,r,i,s,a){try{var o=t[s](a),c=o.value}catch(t){return void n(t)}o.done?e(c):Promise.resolve(c).then(r,i)}function n(t){return function(){var n=this,r=arguments;return new Promise((function(i,s){var a=t.apply(n,r);function o(t){e(a,i,s,o,c,"next",t)}function c(t){e(a,i,s,o,c,"throw",t)}o(void 0)}))}}function r(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}Office.onReady((function(t){t.host===Office.HostType.Word&&(document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("search").oninput=b,document.getElementById("template").onclick=w)}));var s=__webpack_require__(9164).Z,a=new(0,__webpack_require__(6304).Document)({charset:"latin:extra",preset:"match",tokenize:"forward",cache:!1,document:{id:"id",index:["contents","title","category"],store:!0}}),o=new(0,__webpack_require__(1621).Z),c=new(0,__webpack_require__(2183).Z),u=0,l={};function h(){u=0,l={},(new s).getAllFileData(document).then((function(t){console.log(t),t.forEach((function(t){t.id=u++,void 0===l[t.category]?l[t.category]=1:l[t.category]+=1,a.add(t)})),f()}))}function f(){document.getElementById("resultlist").innerHTML="";for(var t=0,e=Object.entries(l);t<e.length;t++){var n=(a=e[t],o=2,function(t){if(Array.isArray(t))return t}(a)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,s=void 0;try{for(var a,o=t[Symbol.iterator]();!(r=(a=o.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,s=t}finally{try{r||null==o.return||o.return()}finally{if(i)throw s}}return n}}(a,o)||r(a,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=n[0],s=n[1];p(i,i.replaceAll("_"," "),s+" findings")}var a,o}function p(t,e,n){e.length>25&&(e=e.substring(0,22)+"..."),document.getElementById("resultlist").innerHTML+='      <li class="ms-ListItem" tabindex="0">        <span class="ms-ListItem-primaryText"><span class="wrap"> \n        '.concat(e,'\n    </span></span>        <span class="ms-ListItem-secondaryText"> ').concat(n,'\n    </span>        <div class="ms-ListItem-selectionTarget"></div>        <div class="ms-ListItem-actions">          <div id="').concat(t,'" class="ms-ListItem-action">            <i class="ms-Icon ms-Icon--CaretSolidRight"></i>          </div>        </div>      </li>'),document.getElementsByClassName("ms-ListItem-action").forEach((function(t){t.onclick=d}))}function d(){return m.apply(this,arguments)}function m(){return m=n(regeneratorRuntime.mark((function e(){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Word.run(function(){var e=n(regeneratorRuntime.mark((function e(n){var i,s,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=Object.entries(null==a?void 0:a.store).filter((function(t){return t[1].category===r.id})),document.getElementById("resultlist").innerHTML='<div id="back" class="ms-ListItem-secondaryText"> <span style="float: right;"><i class="ms-Icon ms-Icon--CaretSolidRight" style="transform: rotate(180deg);" transform:=""></i> back </span></div>',s=t(i);try{for(s.s();!(o=s.n()).done;)g((c=o.value)[1].id,c[1].title,c[1].title)}catch(t){s.e(t)}finally{s.f()}document.getElementsByClassName("ms-ListItem-action").forEach((function(t){t.onclick=y})),document.getElementById("back").onclick=f;case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(t){console.log("Error: "+t),t instanceof OfficeExtension.Error&&console.log("Debug info: "+JSON.stringify(t.debugInfo))}));case 2:case"end":return e.stop()}}),e)}))),m.apply(this,arguments)}function g(t,e,n){e.length>25&&(e=e.substring(0,22)+"..."),document.getElementById("resultlist").innerHTML+='      <li class="ms-ListItem" tabindex="0">        <span class="ms-ListItem-primaryText"><span class="wrap">'+e+'</span></span>        <span class="ms-ListItem-secondaryText">'+n+'</span>        <div class="ms-ListItem-selectionTarget"></div>        <div class="ms-ListItem-actions">          <div id="'+t+'" class="ms-ListItem-action">            <i class="ms-Icon ms-Icon--CaretSolidRight"></i>          </div>        </div>      </li>'}function y(){return v.apply(this,arguments)}function v(){return v=n(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Word.run(function(){var t=n(regeneratorRuntime.mark((function t(n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(a),r=a.get(e.id),t.next=4,o.writeIssue(n,Word,r);case 4:return t.next=6,n.sync();case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)}))),v.apply(this,arguments)}function b(){return x.apply(this,arguments)}function x(){return x=n(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Word.run(function(){var t=n(regeneratorRuntime.mark((function t(e){var n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(document.getElementById("resultlist").innerHTML="",""!=(n=document.getElementById("search").value)){t.next=5;break}return f(),t.abrupt("return");case 5:return r=a.search(n,{enrich:!0}),i=[],r.forEach((function(t){t.result.forEach((function(t){if(!i.includes(t.id)){var e=t.doc.title,n=e.split(" ",2)[0].length;e=e.substring(n+1),g(t.id,e,t.doc.category),i.push(t.id)}}))})),document.getElementsByClassName("ms-ListItem-action").forEach((function(t){t.onclick=y})),t.next=11,e.sync();case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t)}))),x.apply(this,arguments)}function w(){return k.apply(this,arguments)}function k(){return k=n(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Word.run(function(){var t=n(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.templateIssue(e);case 2:return h(),t.next=5,e.sync();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)}))),k.apply(this,arguments)}h()}()})();
//# sourceMappingURL=taskpane.js.map